(function(){var t=this;if(typeof Math.sgn=="undefined"){Math.sgn=function(z){return z==0?0:z>0?1:-1}}var i={subtract:function(A,z){return{x:A.x-z.x,y:A.y-z.y}},dotProduct:function(A,z){return(A.x*z.x)+(A.y*z.y)},square:function(z){return Math.sqrt((z.x*z.x)+(z.y*z.y))},scale:function(z,A){return{x:z.x*A,y:z.y*A}}},w=64,q=Math.pow(2,-w-1);var n=function(I,A){var F=[],H=f(I,A),C=A.length-1,z=(2*C)-1,E=o(H,z,F,0),J=i.subtract(I,A[0]),G=i.square(J),K=0;for(var D=0;D<E;D++){J=i.subtract(I,v(A,C,F[D],null,null));var B=i.square(J);if(B<G){G=B;K=F[D]}}J=i.subtract(I,A[C]);B=i.square(J);if(B<G){G=B;K=1}return{location:K,distance:G}};var b=function(z,A){var B=n(z,A);return{point:v(A,A.length-1,B.location,null,null),location:B.location}};var f=function(P,F){var I=F.length-1,B=(2*I)-1,N=[],L=[],D=[],O=[],M=[[1,0.6,0.3,0.1],[0.4,0.6,0.6,0.4],[0.1,0.3,0.6,1]];for(var K=0;K<=I;K++){N[K]=i.subtract(F[K],P)}for(var K=0;K<=I-1;K++){L[K]=i.subtract(F[K+1],F[K]);L[K]=i.scale(L[K],3)}for(var Q=0;Q<=I-1;Q++){for(var H=0;H<=I;H++){if(!D[Q]){D[Q]=[]}D[Q][H]=i.dotProduct(L[Q],N[H])}}for(K=0;K<=B;K++){if(!O[K]){O[K]=[]}O[K].y=0;O[K].x=parseFloat(K)/B}var E=I,G=I-1;for(var J=0;J<=E+G;J++){var C=Math.max(0,J-G),A=Math.min(J,E);for(K=C;K<=A;K++){j=J-K;O[K+j].y+=D[j][K]*M[j][K]}}return O};var o=function(G,B,J,D){var A=[],I=[],E,F,H=[],z=[];switch(c(G,B)){case 0:return 0;case 1:if(D>=w){J[0]=(G[0].x+G[B].x)/2;return 1}if(d(G,B)){J[0]=h(G,B);return 1}break}v(G,B,0.5,A,I);E=o(A,B,H,D+1);F=o(I,B,z,D+1);for(var C=0;C<E;C++){J[C]=H[C]}for(var C=0;C<F;C++){J[C+E]=z[C]}return(E+F)};var c=function(E,D){var C=0,A,z;A=z=Math.sgn(E[0].y);for(var B=1;B<=D;B++){A=Math.sgn(E[B].y);if(A!=z){C++}z=A}return C};var d=function(H,B){var N,A,z,J,G,R,Q,P,D,C,T,F,K,S,E,I;R=H[0].y-H[B].y;Q=H[B].x-H[0].x;P=H[0].x*H[B].y-H[B].x*H[0].y;var M=max_distance_below=0;for(var O=1;O<B;O++){var L=R*H[O].x+Q*H[O].y+P;if(L>M){M=L}else{if(L<max_distance_below){max_distance_below=L}}}T=0;F=1;K=0;S=R;E=Q;I=P-M;D=T*E-S*F;C=1/D;A=(F*I-E*K)*C;S=R;E=Q;I=P-max_distance_below;D=T*E-S*F;C=1/D;z=(F*I-E*K)*C;J=Math.min(A,z);G=Math.max(A,z);N=G-J;return(N<q)?1:0};var h=function(B,C){var F=1,H=0,I=B[C].x-B[0].x,J=B[C].y-B[0].y,z=B[0].x-0,D=B[0].y-0,G=I*H-J*F,A=1/G,E=(I*D-J*z)*A;return 0+F*E};var v=function(G,F,D,E,C){var z=[[]];for(var A=0;A<=F;A++){z[0][A]=G[A]}for(var B=1;B<=F;B++){for(var A=0;A<=F-B;A++){if(!z[B]){z[B]=[]}if(!z[B][A]){z[B][A]={}}z[B][A].x=(1-D)*z[B-1][A].x+D*z[B-1][A+1].x;z[B][A].y=(1-D)*z[B-1][A].y+D*z[B-1][A+1].y}}if(E!=null){for(A=0;A<=F;A++){E[A]=z[A][0]}}if(C!=null){for(A=0;A<=F;A++){C[A]=z[F-A][A]}}return(z[F][0])};var s={};var g=function(C){var J=s[C];if(!J){J=[];var D=function(){return function(K){return Math.pow(K,C)}},B=function(){return function(K){return Math.pow((1-K),C)}},H=function(K){return function(L){return K}},I=function(){return function(K){return K}},z=function(){return function(K){return 1-K}},A=function(K){return function(M){var N=1;for(var L=0;L<K.length;L++){N=N*K[L](M)}return N}};J.push(new D());for(var G=1;G<C;G++){var F=[new H(C)];for(var E=0;E<(C-G);E++){F.push(new I())}for(var E=0;E<G;E++){F.push(new z())}J.push(new A(F))}J.push(new B());s[C]=J}return J};var l=function(D,z){var E=g(D.length-1),B=0,A=0;for(var C=0;C<D.length;C++){B=B+(D[C].x*E[C](z));A=A+(D[C].y*E[C](z))}return{x:B,y:A}};var e=function(A,z){return Math.sqrt(Math.pow(A.x-z.x,2)+Math.pow(A.y-z.y,2))};var u=function(z){return z[0].x==z[1].x&&z[0].y==z[1].y};var k=function(F,A,G){if(u(F)){return{point:F[0],location:A}}var C=l(F,A),z=0,B=A,D=G>0?1:-1,E=null;while(z<Math.abs(G)){B+=(0.005*D);E=l(F,B);z+=e(E,C);C=E}return{point:E,location:B}};var p=function(E){if(u(E)){return 0}var B=l(E,0),z=0,A=0,C=1,D=null;while(A<1){A+=(0.005*C);D=l(E,A);z+=e(D,B);B=D}return z};var y=function(A,z,B){return k(A,z,B).point};var a=function(A,z,B){return k(A,z,B).location};var m=function(E,A){var D=l(E,A),C=l(E.slice(0,E.length-1),A),z=C.y-D.y,B=C.x-D.x;return z==0?Infinity:Math.atan(z/B)};var r=function(B,z,C){var A=k(B,z,C);if(A.location>1){A.location=1}if(A.location<0){A.location=0}return m(B,A.location)};var x=function(C,G,B,z){z=z==null?0:z;var A=k(C,G,z),D=m(C,A.location),H=Math.atan(-1/D),E=B/2*Math.sin(H),F=B/2*Math.cos(H);return[{x:A.point.x+F,y:A.point.y+E},{x:A.point.x-F,y:A.point.y-E}]};this.jsBezier={distanceFromCurve:n,gradientAtPoint:m,gradientAtPointAlongCurveFrom:r,nearestPointOnCurve:b,pointOnCurve:l,pointAlongCurveFrom:y,perpendicularToCurveAt:x,locationAlongCurveFrom:a,getLength:p}}).call(typeof window!=="undefined"?window:this);(function(){var l=this;var k=l.Biltong={};var m=function(q){return Object.prototype.toString.call(q)==="[object Array]"},c=function(s,r,q){s=m(s)?s:[s.x,s.y];r=m(r)?r:[r.x,r.y];return q(s,r)},n=k.gradient=function(r,q){return c(r,q,function(t,s){if(s[0]==t[0]){return s[1]>t[1]?Infinity:-Infinity}else{if(s[1]==t[1]){return s[0]>t[0]?0:-0}else{return(s[1]-t[1])/(s[0]-t[0])}}})},a=k.normal=function(r,q){return -1/n(r,q)},e=k.lineLength=function(r,q){return c(r,q,function(t,s){return Math.sqrt(Math.pow(s[1]-t[1],2)+Math.pow(s[0]-t[0],2))})},g=k.quadrant=function(r,q){return c(r,q,function(t,s){if(s[0]>t[0]){return(s[1]>t[1])?2:1}else{if(s[0]==t[0]){return s[1]>t[1]?2:1}else{return(s[1]>t[1])?3:4}}})},d=k.theta=function(r,q){return c(r,q,function(w,v){var u=n(w,v),x=Math.atan(u),y=g(w,v);if((y==4||y==3)){x+=Math.PI}if(x<0){x+=(2*Math.PI)}return x})},i=k.intersects=function(v,u){var s=v.x,q=v.x+v.w,z=v.y,x=v.y+v.h,t=u.x,r=u.x+u.w,y=u.y,w=u.y+u.h;return((s<=t&&t<=q)&&(z<=y&&y<=x))||((s<=r&&r<=q)&&(z<=y&&y<=x))||((s<=t&&t<=q)&&(z<=w&&w<=x))||((s<=r&&t<=q)&&(z<=w&&w<=x))||((t<=s&&s<=r)&&(y<=z&&z<=w))||((t<=q&&q<=r)&&(y<=z&&z<=w))||((t<=s&&s<=r)&&(y<=x&&x<=w))||((t<=q&&s<=r)&&(y<=x&&x<=w))},h=k.encloses=function(v,u,z){var s=v.x,r=v.x+v.w,B=v.y,y=v.y+v.h,t=u.x,q=u.x+u.w,A=u.y,x=u.y+u.h,w=function(F,E,D,C){return z?F<=E&&D>=C:F<E&&D>C};return w(s,t,r,q)&&w(B,A,y,x)},f=[null,[1,-1],[1,1],[-1,1],[-1,-1]],p=[null,[-1,-1],[-1,1],[1,1],[1,-1]],o=k.pointOnLine=function(q,v,r){var u=n(q,v),B=g(q,v),A=r>0?f[B]:p[B],t=Math.atan(u),w=Math.abs(r*Math.sin(t))*A[1],z=Math.abs(r*Math.cos(t))*A[0];return{x:q.x+z,y:q.y+w}},b=k.perpendicularLineTo=function(s,t,u){var r=n(s,t),v=Math.atan(-1/r),w=u/2*Math.sin(v),q=u/2*Math.cos(v);return[{x:t.x+q,y:t.y+w},{x:t.x-q,y:t.y-w}]}}).call(typeof window!=="undefined"?window:this);(function(){var s=this,H={android:navigator.userAgent.toLowerCase().indexOf("android")>-1},d=function(O,L,M){M=M||O.parentNode;var P=M.querySelectorAll(L);for(var N=0;N<P.length;N++){if(P[N]===O){return true}}return false},K=function(L){return(typeof L=="string"||L.constructor===String)?document.getElementById(L):L},D=function(L){return L.srcElement||L.target},n=function(Q,P,O,N){if(!N){return{path:[P],end:1}}else{if(typeof Q.path!=="undefined"&&Q.path.indexOf){return{path:Q.path,end:Q.path.indexOf(O)}}else{var L={path:[],end:-1},M=function(R){L.path.push(R);if(R===O){L.end=L.path.length-1}else{if(R.parentNode!=null){M(R.parentNode)}}};M(P);return L}}},I=function(L,O){for(var N=0,M=L.length;N<M;N++){if(L[N]==O){break}}if(N<L.length){L.splice(N,1)}},q=1,b=function(O,N,L){var M=q++;O.__ta=O.__ta||{};O.__ta[N]=O.__ta[N]||{};O.__ta[N][M]=L;L.__tauid=M;return M},u=function(O,N,M){O.__ta&&O.__ta[N]&&delete O.__ta[N][M.__tauid];if(M.__taExtra){for(var L=0;L<M.__taExtra.length;L++){z(O,M.__taExtra[L][0],M.__taExtra[L][1])}M.__taExtra.length=0}M.__taUnstore&&M.__taUnstore()},i=function(M,O,N,L){if(M==null){return N}else{var Q=M.split(","),P=function(V){P.__tauid=N.__tauid;var S=D(V),U=S;var W=n(V,S,O,M!=null);if(W.end!=-1){for(var T=0;T<W.end;T++){U=W.path[T];for(var R=0;R<Q.length;R++){if(d(U,Q[R],O)){N.apply(U,arguments)}}}}};h(N,L,P);return P}},h=function(M,L,N){M.__taExtra=M.__taExtra||[];M.__taExtra.push([L,N])},y=function(P,L,O,N){if(r&&w[L]){var M=i(N,P,O,w[L]);f(P,w[L],M,O)}if(L==="focus"&&P.getAttribute("tabindex")==null){P.setAttribute("tabindex","1")}f(P,L,i(N,P,O,L),O)},e=function(Q,M,O,N){if(Q.__taSmartClicks==null){var R=function(S){Q.__tad=v(S)},L=function(S){Q.__tau=v(S)},P=function(T){if(Q.__tad&&Q.__tau&&Q.__tad[0]===Q.__tau[0]&&Q.__tad[1]===Q.__tau[1]){for(var S=0;S<Q.__taSmartClicks.length;S++){Q.__taSmartClicks[S].apply(D(T),[T])}}};y(Q,"mousedown",R,N);y(Q,"mouseup",L,N);y(Q,"click",P,N);Q.__taSmartClicks=[]}Q.__taSmartClicks.push(O);O.__taUnstore=function(){I(Q.__taSmartClicks,O)}},c={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},a=function(M,L){return function(O,V,T,N){if(V=="contextmenu"&&C){y(O,V,T,N)}else{if(O.__taTapHandler==null){var Q=O.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:false,taps:0,downSelectors:[]};var U=function(Z){var Y=D(Z),ab=n(Z,Y,O,N!=null),aa=false;for(var X=0;X<ab.end;X++){if(aa){return}Y=ab.path[X];for(var W=0;W<Q.downSelectors.length;W++){if(Q.downSelectors[W]==null||d(Y,Q.downSelectors[W],O)){Q.down=true;setTimeout(S,M);setTimeout(R,L);aa=true;break}}}},P=function(ad){if(Q.down){var ae=D(ad),Z,ac;Q.taps++;var aa=t(ad);for(var W in c){if(c.hasOwnProperty(W)){var Y=c[W];if(Y.touches===aa&&(Y.taps===1||Y.taps===Q.taps)){for(var ab=0;ab<Q[W].length;ab++){ac=n(ad,ae,O,Q[W][ab][1]!=null);for(var X=0;X<ac.end;X++){Z=ac.path[X];if(Q[W][ab][1]==null||d(Z,Q[W][ab][1],O)){Q[W][ab][0].apply(Z,[ad]);break}}}}}}}},S=function(){Q.down=false},R=function(){Q.taps=0};y(O,"mousedown",U);y(O,"mouseup",P)}O.__taTapHandler.downSelectors.push(N);O.__taTapHandler[V].push([T,N]);T.__taUnstore=function(){I(O.__taTapHandler[V],T)}}}},l=function(N,L,P,O){for(var M in P.__tamee[N]){if(P.__tamee[N].hasOwnProperty(M)){P.__tamee[N][M].apply(O,[L])}}},m=function(){var L=[];return function(R,M,P,O){if(!R.__tamee){R.__tamee={over:false,mouseenter:[],mouseexit:[]};var Q=function(T){var S=D(T);if((O==null&&(S==R&&!R.__tamee.over))||(d(S,O,R)&&(S.__tamee==null||!S.__tamee.over))){l("mouseenter",T,R,S);S.__tamee=S.__tamee||{};S.__tamee.over=true;L.push(S)}},N=function(U){var T=D(U);for(var S=0;S<L.length;S++){if(T==L[S]&&!d((U.relatedTarget||U.toElement),"*",T)){T.__tamee.over=false;L.splice(S,1);l("mouseexit",U,R,T)}}};f(R,"mouseover",i(O,R,Q,"mouseover"),Q);f(R,"mouseout",i(O,R,N,"mouseout"),N)}P.__taUnstore=function(){delete R.__tamee[M][P.__tauid]};b(R,M,P);R.__tamee[M][P.__tauid]=P}},r="ontouchstart" in document.documentElement,C="onmousedown" in document.documentElement,w={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},J="touchstart",B="touchend",o="touchmove",A=(function(){var N=-1;if(navigator.appName=="Microsoft Internet Explorer"){var L=navigator.userAgent,M=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(M.exec(L)!=null){N=parseFloat(RegExp.$1)}}return N})(),g=A>-1&&A<9,G=function(O,N){if(O==null){return[0,0]}var M=p(O),L=k(M,0);return[L[N+"X"],L[N+"Y"]]},v=function(L){if(L==null){return[0,0]}if(g){return[L.clientX+document.documentElement.scrollLeft,L.clientY+document.documentElement.scrollTop]}else{return G(L,"page")}},x=function(L){return G(L,"screen")},E=function(L){return G(L,"client")},k=function(M,L){return M.item?M.item(L):M[L]},p=function(L){return L.touches&&L.touches.length>0?L.touches:L.changedTouches&&L.changedTouches.length>0?L.changedTouches:L.targetTouches&&L.targetTouches.length>0?L.targetTouches:[L]},t=function(L){return p(L).length},f=function(P,N,M,O){b(P,N,M);O.__tauid=M.__tauid;if(P.addEventListener){P.addEventListener(N,M,false)}else{if(P.attachEvent){var L=N+M.__tauid;P["e"+L]=M;P[L]=function(){P["e"+L]&&P["e"+L](window.event)};P.attachEvent("on"+N,P[L])}}},z=function(N,M,L){if(L==null){return}F(N,function(){var P=K(this);u(P,M,L);if(L.__tauid!=null){if(P.removeEventListener){P.removeEventListener(M,L,false);if(r&&w[M]){P.removeEventListener(w[M],L,false)}}else{if(this.detachEvent){var O=M+L.__tauid;P[O]&&P.detachEvent("on"+M,P[O]);P[O]=null;P["e"+O]=null}}}if(L.__taTouchProxy){z(N,L.__taTouchProxy[1],L.__taTouchProxy[0])}})},F=function(N,M){if(N==null){return}N=(typeof Window!=="undefined"&&(typeof N.top!=="unknown"&&N==N.top))?[N]:(typeof N!=="string")&&(N.tagName==null&&N.length!=null)?N:typeof N==="string"?document.querySelectorAll(N):[N];for(var L=0;L<N.length;L++){M.apply(N[L])}};s.Mottle=function(P){P=P||{};var R=P.clickThreshold||250,L=P.dblClickThreshold||450,M=new m(),Q=new a(R,L),N=P.smartClicks,O=function(V,S,U,T){if(U==null){return}F(V,function(){var W=K(this);if(N&&S==="click"){e(W,S,U,T)}else{if(S==="tap"||S==="dbltap"||S==="contextmenu"){Q(W,S,U,T)}else{if(S==="mouseenter"||S=="mouseexit"){M(W,S,U,T)}else{y(W,S,U,T)}}}})};this.remove=function(S){F(S,function(){var V=K(this);if(V.__ta){for(var T in V.__ta){if(V.__ta.hasOwnProperty(T)){for(var U in V.__ta[T]){if(V.__ta[T].hasOwnProperty(U)){z(V,T,V.__ta[T][U])}}}}}V.parentNode&&V.parentNode.removeChild(V)});return this};this.on=function(W,X,U,V){var Z=arguments[0],T=arguments.length==4?arguments[2]:null,S=arguments[1],Y=arguments[arguments.length-1];O(Z,S,Y,T);return this};this.off=function(T,U,S){z(T,U,S);return this};this.trigger=function(V,S,T,Y){var ab=C&&(typeof MouseEvent==="undefined"||T==null||T.constructor===MouseEvent);var U=(r&&!C&&w[S])?w[S]:S,Z=!(r&&!C&&w[S]);var X=v(T),W=x(T),aa=E(T);F(V,function(){var ah=K(this),ad;T=T||{screenX:W[0],screenY:W[1],clientX:aa[0],clientY:aa[1]};var ag=function(ai){if(Y){ai.payload=Y}};var ac={TouchEvent:function(ai){var am=document.createTouch(window,ah,0,X[0],X[1],W[0],W[1],aa[0],aa[1],0,0,0,0);var al=document.createTouchList(am);var ak=document.createTouchList(am);var aj=document.createTouchList(am);ai.initTouchEvent(U,true,true,window,null,W[0],W[1],aa[0],aa[1],false,false,false,false,al,ak,aj,1,0)},MouseEvents:function(ai){ai.initMouseEvent(U,true,true,window,0,W[0],W[1],aa[0],aa[1],false,false,false,false,1,ah);if(H.android){var aj=document.createTouch(window,ah,0,X[0],X[1],W[0],W[1],aa[0],aa[1],0,0,0,0);ai.touches=ai.targetTouches=ai.changedTouches=document.createTouchList(aj)}}};if(document.createEvent){var ae=!Z&&!ab&&(r&&w[S]&&!H.android),af=ae?"TouchEvent":"MouseEvents";ad=document.createEvent(af);ac[af](ad);ag(ad);ah.dispatchEvent(ad)}else{if(document.createEventObject){ad=document.createEventObject();ad.eventType=ad.eventName=U;ad.screenX=W[0];ad.screenY=W[1];ad.clientX=aa[0];ad.clientY=aa[1];ag(ad);ah.fireEvent("on"+U,ad)}}});return this}};s.Mottle.consume=function(M,L){if(M.stopPropagation){M.stopPropagation()}else{M.returnValue=false}if(!L&&M.preventDefault){M.preventDefault()}};s.Mottle.pageLocation=v;s.Mottle.setForceTouchEvents=function(L){r=L};s.Mottle.setForceMouseEvents=function(L){C=L}}).call(typeof window==="undefined"?this:window);(function(){var z=this;var B=function(L,K,J){if(L.indexOf(K)===-1){J?L.unshift(K):L.push(K);return true}return false};var p=function(L,K){var J=L.indexOf(K);if(J!=-1){L.splice(J,1)}};var e=function(K,J){var M=[];for(var L=0;L<K.length;L++){if(J.indexOf(K[L])==-1){M.push(K[L])}}return M};var x=function(J){return J==null?false:(typeof J==="string"||J.constructor==String)};var o=function(M){var P=M.getBoundingClientRect(),Q=document.body,K=document.documentElement,J=window.pageYOffset||K.scrollTop||Q.scrollTop,N=window.pageXOffset||K.scrollLeft||Q.scrollLeft,O=K.clientTop||Q.clientTop||0,R=K.clientLeft||Q.clientLeft||0,S=P.top+J-O,L=P.left+N-R;return{top:Math.round(S),left:Math.round(L)}};var c=function(M,J,K){K=K||M.parentNode;var N=K.querySelectorAll(J);for(var L=0;L<N.length;L++){if(N[L]===M){return true}}return false};var F=(function(){var L=-1;if(navigator.appName=="Microsoft Internet Explorer"){var J=navigator.userAgent,K=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(K.exec(J)!=null){L=parseFloat(RegExp.$1)}}return L})(),w=50,v=50,t=F>-1&&F<9,r=F==9,k=function(L){if(t){return[L.clientX+document.documentElement.scrollLeft,L.clientY+document.documentElement.scrollTop]}else{var K=I(L),J=G(K,0);return r?[J.pageX||J.clientX,J.pageY||J.clientY]:[J.pageX,J.pageY]}},G=function(K,J){return K.item?K.item(J):K[J]},I=function(J){return J.touches&&J.touches.length>0?J.touches:J.changedTouches&&J.changedTouches.length>0?J.changedTouches:J.targetTouches&&J.targetTouches.length>0?J.targetTouches:[J]},g={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy"},n="katavorio-drag-scope",m=["stop","start","drag","drop","over","out","beforeStart"],l=function(){},u=function(){return true},b=function(J,L,M){for(var K=0;K<J.length;K++){if(J[K]!=M){L(J[K])}}},H=function(K,M,J,L){b(K,function(N){N.setActive(M);if(M){N.updatePosition()}if(J){N.setHover(L,M)}})},A=function(L,K){if(L==null){return}L=!x(L)&&(L.tagName==null&&L.length!=null)?L:[L];for(var J=0;J<L.length;J++){K.apply(L[J],[L[J]])}},C=function(J){if(J.stopPropagation){J.stopPropagation();J.preventDefault()}else{J.returnValue=false}},E="input,textarea,select,button,option",f=function(L,K,M){var J=L.srcElement||L.target;return !c(J,M.getInputFilterSelector(),K)};var q=function(M,N,K,L){this.params=N||{};this.el=M;this.params.addClass(this.el,this._class);this.uuid=i();var J=true;this.setEnabled=function(O){J=O};this.isEnabled=function(){return J};this.toggleEnabled=function(){J=!J};this.setScope=function(O){this.scopes=O?O.split(/\s+/):[L]};this.addScope=function(Q){var O={};A(this.scopes,function(R){O[R]=true});A(Q?Q.split(/\s+/):[],function(R){O[R]=true});this.scopes=[];for(var P in O){this.scopes.push(P)}};this.removeScope=function(Q){var O={};A(this.scopes,function(R){O[R]=true});A(Q?Q.split(/\s+/):[],function(R){delete O[R]});this.scopes=[];for(var P in O){this.scopes.push(P)}};this.toggleScope=function(Q){var O={};A(this.scopes,function(R){O[R]=true});A(Q?Q.split(/\s+/):[],function(R){if(O[R]){delete O[R]}else{O[R]=true}});this.scopes=[];for(var P in O){this.scopes.push(P)}};this.setScope(N.scope);this.k=N.katavorio;return N.katavorio};var h=function(){return true};var y=function(){return false};var a=function(aq,J,ai,ag){this._class=ai.draggable;var an=q.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var ar=[0,0],Y=null,ac=null,O=[0,0],P=false,am=this.params.consumeStartEvent!==false,ad=this.el,X=this.params.clone,aj=this.params.scroll,Q=J.multipleDrop!==false,af=false,Z=J.ghostProxy===true?h:J.ghostProxy&&typeof J.ghostProxy==="function"?J.ghostProxy:y,N=function(au){return au.cloneNode(true)};var ap=J.snapThreshold||5,ab=function(aD,aF,aE,av,au){av=av||ap;au=au||ap;var aA=Math.floor(aD[0]/aF),ay=aF*aA,ax=ay+aF,aC=Math.abs(aD[0]-ay)<=av?ay:Math.abs(ax-aD[0])<=av?ax:aD[0];var az=Math.floor(aD[1]/aE),aw=aE*az,aG=aw+aE,aB=Math.abs(aD[1]-aw)<=au?aw:Math.abs(aG-aD[1])<=au?aG:aD[1];return[aC,aB]};this.posses=[];this.posseRoles={};this.toGrid=function(au){if(this.params.grid==null){return au}else{return ab(au,this.params.grid[0],this.params.grid[1])}};this.snap=function(au,aw){if(ad==null){return}au=au||(this.params.grid?this.params.grid[0]:w);aw=aw||(this.params.grid?this.params.grid[1]:v);var av=this.params.getPosition(ad);this.params.setPosition(ad,ab(av,au,aw,au,aw))};this.setUseGhostProxy=function(au){Z=au?h:y};var ao;var V=function(au){return(J.allowNegative===false)?[Math.max(0,au[0]),Math.max(0,au[1])]:au};var at=function(au){ao=typeof au==="function"?au:au?function(av){return V([Math.max(0,Math.min(R.w-this.size[0],av[0])),Math.max(0,Math.min(R.h-this.size[1],av[1]))])}.bind(this):function(av){return V(av)}}.bind(this);at(typeof this.params.constrain==="function"?this.params.constrain:(this.params.constrain||this.params.containment));this.setConstrain=function(au){at(au)};var S;this.setRevert=function(au){S=au};var aa=function(au){if(typeof au=="function"){au._katavorioId=i();return au._katavorioId}else{return au}},ak={},K=function(aw){for(var au in ak){var av=ak[au];var ax=av[0](aw);if(av[1]){ax=!ax}if(!ax){return false}}return true},L=this.setFilter=function(av,aw){if(av){var au=aa(av);ak[au]=[function(az){var ay=az.srcElement||az.target,ax;if(x(av)){ax=c(ay,av,aq)}else{if(typeof av==="function"){ax=av(az,aq)}}return ax},aw!==false]}},U=this.addFilter=L,ae=this.removeFilter=function(av){var au=typeof av=="function"?av._katavorioId:av;delete ak[au]};this.clearAllFilters=function(){ak={}};this.canDrag=this.params.canDrag||u;var R,W=[],al=[];this.downListener=function(aw){var av=this.rightButtonCanDrag||(aw.which!==3&&aw.button!==2);if(av&&this.isEnabled()&&this.canDrag()){var ax=K(aw)&&f(aw,this.el,this.k);if(ax){if(!X){ad=this.el}else{ad=this.el.cloneNode(true);ad.setAttribute("id",null);ad.style.position="absolute";var au=o(this.el);ad.style.left=au.left+"px";ad.style.top=au.top+"px";document.body.appendChild(ad)}am&&C(aw);ar=k(aw);this.params.bind(document,"mousemove",this.moveListener);this.params.bind(document,"mouseup",this.upListener);an.markSelection(this);an.markPosses(this);this.params.addClass(document.body,ai.noSelect);T("beforeStart",{el:this.el,pos:Y,e:aw,drag:this})}else{if(this.params.consumeFilteredEvents){C(aw)}}}}.bind(this);this.moveListener=function(ax){if(ar){if(!P){var au=T("start",{el:this.el,pos:Y,e:ax,drag:this});if(au!==false){if(!ar){return}this.mark(true);P=true}}if(ar){al.length=0;var az=k(ax),aw=az[0]-ar[0],av=az[1]-ar[1],ay=this.params.ignoreZoom?1:an.getZoom();aw/=ay;av/=ay;this.moveBy(aw,av,ax);an.updateSelection(aw,av,this);an.updatePosses(aw,av,this)}}}.bind(this);this.upListener=function(au){if(ar){ar=null;this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.params.removeClass(document.body,ai.noSelect);this.unmark(au);an.unmarkSelection(this,au);an.unmarkPosses(this,au);this.stop(au);an.notifySelectionDragStop(this,au);an.notifyPosseDragStop(this,au);P=false;if(X){ad&&ad.parentNode&&ad.parentNode.removeChild(ad);ad=null}if(S&&S(this.el,this.params.getPosition(this.el))===true){this.params.setPosition(this.el,Y);T("revert",this.el)}}}.bind(this);this.getFilters=function(){return ak};this.abort=function(){if(ar!=null){this.upListener()}};this.getDragElement=function(){return ad||this.el};var ah={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};if(J.events.start){ah.start.push(J.events.start)}if(J.events.beforeStart){ah.beforeStart.push(J.events.beforeStart)}if(J.events.stop){ah.stop.push(J.events.stop)}if(J.events.drag){ah.drag.push(J.events.drag)}if(J.events.revert){ah.revert.push(J.events.revert)}this.on=function(au,av){if(ah[au]){ah[au].push(av)}};this.off=function(av,ax){if(ah[av]){var au=[];for(var aw=0;aw<ah[av].length;aw++){if(ah[av][aw]!==ax){au.push(ah[av][aw])}}ah[av]=au}};var T=function(au,aw){if(ah[au]){for(var av=0;av<ah[au].length;av++){try{ah[au][av](aw)}catch(ax){}}}};this.notifyStart=function(au){T("start",{el:this.el,pos:this.params.getPosition(ad),e:au,drag:this})};this.stop=function(aA,ay){if(ay||P){var au=[],ax=an.getSelection(),av=this.params.getPosition(ad);if(ax.length>1){for(var aw=0;aw<ax.length;aw++){var az=this.params.getPosition(ax[aw].el);au.push([ax[aw].el,{left:az[0],top:az[1]},ax[aw]])}}else{au.push([ad,{left:av[0],top:av[1]},this])}T("stop",{el:ad,pos:M||av,finalPos:av,e:aA,drag:this,selection:au})}};this.mark=function(au){Y=this.params.getPosition(ad);ac=this.params.getPosition(ad,true);O=[ac[0]-Y[0],ac[1]-Y[1]];this.size=this.params.getSize(ad);W=an.getMatchingDroppables(this);H(W,true,false,this);this.params.addClass(ad,this.params.dragClass||ai.drag);var av=this.params.getSize(ad.parentNode);R={w:av[0],h:av[1]};if(au){an.notifySelectionDragStart(this)}};var M;this.unmark=function(ax,av){H(W,false,true,this);if(af&&Z(this.el)){M=[ad.offsetLeft,ad.offsetTop];this.el.parentNode.removeChild(ad);ad=this.el}else{M=null}this.params.removeClass(ad,this.params.dragClass||ai.drag);W.length=0;af=false;if(!av){if(al.length>0&&M){J.setPosition(this.el,M)}al.sort(D);for(var au=0;au<al.length;au++){var aw=al[au].drop(this,ax);if(aw===true){break}}}};this.moveBy=function(aE,aD,az){al.length=0;var aB=this.toGrid([Y[0]+aE,Y[1]+aD]),aC=ao(aB,ad);if(Z(this.el)){if(aB[0]!=aC[0]||aB[1]!=aC[1]){if(!af){var av=N(this.el);J.addClass(av,g.ghostProxy);this.el.parentNode.appendChild(av);ad=av;af=true}aC=aB}else{if(af){this.el.parentNode.removeChild(ad);ad=this.el;af=false}}}var aA={x:aC[0],y:aC[1],w:this.size[0],h:this.size[1]},ax={x:aA.x+O[0],y:aA.y+O[1],w:aA.w,h:aA.h},ay=null;this.params.setPosition(ad,aC);for(var aw=0;aw<W.length;aw++){var au={x:W[aw].pagePosition[0],y:W[aw].pagePosition[1],w:W[aw].size[0],h:W[aw].size[1]};if(this.params.intersects(ax,au)&&(Q||ay==null||ay==W[aw].el)&&W[aw].canDrop(this)){if(!ay){ay=W[aw].el}al.push(W[aw]);W[aw].setHover(this,true,az)}else{if(W[aw].isHover()){W[aw].setHover(this,false,az)}}}T("drag",{el:this.el,pos:aC,e:az,drag:this})};this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener);this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.downListener=null;this.upListener=null;this.moveListener=null};this.params.bind(this.el,"mousedown",this.downListener);if(this.params.handle){L(this.params.handle,false)}else{L(this.params.filter,this.params.filterExclude)}};var s=function(M,N,J,L){this._class=J.droppable;this.params=N||{};this.rank=N.rank||0;this._activeClass=this.params.activeClass||J.active;this._hoverClass=this.params.hoverClass||J.hover;q.apply(this,arguments);var K=false;this.allowLoopback=this.params.allowLoopback!==false;this.setActive=function(O){this.params[O?"addClass":"removeClass"](this.el,this._activeClass)};this.updatePosition=function(){this.position=this.params.getPosition(this.el);this.pagePosition=this.params.getPosition(this.el,true);this.size=this.params.getSize(this.el)};this.canDrop=this.params.canDrop||function(O){return true};this.isHover=function(){return K};this.setHover=function(O,Q,P){if(Q||this.el._katavorioDragHover==null||this.el._katavorioDragHover==O.el._katavorio){this.params[Q?"addClass":"removeClass"](this.el,this._hoverClass);this.el._katavorioDragHover=Q?O.el._katavorio:null;if(K!==Q){this.params.events[Q?"over":"out"]({el:this.el,e:P,drag:O,drop:this})}K=Q}};this.drop=function(O,P){return this.params.events.drop({drag:O,e:P,drop:this})};this.destroy=function(){this._class=null;this._activeClass=null;this._hoverClass=null;K=null}};var i=function(){return("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(L){var K=Math.random()*16|0,J=L=="x"?K:(K&3|8);return J.toString(16)}))};var D=function(K,J){return K.rank<J.rank?1:K.rank>J.rank?-1:0};var d=function(J){if(J==null){return null}J=(typeof J==="string"||J.constructor==String)?document.getElementById(J):J;if(J==null){return null}J._katavorio=J._katavorio||i();return J};z.Katavorio=function(X){var P=[],L={};this._dragsByScope={};this._dropsByScope={};var Y=1,R=function(ad,ac){A(ad,function(af){for(var ae=0;ae<af.scopes.length;ae++){ac[af.scopes[ae]]=ac[af.scopes[ae]]||[];ac[af.scopes[ae]].push(af)}})},Q=function(ad,ac){var ae=0;A(ad,function(ah){for(var ag=0;ag<ah.scopes.length;ag++){if(ac[ah.scopes[ag]]){var af=X.indexOf(ac[ah.scopes[ag]],ah);if(af!=-1){ac[ah.scopes[ag]].splice(af,1);ae++}}}});return ae>0},K=this.getMatchingDroppables=function(ah){var ac=[],ae={};for(var af=0;af<ah.scopes.length;af++){var ag=this._dropsByScope[ah.scopes[af]];if(ag){for(var ad=0;ad<ag.length;ad++){if(ag[ad].canDrop(ah)&&!ae[ag[ad].uuid]&&(ag[ad].allowLoopback||ag[ad].el!==ah.el)){ae[ag[ad].uuid]=true;ac.push(ag[ad])}}}}ac.sort(D);return ac},M=function(ae){ae=ae||{};var ac={events:{}},ad;for(ad in X){ac[ad]=X[ad]}for(ad in ae){ac[ad]=ae[ad]}for(ad=0;ad<m.length;ad++){ac.events[m[ad]]=ae[m[ad]]||l}ac.katavorio=this;return ac}.bind(this),J=function(ad,ae){for(var ac=0;ac<m.length;ac++){if(ae[m[ac]]){ad.on(m[ac],ae[m[ac]])}}}.bind(this),W={},U=X.css||{},Z=X.scope||n;for(var ab in g){W[ab]=g[ab]}for(var ab in U){W[ab]=U[ab]}var T=X.inputFilterSelector||E;this.getInputFilterSelector=function(){return T};this.setInputFilterSelector=function(ac){T=ac;return this};this.draggable=function(ac,ae){var ad=[];A(ac,function(ag){ag=d(ag);if(ag!=null){if(ag._katavorioDrag==null){var af=M(ae);ag._katavorioDrag=new a(ag,af,W,Z);R(ag._katavorioDrag,this._dragsByScope);ad.push(ag._katavorioDrag);X.addClass(ag,W.draggable)}else{J(ag._katavorioDrag,ae)}}}.bind(this));return ad};this.droppable=function(ac,ae){var ad=[];A(ac,function(ag){ag=d(ag);if(ag!=null){var af=new s(ag,M(ae),W,Z);ag._katavorioDrop=ag._katavorioDrop||[];ag._katavorioDrop.push(af);R(af,this._dropsByScope);ad.push(af);X.addClass(ag,W.droppable)}}.bind(this));return ad};this.select=function(ac){A(ac,function(){var ad=d(this);if(ad&&ad._katavorioDrag){if(!L[ad._katavorio]){P.push(ad._katavorioDrag);L[ad._katavorio]=[ad,P.length-1];X.addClass(ad,W.selected)}}});return this};this.deselect=function(ac){A(ac,function(){var ag=d(this);if(ag&&ag._katavorio){var af=L[ag._katavorio];if(af){var ae=[];for(var ad=0;ad<P.length;ad++){if(P[ad].el!==ag){ae.push(P[ad])}}P=ae;delete L[ag._katavorio];X.removeClass(ag,W.selected)}}});return this};this.deselectAll=function(){for(var ac in L){var ad=L[ac];X.removeClass(ad[0],W.selected)}P.length=0;L={}};this.markSelection=function(ac){b(P,function(ad){ad.mark()},ac)};this.markPosses=function(ac){if(ac.posses){A(ac.posses,function(ad){if(ac.posseRoles[ad]&&N[ad]){b(N[ad].members,function(ae){ae.mark()},ac)}})}};this.unmarkSelection=function(ac,ad){b(P,function(ae){ae.unmark(ad)},ac)};this.unmarkPosses=function(ac,ad){if(ac.posses){A(ac.posses,function(ae){if(ac.posseRoles[ae]&&N[ae]){b(N[ae].members,function(af){af.unmark(ad,true)},ac)}})}};this.getSelection=function(){return P.slice(0)};this.updateSelection=function(ad,ac,ae){b(P,function(af){af.moveBy(ad,ac)},ae)};var V=function(ad,ac){if(ac.posses){A(ac.posses,function(ae){if(ac.posseRoles[ae]&&N[ae]){b(N[ae].members,function(af){ad(af)},ac)}})}};this.updatePosses=function(ad,ac,ae){V(function(af){af.moveBy(ad,ac)},ae)};this.notifyPosseDragStop=function(ad,ac){V(function(ae){ae.stop(ac,true)},ad)};this.notifySelectionDragStop=function(ad,ac){b(P,function(ae){ae.stop(ac,true)},ad)};this.notifySelectionDragStart=function(ad,ac){b(P,function(ae){ae.notifyStart(ac)},ad)};this.setZoom=function(ac){Y=ac};this.getZoom=function(){return Y};var aa=function(ac,ae,af,ad){A(ac,function(ag){Q(ag,af);ag[ad](ae);R(ag,af)})};A(["set","add","remove","toggle"],function(ac){this[ac+"Scope"]=function(ad,ae){aa(ad._katavorioDrag,ae,this._dragsByScope,ac+"Scope");aa(ad._katavorioDrop,ae,this._dropsByScope,ac+"Scope")}.bind(this);this[ac+"DragScope"]=function(ad,ae){aa(ad.constructor===a?ad:ad._katavorioDrag,ae,this._dragsByScope,ac+"Scope")}.bind(this);this[ac+"DropScope"]=function(ad,ae){aa(ad.constructor===s?ad:ad._katavorioDrop,ae,this._dropsByScope,ac+"Scope")}.bind(this)}.bind(this));this.snapToGrid=function(ac,ae){for(var ad in this._dragsByScope){b(this._dragsByScope[ad],function(af){af.snap(ac,ae)})}};this.getDragsForScope=function(ac){return this._dragsByScope[ac]};this.getDropsForScope=function(ac){return this._dropsByScope[ac]};var O=function(ae,ad,af){ae=d(ae);if(ae[ad]){var ac=P.indexOf(ae[ad]);if(ac>=0){P.splice(ac,1)}if(Q(ae[ad],af)){A(ae[ad],function(ag){ag.destroy()})}delete ae[ad]}};this.elementRemoved=function(ac){this.destroyDraggable(ac);this.destroyDroppable(ac)};this.destroyDraggable=function(ac){O(ac,"_katavorioDrag",this._dragsByScope)};this.destroyDroppable=function(ac){O(ac,"_katavorioDrop",this._dropsByScope)};this.reset=function(){this._dragsByScope={};this._dropsByScope={};P=[];L={};N={}};var N={};var S=function(ad,ac,ah){var ae=x(ac)?ac:ac.id;var ag=x(ac)?true:ac.active!==false;var af=N[ae]||(function(){var ai={name:ae,members:[]};N[ae]=ai;return ai})();A(ad,function(ai){if(ai._katavorioDrag){if(ah&&ai._katavorioDrag.posseRoles[af.name]!=null){return}B(af.members,ai._katavorioDrag);B(ai._katavorioDrag.posses,af.name);ai._katavorioDrag.posseRoles[af.name]=ag}});return af};this.addToPosse=function(af,ad){var ac=[];for(var ae=1;ae<arguments.length;ae++){ac.push(S(af,arguments[ae]))}return ac.length==1?ac[0]:ac};this.setPosse=function(af,ad){var ac=[];for(var ae=1;ae<arguments.length;ae++){ac.push(S(af,arguments[ae],true).name)}A(af,function(aj){if(aj._katavorioDrag){var ai=e(aj._katavorioDrag.posses,ac);var ah=[];Array.prototype.push.apply(ah,aj._katavorioDrag.posses);for(var ag=0;ag<ai.length;ag++){this.removeFromPosse(aj,ai[ag])}}}.bind(this));return ac.length==1?ac[0]:ac};this.removeFromPosse=function(ad,ae){if(arguments.length<2){throw new TypeError("No posse id provided for remove operation")}for(var ac=1;ac<arguments.length;ac++){ae=arguments[ac];A(ad,function(ag){if(ag._katavorioDrag&&ag._katavorioDrag.posses){var af=ag._katavorioDrag;A(ae,function(ah){p(N[ah].members,af);p(af.posses,ah);delete af.posseRoles[ah]})}})}};this.removeFromAllPosses=function(ac){A(ac,function(ae){if(ae._katavorioDrag&&ae._katavorioDrag.posses){var ad=ae._katavorioDrag;A(ad.posses,function(af){p(N[af].members,ad)});ad.posses.length=0;ad.posseRoles={}}})};this.setPosseState=function(ac,ad,af){var ae=N[ad];if(ae){A(ac,function(ag){if(ag._katavorioDrag&&ag._katavorioDrag.posses){ag._katavorioDrag.posseRoles[ae.name]=af}})}}}}).call(typeof window!=="undefined"?window:this);(function(){var l=function(m){return Object.prototype.toString.call(m)==="[object Array]"},d=function(m){return Object.prototype.toString.call(m)==="[object Number]"},a=function(m){return typeof m==="string"},i=function(m){return typeof m==="boolean"},b=function(m){return m==null},c=function(m){return m==null?false:Object.prototype.toString.call(m)==="[object Object]"},g=function(m){return Object.prototype.toString.call(m)==="[object Date]"},e=function(m){return Object.prototype.toString.call(m)==="[object Function]"},k=function(m){return e(m)&&m.name!=null&&m.name.length>0},f=function(n){for(var m in n){if(n.hasOwnProperty(m)){return false}}return true};var h=this;h.jsPlumbUtil={isArray:l,isString:a,isBoolean:i,isNull:b,isObject:c,isDate:g,isFunction:e,isEmpty:f,isNumber:d,clone:function(n){if(a(n)){return""+n}else{if(i(n)){return !!n}else{if(g(n)){return new Date(n.getTime())}else{if(e(n)){return n}else{if(l(n)){var m=[];for(var p=0;p<n.length;p++){m.push(this.clone(n[p]))}return m}else{if(c(n)){var q={};for(var o in n){q[o]=this.clone(n[o])}return q}else{return n}}}}}}},merge:function(n,m,s){var r={},o,q;s=s||[];for(q=0;q<s.length;q++){r[s[q]]=true}var t=this.clone(n);for(q in m){if(t[q]==null){t[q]=m[q]}else{if(a(m[q])||i(m[q])){if(!r[q]){t[q]=m[q]}else{o=[];o.push.apply(o,l(t[q])?t[q]:[t[q]]);o.push.apply(o,l(m[q])?m[q]:[m[q]]);t[q]=o}}else{if(l(m[q])){o=[];if(l(t[q])){o.push.apply(o,t[q])}o.push.apply(o,m[q]);t[q]=o}else{if(c(m[q])){if(!c(t[q])){t[q]={}}for(var p in m[q]){t[q][p]=m[q][p]}}}}}}return t},replace:function(p,r,o){if(p==null){return}var n=p,m=n;r.replace(/([^\.])+/g,function(s,v,y,w){var x=s.match(/([^\[0-9]+){1}(\[)([0-9+])/),u=y+s.length>=w.length,t=function(){return m[x[1]]||(function(){m[x[1]]=[];return m[x[1]]})()};if(u){if(x){t()[x[3]]=o}else{m[s]=o}}else{if(x){var q=t();m=q[x[3]]||(function(){q[x[3]]={};return q[x[3]]})()}else{m=m[s]||(function(){m[s]={};return m[s]})()}}});return p},functionChain:function(p,r,n){for(var m=0;m<n.length;m++){var q=n[m][0][n[m][1]].apply(n[m][0],n[m][2]);if(q===r){return q}}return p},populate:function(o,n,p){var m=function(u){var s=u.match(/(\${.*?})/g);if(s!=null){for(var r=0;r<s.length;r++){var t=n[s[r].substring(2,s[r].length-1)]||"";if(t!=null){u=u.replace(s[r],t)}}}return u},q=function(x){if(x!=null){if(a(x)){return m(x)}else{if(e(x)&&(p==null||(x.name||"").indexOf(p)===0)){return x(n)}else{if(l(x)){var w=[];for(var u=0;u<x.length;u++){w.push(q(x[u]))}return w}else{if(c(x)){var v={};for(var t in x){v[t]=q(x[t])}return v}else{return x}}}}}};return q(o)},findWithFunction:function(m,o){if(m){for(var n=0;n<m.length;n++){if(o(m[n])){return n}}}return -1},removeWithFunction:function(n,o){var m=h.jsPlumbUtil.findWithFunction(n,o);if(m>-1){n.splice(m,1)}return m!=-1},remove:function(n,o){var m=n.indexOf(o);if(m>-1){n.splice(m,1)}return m!=-1},addWithFunction:function(o,n,m){if(h.jsPlumbUtil.findWithFunction(o,m)==-1){o.push(n)}},addToList:function(q,n,p,o){var m=q[n];if(m==null){m=[];q[n]=m}m[o?"unshift":"push"](p);return m},suggest:function(o,n,m){if(o.indexOf(n)===-1){if(m){o.unshift(n)}else{o.push(n)}return true}return false},extend:function(s,r,q){var o;r=l(r)?r:[r];for(o=0;o<r.length;o++){for(var n in r[o].prototype){if(r[o].prototype.hasOwnProperty(n)){s.prototype[n]=r[o].prototype[n]}}}var m=function(t,u){return function(){for(o=0;o<r.length;o++){if(r[o].prototype[t]){r[o].prototype[t].apply(this,arguments)}}return u.apply(this,arguments)}};var p=function(u){for(var t in u){s.prototype[t]=m(t,u[t])}};if(arguments.length>2){for(o=2;o<arguments.length;o++){p(arguments[o])}}return s},uuid:function(){return("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var n=Math.random()*16|0,m=o=="x"?n:(n&3|8);return m.toString(16)}))},logEnabled:true,log:function(){if(h.jsPlumbUtil.logEnabled&&typeof console!="undefined"){try{var n=arguments[arguments.length-1];console.log(n)}catch(m){}}},wrap:function(o,m,n){o=o||function(){};m=m||function(){};return function(){var p=null;try{p=m.apply(this,arguments)}catch(q){h.jsPlumbUtil.log("jsPlumb function failed : "+q)}if(n==null||(p!==n)){try{p=o.apply(this,arguments)}catch(q){h.jsPlumbUtil.log("wrapped function failed : "+q)}}return p}}};h.jsPlumbUtil.EventGenerator=function(){var n={},o=false,m={ready:true};this.bind=function(s,t,r){var q=function(u){h.jsPlumbUtil.addToList(n,u,t,r);t.__jsPlumb=t.__jsPlumb||{};t.__jsPlumb[h.jsPlumbUtil.uuid()]=u};if(typeof s==="string"){q(s)}else{if(s.length!=null){for(var p=0;p<s.length;p++){q(s[p])}}}return this};this.fire=function(u,v,p){if(!o&&n[u]){var r=n[u].length,t=0,q=false,s=null;if(!this.shouldFireEvent||this.shouldFireEvent(u,v,p)){while(!q&&t<r&&s!==false){if(m[u]){n[u][t].apply(this,[v,p])}else{try{s=n[u][t].apply(this,[v,p])}catch(w){h.jsPlumbUtil.log("jsPlumb: fire failed for event "+u+" : "+w)}}t++;if(n==null||n[u]==null){q=true}}}}return this};this.unbind=function(r,s){if(arguments.length===0){n={}}else{if(arguments.length===1){if(typeof r==="string"){delete n[r]}else{if(r.__jsPlumb){var p;for(var q in r.__jsPlumb){p=r.__jsPlumb[q];h.jsPlumbUtil.remove(n[p]||[],r)}}}}else{if(arguments.length===2){h.jsPlumbUtil.remove(n[r]||[],s)}}}return this};this.getListener=function(p){return n[p]};this.setSuspendEvents=function(p){o=p};this.isSuspendEvents=function(){return o};this.silently=function(p){this.setSuspendEvents(true);try{p()}catch(q){h.jsPlumbUtil.log("Cannot execute silent function "+q)}this.setSuspendEvents(false)};this.cleanupListeners=function(){for(var p in n){n[p]=null}}};h.jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}};if(typeof exports!=="undefined"){exports.jsPlumbUtil=h.jsPlumbUtil}}).call(typeof window!=="undefined"?window:this);(function(){var a=this;var b=a.jsPlumbUtil;b.matchesSelector=function(f,c,d){d=d||f.parentNode;var g=d.querySelectorAll(c);for(var e=0;e<g.length;e++){if(g[e]===f){return true}}return false};b.consume=function(d,c){if(d.stopPropagation){d.stopPropagation()}else{d.returnValue=false}if(!c&&d.preventDefault){d.preventDefault()}};b.sizeElement=function(f,c,g,d,e){if(f){f.style.height=e+"px";f.height=e;f.style.width=d+"px";f.width=d;f.style.left=c+"px";f.style.top=g+"px"}}}).call(typeof window!=="undefined"?window:this);(function(){var o=this;var p=[],s;var d=o.jsPlumbUtil,m=function(w,v,x){return v.getOffset(w,x)},i=function(){return""+(new Date()).getTime()},t=function(v){if(v._jsPlumb.paintStyle&&v._jsPlumb.hoverPaintStyle){var w={};g.extend(w,v._jsPlumb.paintStyle);g.extend(w,v._jsPlumb.hoverPaintStyle);delete v._jsPlumb.hoverPaintStyle;if(w.gradient&&v._jsPlumb.paintStyle.fill){delete w.gradient}v._jsPlumb.hoverPaintStyle=w}},c=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],l={mouseout:"mouseleave",mouseexit:"mouseleave"},u=function(x,B,A,w){var z=x.getAttachedElements();if(z){for(var y=0,v=z.length;y<v;y++){if(!w||w!=z[y]){z[y].setHover(B,true,A)}}}},h=function(v){return v==null?null:v.split(" ")},f=function(y,x,w){for(var v in x){y[v]=w}},q=function(w,y){y=d.isArray(y)||(y.length!=null&&!d.isString(y))?y:[y];for(var v=0;v<y.length;v++){try{w.apply(y[v],[y[v]])}catch(x){d.log(".each iteration failed : "+x)}}},k=function(E,z,D){if(E.getDefaultType){var x=E.getTypeDescriptor(),v={};var A=E.getDefaultType();var w=d.merge({},A);f(v,A,"__default");for(var C=0,B=E._jsPlumb.types.length;C<B;C++){var y=E._jsPlumb.types[C];if(y!=="__default"){var F=E._jsPlumb.instance.getType(y,x);if(F!=null){w=d.merge(w,F,["cssClass"]);f(v,F,y)}}}if(z){w=d.populate(w,z,"_")}E.applyType(w,D,v);if(!D){E.repaint()}}},r=o.jsPlumbUIComponent=function(z){d.EventGenerator.apply(this,arguments);var H=this,G=arguments,v=H.idPrefix,x=v+(new Date()).getTime();this._jsPlumb={instance:z._jsPlumb,parameters:z.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:false,beforeDetach:z.beforeDetach,beforeDrop:z.beforeDrop,overlayPlacements:[],hoverClass:z.hoverClass||z._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}};this.cacheTypeItem=function(I,K,J){this._jsPlumb.typeCache[J]=this._jsPlumb.typeCache[J]||{};this._jsPlumb.typeCache[J][I]=K};this.getCachedTypeItem=function(I,J){return this._jsPlumb.typeCache[J]?this._jsPlumb.typeCache[J][I]:null};this.getId=function(){return x};var y=z.overlays||[],C={};if(this.defaultOverlayKeys){for(var B=0;B<this.defaultOverlayKeys.length;B++){Array.prototype.push.apply(y,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[B]]||[])}for(B=0;B<y.length;B++){var F=g.convertToFullOverlaySpec(y[B]);C[F[1].id]=F}}var E={overlays:C,parameters:z.parameters||{},scope:z.scope||this._jsPlumb.instance.getDefaultScope()};this.getDefaultType=function(){return E};this.appendToDefaultType=function(J){for(var I in J){E[I]=J[I]}};if(z.events){for(B in z.events){H.bind(B,z.events[B])}}this.clone=function(){var I=Object.create(this.constructor.prototype);this.constructor.apply(I,G);return I}.bind(this);this.isDetachAllowed=function(I){var J=true;if(this._jsPlumb.beforeDetach){try{J=this._jsPlumb.beforeDetach(I)}catch(K){d.log("jsPlumb: beforeDetach callback failed",K)}}return J};this.isDropAllowed=function(O,P,Q,K,N,I,M){var J=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:O,targetId:P,scope:Q,connection:K,dropEndpoint:N,source:I,target:M});if(this._jsPlumb.beforeDrop){try{J=this._jsPlumb.beforeDrop({sourceId:O,targetId:P,scope:Q,connection:K,dropEndpoint:N,source:I,target:M})}catch(L){d.log("jsPlumb: beforeDrop callback failed",L)}}return J};var A=[],D=function(K,J,I){A.push([K,J,I]);K.bind(J,I)},w=[];this.setListenerComponent=function(J){for(var I=0;I<w.length;I++){w[I][3]=J}}};var b=function(w,v){var y=w._jsPlumb.types[v],x=w._jsPlumb.instance.getType(y,w.getTypeDescriptor());if(x!=null){if(x.cssClass&&w.canvas){w._jsPlumb.instance.removeClass(w.canvas,x.cssClass)}}};d.extend(o.jsPlumbUIComponent,d.EventGenerator,{getParameter:function(v){return this._jsPlumb.parameters[v]},setParameter:function(v,w){this._jsPlumb.parameters[v]=w},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(v){this._jsPlumb.parameters=v},getClass:function(){return g.getClass(this.canvas)},hasClass:function(v){return g.hasClass(this.canvas,v)},addClass:function(v){g.addClass(this.canvas,v)},removeClass:function(v){g.removeClass(this.canvas,v)},updateClasses:function(w,v){g.updateClasses(this.canvas,w,v)},setType:function(v,x,w){this.clearTypes();this._jsPlumb.types=h(v)||[];k(this,x,w)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(w,v){k(this,w,v)},hasType:function(v){return this._jsPlumb.types.indexOf(v)!=-1},addType:function(y,B,z){var x=h(y),A=false;if(x!=null){for(var w=0,v=x.length;w<v;w++){if(!this.hasType(x[w])){this._jsPlumb.types.push(x[w]);A=true}}if(A){k(this,B,z)}}},removeType:function(z,C,A){var x=h(z),B=false,y=function(E){var D=this._jsPlumb.types.indexOf(E);if(D!=-1){b(this,D);this._jsPlumb.types.splice(D,1);return true}return false}.bind(this);if(x!=null){for(var w=0,v=x.length;w<v;w++){B=y(x[w])||B}if(B){k(this,C,A)}}},clearTypes:function(y,x){var w=this._jsPlumb.types.length;for(var v=0;v<w;v++){b(this,0);this._jsPlumb.types.splice(0,1)}k(this,y,x)},toggleType:function(z,B,A){var y=h(z);if(y!=null){for(var x=0,w=y.length;x<w;x++){var v=this._jsPlumb.types.indexOf(y[x]);if(v!=-1){b(this,v);this._jsPlumb.types.splice(v,1)}else{this._jsPlumb.types.push(y[x])}}k(this,B,A)}},applyType:function(w,x){this.setPaintStyle(w.paintStyle,x);this.setHoverPaintStyle(w.hoverPaintStyle,x);if(w.parameters){for(var v in w.parameters){this.setParameter(v,w.parameters[v])}}this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(v,w){this._jsPlumb.paintStyle=v;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;t(this);if(!w){this.repaint()}},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(v,w){this._jsPlumb.hoverPaintStyle=v;t(this);if(!w){this.repaint()}},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(v){if(v||this.typeId==null){this.cleanupListeners();this.clone=null;this._jsPlumb=null}},isHover:function(){return this._jsPlumb.hover},setHover:function(v,x,w){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=v;if(this.canvas!=null){if(this._jsPlumb.instance.hoverClass!=null){var y=v?"addClass":"removeClass";this._jsPlumb.instance[y](this.canvas,this._jsPlumb.instance.hoverClass)}if(this._jsPlumb.hoverClass!=null){this._jsPlumb.instance[y](this.canvas,this._jsPlumb.hoverClass)}}if(this._jsPlumb.hoverPaintStyle!=null){this._jsPlumb.paintStyleInUse=v?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle;if(!this._jsPlumb.instance.isSuspendDrawing()){w=w||i();this.repaint({timestamp:w,recalc:false})}}if(this.getAttachedElements&&!x){u(this,v,i(),this)}}}});var e=0,a=function(){var v=e+1;e++;return v};var n=o.jsPlumbInstance=function(y){if(y){g.extend(this.Defaults,y)}this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};d.EventGenerator.apply(this);var aL=this,ai=a(),al=aL.bind,ad={},N=1,Q=function(aR){if(aR==null){return null}else{if(aR.nodeType==3||aR.nodeType==8){return{el:aR,text:true}}else{var aS=aL.getElement(aR);return{el:aS,id:(d.isString(aR)&&aS==null)?aR:w(aS)}}}};this.getInstanceIndex=function(){return ai};this.setZoom=function(aS,aR){N=aS;aL.fire("zoom",N);if(aR){aL.repaintEverything()}return true};this.getZoom=function(){return N};for(var aa in this.Defaults){ad[aa]=this.Defaults[aa]}var aI,aM=[];this.unbindContainer=function(){if(aI!=null&&aM.length>0){for(var aR=0;aR<aM.length;aR++){aL.off(aI,aM[aR][0],aM[aR][1])}}};this.setContainer=function(aZ){this.unbindContainer();aZ=this.getElement(aZ);this.select().each(function(a0){a0.moveParent(aZ)});this.selectEndpoints().each(function(a0){a0.moveParent(aZ)});var aS=aI;aI=aZ;aM.length=0;var aY={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"};var aV=function(a5,a4,a1){var a3=a4.srcElement||a4.target,a0=(a3&&a3.parentNode?a3.parentNode._jsPlumb:null)||(a3?a3._jsPlumb:null)||(a3&&a3.parentNode&&a3.parentNode.parentNode?a3.parentNode.parentNode._jsPlumb:null);if(a0){a0.fire(a5,a0,a4);var a2=a1?aY[a1+a5]||a5:a5;aL.fire(a2,a0.component||a0,a4)}};var aT=function(a2,a0,a1){aM.push([a2,a1]);aL.on(aI,a2,a0,a1)};var aW=function(a0){aT(a0,".jtk-connector",function(a1){aV(a0,a1)});aT(a0,".jtk-endpoint",function(a1){aV(a0,a1,"endpoint")});aT(a0,".jtk-overlay",function(a1){aV(a0,a1)})};for(var aX=0;aX<c.length;aX++){aW(c[aX])}for(var aU in I){var aR=I[aU].el;if(aR.parentNode===aS){aS.removeChild(aR);aI.appendChild(aR)}}};this.getContainer=function(){return aI};this.bind=function(aS,aR){if("ready"===aS&&z){aR()}else{al.apply(aL,[aS,aR])}};aL.importDefaults=function(aS){for(var aR in aS){aL.Defaults[aR]=aS[aR]}if(aS.Container){aL.setContainer(aS.Container)}return aL};aL.restoreDefaults=function(){aL.Defaults=g.extend({},ad);return aL};var C=null,z=false,H=[],ap={},aq={},I={},R={},aO={},aJ={},U=false,P=[],ax=false,az=null,G=this.Defaults.Scope,ae=1,S=function(){return""+ae++},at=function(aS,aR){if(aI){aI.appendChild(aS)}else{if(!aR){this.appendToRoot(aS)}else{this.getElement(aR).appendChild(aS)}}}.bind(this),aA=function(aW,aZ,aY,aT){if(!ax){var aR=w(aW),a0,aX=aL.getDragManager();if(aX){a0=aX.getElementsForDraggable(aR)}if(aY==null){aY=i()}var aS=L({elId:aR,offset:aZ,recalc:false,timestamp:aY});if(a0&&aS&&aS.o){for(var aV in a0){L({elId:a0[aV].id,offset:{left:aS.o.left+a0[aV].offset.left,top:aS.o.top+a0[aV].offset.top},recalc:false,timestamp:aY})}}aL.anchorManager.redraw(aR,aZ,aY,null,aT);if(a0){for(var aU in a0){aL.anchorManager.redraw(a0[aU].id,aZ,aY,a0[aU].offset,aT,true)}}}},W=function(aR){return aq[aR]},aC=function(aX,aR,a1,aS,a0){if(!g.headless){var aT=aR==null?false:aR;if(aT){if(g.isDragSupported(aX,aL)){var a3=a1||aL.Defaults.DragOptions;a3=g.extend({},a3);if(!g.isAlreadyDraggable(aX,aL)){var aZ=g.dragEvents.drag,aU=g.dragEvents.stop,aW=g.dragEvents.start,aY=false;X(aS,aX);a3[aW]=d.wrap(a3[aW],function(){aL.setHoverSuspended(true);aL.select({source:aX}).addClass(aL.elementDraggingClass+" "+aL.sourceElementDraggingClass,true);aL.select({target:aX}).addClass(aL.elementDraggingClass+" "+aL.targetElementDraggingClass,true);aL.setConnectionBeingDragged(true);if(a3.canDrag){return a1.canDrag()}},false);a3[aZ]=d.wrap(a3[aZ],function(){var a4=aL.getUIPosition(arguments,aL.getZoom());if(a4!=null){aA(aX,a4,null,true);if(aY){aL.addClass(aX,"jtk-dragged")}aY=true}});a3[aU]=d.wrap(a3[aU],function(){var a7=arguments[0].selection,a4;var a6=function(a8){if(a8[1]!=null){a4=aL.getUIPosition([{el:a8[2].el,pos:[a8[1].left,a8[1].top]}]);aA(a8[2].el,a4)}aL.removeClass(a8[0],"jtk-dragged");aL.select({source:a8[2].el}).removeClass(aL.elementDraggingClass+" "+aL.sourceElementDraggingClass,true);aL.select({target:a8[2].el}).removeClass(aL.elementDraggingClass+" "+aL.targetElementDraggingClass,true);aL.getDragManager().dragEnded(a8[2].el)};for(var a5=0;a5<a7.length;a5++){a6(a7[a5])}aY=false;aL.setHoverSuspended(false);aL.setConnectionBeingDragged(false)});var aV=w(aX);aJ[aV]=true;var a2=aJ[aV];a3.disabled=a2==null?false:!a2;aL.initDraggable(aX,a3);aL.getDragManager().register(aX);if(a0){aL.fire("elementDraggable",{el:aX,options:a3})}}else{if(a1.force){aL.initDraggable(aX,a3)}}}}}},E=function(aW,aV){var aU=aW.scope.split(/\s/),aS=aV.scope.split(/\s/);for(var aT=0;aT<aU.length;aT++){for(var aR=0;aR<aS.length;aR++){if(aS[aR]==aU[aT]){return true}}}return false},Z=function(aY,aS){var aR=g.extend({},aY);if(aS){g.extend(aR,aS)}if(aR.source){if(aR.source.endpoint){aR.sourceEndpoint=aR.source}else{aR.source=aL.getElement(aR.source)}}if(aR.target){if(aR.target.endpoint){aR.targetEndpoint=aR.target}else{aR.target=aL.getElement(aR.target)}}if(aY.uuids){aR.sourceEndpoint=W(aY.uuids[0]);aR.targetEndpoint=W(aY.uuids[1])}if(aR.sourceEndpoint&&aR.sourceEndpoint.isFull()){d.log(aL,"could not add connection; source endpoint is full");return}if(aR.targetEndpoint&&aR.targetEndpoint.isFull()){d.log(aL,"could not add connection; target endpoint is full");return}if(!aR.type&&aR.sourceEndpoint){aR.type=aR.sourceEndpoint.connectionType}if(aR.sourceEndpoint&&aR.sourceEndpoint.connectorOverlays){aR.overlays=aR.overlays||[];for(var aX=0,aW=aR.sourceEndpoint.connectorOverlays.length;aX<aW;aX++){aR.overlays.push(aR.sourceEndpoint.connectorOverlays[aX])}}if(aR.sourceEndpoint&&aR.sourceEndpoint.scope){aR.scope=aR.sourceEndpoint.scope}if(!aR["pointer-events"]&&aR.sourceEndpoint&&aR.sourceEndpoint.connectorPointerEvents){aR["pointer-events"]=aR.sourceEndpoint.connectorPointerEvents}var aV=function(a2,a0){var aZ=g.extend({},a2);for(var a1 in a0){if(a0[a1]){aZ[a1]=a0[a1]}}return aZ};var aU=function(a0,a1,aZ){return aL.addEndpoint(a0,aV(a1,{anchor:aR.anchors?aR.anchors[aZ]:aR.anchor,endpoint:aR.endpoints?aR.endpoints[aZ]:aR.endpoint,paintStyle:aR.endpointStyles?aR.endpointStyles[aZ]:aR.endpointStyle,hoverPaintStyle:aR.endpointHoverStyles?aR.endpointHoverStyles[aZ]:aR.endpointHoverStyle}))};var aT=function(a2,a0,aZ,a4){if(aR[a2]&&!aR[a2].endpoint&&!aR[a2+"Endpoint"]&&!aR.newConnection){var a3=w(aR[a2]),a5=aZ[a3];a5=a5?a5[a4]:null;if(a5){if(!a5.enabled){return false}var a1=a5.endpoint!=null&&a5.endpoint._jsPlumb?a5.endpoint:aU(aR[a2],a5.def,a0);if(a1.isFull()){return false}aR[a2+"Endpoint"]=a1;if(!aR.scope&&a5.def.scope){aR.scope=a5.def.scope}a1._doNotDeleteOnDetach=false;a1._deleteOnDetach=true;if(a5.uniqueEndpoint){if(!a5.endpoint){a5.endpoint=a1;a1._deleteOnDetach=false;a1._doNotDeleteOnDetach=true}else{a1.finalEndpoint=a5.endpoint}}}}};if(aT("source",0,this.sourceEndpointDefinitions,aR.type||"default")===false){return}if(aT("target",1,this.targetEndpointDefinitions,aR.type||"default")===false){return}if(aR.sourceEndpoint&&aR.targetEndpoint){if(!E(aR.sourceEndpoint,aR.targetEndpoint)){aR=null}}return aR}.bind(aL),O=function(aT){var aS=aL.Defaults.ConnectionType||aL.getDefaultConnectionType();aT._jsPlumb=aL;aT.newConnection=O;aT.newEndpoint=af;aT.endpointsByUUID=aq;aT.endpointsByElement=ap;aT.finaliseConnection=aQ;aT.id="con_"+S();var aR=new aS(aT);if(aR.isDetachable()){aR.endpoints[0].initDraggable("_jsPlumbSource");aR.endpoints[1].initDraggable("_jsPlumbTarget")}return aR},aQ=aL.finaliseConnection=function(aU,aV,aR,aT){aV=aV||{};if(!aU.suspendedEndpoint){H.push(aU)}aU.pending=null;aU.endpoints[0].isTemporarySource=false;if(aT!==false){aL.anchorManager.newConnection(aU)}aA(aU.source);if(!aV.doNotFireConnectionEvent&&aV.fireEvent!==false){var aS={connection:aU,source:aU.source,target:aU.target,sourceId:aU.sourceId,targetId:aU.targetId,sourceEndpoint:aU.endpoints[0],targetEndpoint:aU.endpoints[1]};aL.fire("connection",aS,aR)}},af=function(aU,aV){var aT=aL.Defaults.EndpointType||g.Endpoint;var aR=g.extend({},aU);aR._jsPlumb=aL;aR.newConnection=O;aR.newEndpoint=af;aR.endpointsByUUID=aq;aR.endpointsByElement=ap;aR.fireDetachEvent=ay;aR.elementId=aV||w(aR.source);var aS=new aT(aR);aS.id="ep_"+S();X(aR.elementId,aR.source);if(!g.headless){aL.getDragManager().endpointAdded(aR.source,aV)}return aS},K=function(aU,aT,aW){var aS=ap[aU];if(aS&&aS.length){for(var aX=0,aZ=aS.length;aX<aZ;aX++){for(var aV=0,aY=aS[aX].connections.length;aV<aY;aV++){var aR=aT(aS[aX].connections[aV]);if(aR){return}}if(aW){aW(aS[aX])}}}},aG=function(aS,aR){return g.each(aS,function(aT){if(aL.isDragSupported(aT)){aJ[aL.getAttribute(aT,"id")]=aR;aL.setElementDraggable(aT,aR)}})},av=function(aT,aU,aR){aU=aU==="block";var aS=null;if(aR){aS=function(aW){aW.setVisible(aU,true,true)}}var aV=Q(aT);K(aV.id,function(aX){if(aU&&aR){var aW=aX.sourceId===aV.id?1:0;if(aX.endpoints[aW].isVisible()){aX.setVisible(true)}}else{aX.setVisible(aU)}},aS)},aE=function(aR){var aS;g.each(aR,function(aU){var aT=aL.getAttribute(aU,"id");aS=aJ[aT]==null?false:aJ[aT];aS=!aS;aJ[aT]=aS;aL.setDraggable(aU,aS);return aS}.bind(this));return aS},an=function(aR,aT){var aS=null;if(aT){aS=function(aU){var aV=aU.isVisible();aU.setVisible(!aV)}}K(aR,function(aV){var aU=aV.isVisible();aV.setVisible(!aU)},aS)},ak=function(aR){var aS=R[aR];if(!aS){return L({elId:aR})}else{return{o:aS,s:P[aR]}}},w=function(aR,aS,aT){if(d.isString(aR)){return aR}if(aR==null){return null}var aU=aL.getAttribute(aR,"id");if(!aU||aU==="undefined"){if(arguments.length==2&&arguments[1]!==undefined){aU=aS}else{if(arguments.length==1||(arguments.length==3&&!arguments[2])){aU="jsPlumb_"+ai+"_"+S()}}if(!aT){aL.setAttribute(aR,"id",aU)}}return aU};this.setConnectionBeingDragged=function(aR){U=aR};this.isConnectionBeingDragged=function(){return U};this.getManagedElements=function(){return I};this.connectorClass="jtk-connector";this.connectorOutlineClass="jtk-connector-outline";this.editableConnectorClass="jtk-connector-editable";this.connectedClass="jtk-connected";this.hoverClass="jtk-hover";this.endpointClass="jtk-endpoint";this.endpointConnectedClass="jtk-endpoint-connected";this.endpointFullClass="jtk-endpoint-full";this.endpointDropAllowedClass="jtk-endpoint-drop-allowed";this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden";this.overlayClass="jtk-overlay";this.draggingClass="jtk-dragging";this.elementDraggingClass="jtk-element-dragging";this.sourceElementDraggingClass="jtk-source-element-dragging";this.targetElementDraggingClass="jtk-target-element-dragging";this.endpointAnchorClassPrefix="jtk-endpoint-anchor";this.hoverSourceClass="jtk-source-hover";this.hoverTargetClass="jtk-target-hover";this.dragSelectClass="jtk-drag-select";this.Anchors={};this.Connectors={svg:{}};this.Endpoints={svg:{}};this.Overlays={svg:{}};this.ConnectorRenderers={};this.SVG="svg";this.addEndpoint=function(aT,aU,a1){a1=a1||{};var aS=g.extend({},a1);g.extend(aS,aU);aS.endpoint=aS.endpoint||aL.Defaults.Endpoint;aS.paintStyle=aS.paintStyle||aL.Defaults.EndpointStyle;var aW=[],aY=(d.isArray(aT)||(aT.length!=null&&!d.isString(aT)))?aT:[aT];for(var aX=0,aV=aY.length;aX<aV;aX++){aS.source=aL.getElement(aY[aX]);v(aS.source);var aR=w(aS.source),a0=af(aS,aR);var aZ=X(aR,aS.source).info.o;d.addToList(ap,aR,a0);if(!ax){a0.paint({anchorLoc:a0.anchor.compute({xy:[aZ.left,aZ.top],wh:P[aR],element:a0,timestamp:az}),timestamp:az})}aW.push(a0);a0._doNotDeleteOnDetach=true}return aW.length==1?aW[0]:aW};this.addEndpoints=function(aW,aS,aR){var aV=[];for(var aU=0,aT=aS.length;aU<aT;aU++){var aX=aL.addEndpoint(aW,aS[aU],aR);if(d.isArray(aX)){Array.prototype.push.apply(aV,aX)}else{aV.push(aX)}}return aV};this.animate=function(aU,aT,aS){if(!this.animationSupported){return false}aS=aS||{};var aR=aL.getElement(aU),aX=w(aR),aW=g.animEvents.step,aV=g.animEvents.complete;aS[aW]=d.wrap(aS[aW],function(){aL.revalidate(aX)});aS[aV]=d.wrap(aS[aV],function(){aL.revalidate(aX)});aL.doAnimate(aR,aT,aS)};this.checkCondition=function(aW,aU){var aR=aL.getListener(aW),aX=true;if(aR&&aR.length>0){var aS=Array.prototype.slice.call(arguments,1);try{for(var aV=0,aT=aR.length;aV<aT;aV++){aX=aX&&aR[aV].apply(aR[aV],aS)}}catch(aY){d.log(aL,"cannot check condition ["+aW+"]"+aY)}}return aX};this.connect=function(aU,aS){var aR=Z(aU,aS),aT;if(aR){if(aR.source==null&&aR.sourceEndpoint==null){d.log("Cannot establish connection - source does not exist");return}if(aR.target==null&&aR.targetEndpoint==null){d.log("Cannot establish connection - target does not exist");return}v(aR.source);aT=O(aR);aQ(aT,aR)}return aT};var V=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}];var aH=function(aW,aS,aZ,aU){var a3,aV=V[aZ],aX=aW[aV.elId],aY=aW[aV.el],aR,a2,aT=aW.endpoints[aZ];var a0={index:aZ,originalSourceId:aZ===0?aX:aW.sourceId,newSourceId:aW.sourceId,originalTargetId:aZ==1?aX:aW.targetId,newTargetId:aW.targetId,connection:aW};if(aS.constructor==g.Endpoint){a3=aS;a3.addConnection(aW);aS=a3.element}else{aR=w(aS);a2=this[aV.epDefs][aR];if(aR===aW[aV.elId]){a3=null}else{if(a2){for(var a1 in a2){if(!a2[a1].enabled){return}a3=a2[a1].endpoint!=null&&a2[a1].endpoint._jsPlumb?a2[a1].endpoint:this.addEndpoint(aS,a2[a1].def);if(a2[a1].uniqueEndpoint){a2[a1].endpoint=a3}a3._doNotDeleteOnDetach=false;a3._deleteOnDetach=true;a3.addConnection(aW)}}else{a3=aW.makeEndpoint(aZ===0,aS,aR);a3._doNotDeleteOnDetach=false;a3._deleteOnDetach=true}}}if(a3!=null){aT.detachFromConnection(aW);aW.endpoints[aZ]=a3;aW[aV.el]=a3.element;aW[aV.elId]=a3.elementId;a0[aZ===0?"newSourceId":"newTargetId"]=a3.elementId;aw(a0);if(!aU){aW.repaint()}}a0.element=aS;return a0}.bind(this);this.setSource=function(aR,aS,aU){var aT=aH(aR,aS,0,aU);this.anchorManager.sourceChanged(aT.originalSourceId,aT.newSourceId,aR,aT.el)};this.setTarget=function(aR,aS,aU){var aT=aH(aR,aS,1,aU);this.anchorManager.updateOtherEndpoint(aT.originalSourceId,aT.originalTargetId,aT.newTargetId,aR)};this.deleteEndpoint=function(aR,aS,aT){var aU=(typeof aR==="string")?aq[aR]:aR;if(aU){aL.deleteObject({endpoint:aU,dontUpdateHover:aS,deleteAttachedObjects:aT})}return aL};this.deleteEveryEndpoint=function(){var aR=aL.setSuspendDrawing(true);for(var aV in ap){var aS=ap[aV];if(aS&&aS.length){for(var aU=0,aT=aS.length;aU<aT;aU++){aL.deleteEndpoint(aS[aU],true)}}}ap={};I={};aq={};R={};aO={};aL.anchorManager.reset();aL.getDragManager().reset();if(!aR){aL.setSuspendDrawing(false)}return aL};var ay=function(aU,aW,aR){var aT=aL.Defaults.ConnectionType||aL.getDefaultConnectionType(),aS=aU.constructor==aT,aV=aS?{connection:aU,source:aU.source,target:aU.target,sourceId:aU.sourceId,targetId:aU.targetId,sourceEndpoint:aU.endpoints[0],targetEndpoint:aU.endpoints[1]}:aU;if(aW){aL.fire("connectionDetached",aV,aR)}aL.fire("internal.connectionDetached",aV,aR);aL.anchorManager.connectionDetached(aV)};var aw=aL.fireMoveEvent=function(aS,aR){aL.fire("connectionMoved",aS,aR)};this.unregisterEndpoint=function(aW){if(aW._jsPlumb.uuid){aq[aW._jsPlumb.uuid]=null}aL.anchorManager.deleteEndpoint(aW);for(var aV in ap){var aR=ap[aV];if(aR){var aU=[];for(var aT=0,aS=aR.length;aT<aS;aT++){if(aR[aT]!=aW){aU.push(aR[aT])}}ap[aV]=aU}if(ap[aV].length<1){delete ap[aV]}}};this.detach=function(){if(arguments.length===0){return}var aV=aL.Defaults.ConnectionType||aL.getDefaultConnectionType(),aX=arguments[0].constructor==aV,aU=arguments.length==2?aX?(arguments[1]||{}):arguments[0]:arguments[0],a0=(aU.fireEvent!==false),aS=aU.forceDetach,aT=aX?arguments[0]:aU.connection,aW=aX?null:aU.deleteAttachedObjects;if(aT){if(aS||d.functionChain(true,false,[[aT.endpoints[0],"isDetachAllowed",[aT]],[aT.endpoints[1],"isDetachAllowed",[aT]],[aT,"isDetachAllowed",[aT]],[aL,"checkCondition",["beforeDetach",aT]]])){aT.endpoints[0].detach({connection:aT,ignoreTarget:false,forceDetach:true,fireEvent:a0,deleteAttachedObjects:aW})}}else{var aR=g.extend({},aU);if(aR.uuids){W(aR.uuids[0]).detachFrom(W(aR.uuids[1]),a0)}else{if(aR.sourceEndpoint&&aR.targetEndpoint){aR.sourceEndpoint.detachFrom(aR.targetEndpoint)}else{var aZ=w(aL.getElement(aR.source)),aY=w(aL.getElement(aR.target));K(aZ,function(a1){if((a1.sourceId==aZ&&a1.targetId==aY)||(a1.targetId==aZ&&a1.sourceId==aY)){if(aL.checkCondition("beforeDetach",a1)){a1.endpoints[0].detach({connection:a1,ignoreTarget:false,forceDetach:true,fireEvent:a0})}}})}}}};this.detachAllConnections=function(aU,aV){aV=aV||{};aU=aL.getElement(aU);var aW=w(aU),aR=ap[aW];if(aR&&aR.length){for(var aT=0,aS=aR.length;aT<aS;aT++){aR[aT].detachAll(aV.fireEvent!==false,aV.forceDetach)}}return aL};this.detachEveryConnection=function(aR){aR=aR||{};aL.batch(function(){for(var aV in ap){var aS=ap[aV];if(aS&&aS.length){for(var aU=0,aT=aS.length;aU<aT;aU++){aS[aU].detachAll(aR.fireEvent!==false,aR.forceDetach)}}}H.length=0});return aL};this.deleteObject=function(aS){var a1={endpoints:{},connections:{},endpointCount:0,connectionCount:0},a0=aS.fireEvent!==false,aZ=aS.deleteAttachedObjects!==false;var aX=function(a2){if(a2!=null&&a1.connections[a2.id]==null){if(!aS.dontUpdateHover&&a2._jsPlumb!=null){a2.setHover(false)}a1.connections[a2.id]=a2;a1.connectionCount++;if(aZ){for(var a3=0;a3<a2.endpoints.length;a3++){if(a2.endpoints[a3]._deleteOnDetach){aV(a2.endpoints[a3])}}}}};var aV=function(a3){if(a3!=null&&a1.endpoints[a3.id]==null){if(!aS.dontUpdateHover&&a3._jsPlumb!=null){a3.setHover(false)}a1.endpoints[a3.id]=a3;a1.endpointCount++;if(aZ){for(var a2=0;a2<a3.connections.length;a2++){var a4=a3.connections[a2];aX(a4)}}}};if(aS.connection){aX(aS.connection)}else{aV(aS.endpoint)}for(var aU in a1.connections){var aY=a1.connections[aU];if(aY._jsPlumb){d.removeWithFunction(H,function(a2){return aY.id==a2.id});ay(aY,aS.fireEvent===false?false:!aY.pending,aS.originalEvent);var aR=aS.deleteAttachedObjects==null?null:!aS.deleteAttachedObjects;aY.endpoints[0].detachFromConnection(aY,null,aR);aY.endpoints[1].detachFromConnection(aY,null,aR);aY.cleanup(true);aY.destroy(true)}}for(var aT in a1.endpoints){var aW=a1.endpoints[aT];if(aW._jsPlumb){aL.unregisterEndpoint(aW);aW.cleanup(true);aW.destroy(true)}}return a1};this.draggable=function(aS,aR){var aT;q(function(aU){aT=Q(aU);if(aT.el){aC(aT.el,true,aR,aT.id,true)}},aS);return aL};this.droppable=function(aS,aR){var aT;aR=aR||{};aR.allowLoopback=false;q(function(aU){aT=Q(aU);if(aT.el){aL.initDroppable(aT.el,aR)}},aS);return aL};var aN=function(aW,aV,aT,aR){for(var aU=0,aS=aW.length;aU<aS;aU++){aW[aU][aV].apply(aW[aU],aT)}return aR(aW)},J=function(aW,aV,aT){var aS=[];for(var aU=0,aR=aW.length;aU<aR;aU++){aS.push([aW[aU][aV].apply(aW[aU],aT),aW[aU]])}return aS},T=function(aT,aS,aR){return function(){return aN(aT,aS,arguments,aR)}},Y=function(aS,aR){return function(){return J(aS,aR,arguments)}},aP=function(aR,aV){var aU=[];if(aR){if(typeof aR=="string"){if(aR==="*"){return aR}aU.push(aR)}else{if(aV){aU=aR}else{if(aR.length){for(var aT=0,aS=aR.length;aT<aS;aT++){aU.push(Q(aR[aT]).id)}}else{aU.push(Q(aR).id)}}}}return aU},ag=function(aT,aS,aR){if(aT==="*"){return true}return aT.length>0?aT.indexOf(aS)!=-1:!aR};this.getConnections=function(a2,aS){if(!a2){a2={}}else{if(a2.constructor==String){a2={scope:a2}}}var a1=a2.scope||aL.getDefaultScope(),a0=aP(a1,true),aR=aP(a2.source),aW=aP(a2.target),aU=(!aS&&a0.length>1)?{}:[],a3=function(a5,a6){if(!aS&&a0.length>1){var a4=aU[a5];if(a4==null){a4=aU[a5]=[]}a4.push(a6)}else{aU.push(a6)}};for(var aT=0,aV=H.length;aT<aV;aT++){var aX=H[aT],aZ=aX.proxies&&aX.proxies[0]?aX.proxies[0].originalEp.elementId:aX.sourceId,aY=aX.proxies&&aX.proxies[1]?aX.proxies[1].originalEp.elementId:aX.targetId;if(ag(a0,aX.scope)&&ag(aR,aZ)&&ag(aW,aY)){a3(aX.scope,aX)}}return aU};var A=function(aR,aS){return function(aV){for(var aT=0,aU=aR.length;aT<aU;aT++){aV(aR[aT])}return aS(aR)}},D=function(aR){return function(aS){return aR[aS]}};var F=function(aW,aX){var aR={length:aW.length,each:A(aW,aX),get:D(aW)},aV=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],aU=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],aS,aT;for(aS=0,aT=aV.length;aS<aT;aS++){aR[aV[aS]]=T(aW,aV[aS],aX)}for(aS=0,aT=aU.length;aS<aT;aS++){aR[aU[aS]]=Y(aW,aU[aS])}return aR};var ah=function(aS){var aR=F(aS,ah);return g.extend(aR,{setDetachable:T(aS,"setDetachable",ah),setReattach:T(aS,"setReattach",ah),setConnector:T(aS,"setConnector",ah),detach:function(){for(var aT=0,aU=aS.length;aT<aU;aT++){aL.detach(aS[aT])}},isDetachable:Y(aS,"isDetachable"),isReattach:Y(aS,"isReattach")})};var aB=function(aS){var aR=F(aS,aB);return g.extend(aR,{setEnabled:T(aS,"setEnabled",aB),setAnchor:T(aS,"setAnchor",aB),isEnabled:Y(aS,"isEnabled"),detachAll:function(){for(var aT=0,aU=aS.length;aT<aU;aT++){aS[aT].detachAll()}},remove:function(){for(var aT=0,aU=aS.length;aT<aU;aT++){aL.deleteObject({endpoint:aS[aT]})}}})};this.select=function(aR){aR=aR||{};aR.scope=aR.scope||"*";return ah(aR.connections||aL.getConnections(aR,true))};this.selectEndpoints=function(a2){a2=a2||{};a2.scope=a2.scope||"*";var aU=!a2.element&&!a2.source&&!a2.target,aX=aU?"*":aP(a2.element),aR=aU?"*":aP(a2.source),a6=aU?"*":aP(a2.target),aZ=aP(a2.scope,true);var a8=[];for(var aS in ap){var a3=ag(aX,aS,true),a0=ag(aR,aS,true),a5=aR!="*",a7=ag(a6,aS,true),aW=a6!="*";if(a3||a0||a7){inner:for(var a1=0,aV=ap[aS].length;a1<aV;a1++){var aY=ap[aS][a1];if(ag(aZ,aY.scope,true)){var a4=(a5&&aR.length>0&&!aY.isSource),aT=(aW&&a6.length>0&&!aY.isTarget);if(a4||aT){continue inner}a8.push(aY)}}}}return aB(a8)};this.getAllConnections=function(){return H};this.getDefaultScope=function(){return G};this.getEndpoint=W;this.getEndpoints=function(aR){return ap[Q(aR).id]};this.getDefaultEndpointType=function(){return g.Endpoint};this.getDefaultConnectionType=function(){return g.Connection};this.getId=w;this.appendElement=at;var ao=false;this.isHoverSuspended=function(){return ao};this.setHoverSuspended=function(aR){ao=aR};this.hide=function(aR,aS){av(aR,"none",aS);return aL};this.idstamp=S;this.connectorsInitialized=false;this.registerConnectorType=function(aR,aS){p.push([aR,aS])};var v=function(aR){if(!aI&&aR){var aS=aL.getElement(aR);if(aS.offsetParent){aL.setContainer(aS.offsetParent)}}};var aK=function(){if(aL.Defaults.Container){aL.setContainer(aL.Defaults.Container)}};var X=aL.manage=function(aT,aR,aS){if(!I[aT]){I[aT]={el:aR,endpoints:[],connections:[]};I[aT].info=L({elId:aT,timestamp:az});if(!aS){aL.fire("manageElement",{id:aT,info:I[aT].info,el:aR})}}return I[aT]};var aF=function(aR){if(I[aR]){delete I[aR];aL.fire("unmanageElement",aR)}};var L=this.updateOffset=function(aW){var aU=aW.timestamp,aR=aW.recalc,aV=aW.offset,aS=aW.elId,aT;if(ax&&!aU){aU=az}if(!aR){if(aU&&aU===aO[aS]){return{o:aW.offset||R[aS],s:P[aS]}}}if(aR||(!aV&&R[aS]==null)){aT=I[aS]?I[aS].el:null;if(aT!=null){P[aS]=aL.getSize(aT);R[aS]=aL.getOffset(aT);aO[aS]=aU}}else{R[aS]=aV||R[aS];if(P[aS]==null){aT=I[aS].el;if(aT!=null){P[aS]=aL.getSize(aT)}}aO[aS]=aU}if(R[aS]&&!R[aS].right){R[aS].right=R[aS].left+P[aS][0];R[aS].bottom=R[aS].top+P[aS][1];R[aS].width=P[aS][0];R[aS].height=P[aS][1];R[aS].centerx=R[aS].left+(R[aS].width/2);R[aS].centery=R[aS].top+(R[aS].height/2)}return{o:R[aS],s:P[aS]}};this.init=function(){s=o.jsPlumb.getRenderModes();var aT=function(aW,aU,aV){o.jsPlumb.Connectors[aW][aU]=function(){aV.apply(this,arguments);o.jsPlumb.ConnectorRenderers[aW].apply(this,arguments)};d.extend(o.jsPlumb.Connectors[aW][aU],[aV,o.jsPlumb.ConnectorRenderers[aW]])};if(!o.jsPlumb.connectorsInitialized){for(var aS=0;aS<p.length;aS++){for(var aR=0;aR<s.length;aR++){aT(s[aR],p[aS][1],p[aS][0])}}o.jsPlumb.connectorsInitialized=true}if(!z){aK();aL.anchorManager=new o.jsPlumb.AnchorManager({jsPlumbInstance:aL});z=true;aL.fire("ready",aL)}}.bind(this);this.log=C;this.jsPlumbUIComponent=r;this.makeAnchor=function(){var aR,aV=function(aY,aZ){if(o.jsPlumb.Anchors[aY]){return new o.jsPlumb.Anchors[aY](aZ)}if(!aL.Defaults.DoNotThrowErrors){throw {msg:"jsPlumb: unknown anchor type '"+aY+"'"}}};if(arguments.length===0){return null}var aX=arguments[0],aT=arguments[1],aS=arguments[2],aU=null;if(aX.compute&&aX.getOrientation){return aX}else{if(typeof aX=="string"){aU=aV(arguments[0],{elementId:aT,jsPlumbInstance:aL})}else{if(d.isArray(aX)){if(d.isArray(aX[0])||d.isString(aX[0])){if(aX.length==2&&d.isObject(aX[1])){if(d.isString(aX[0])){aR=o.jsPlumb.extend({elementId:aT,jsPlumbInstance:aL},aX[1]);aU=aV(aX[0],aR)}else{aR=o.jsPlumb.extend({elementId:aT,jsPlumbInstance:aL,anchors:aX[0]},aX[1]);aU=new o.jsPlumb.DynamicAnchor(aR)}}else{aU=new g.DynamicAnchor({anchors:aX,selector:null,elementId:aT,jsPlumbInstance:aL})}}else{var aW={x:aX[0],y:aX[1],orientation:(aX.length>=4)?[aX[2],aX[3]]:[0,0],offsets:(aX.length>=6)?[aX[4],aX[5]]:[0,0],elementId:aT,jsPlumbInstance:aL,cssClass:aX.length==7?aX[6]:null};aU=new o.jsPlumb.Anchor(aW);aU.clone=function(){return new o.jsPlumb.Anchor(aW)}}}}}if(!aU.id){aU.id="anchor_"+S()}return aU};this.makeAnchors=function(aU,aS,aR){var aW=[];for(var aT=0,aV=aU.length;aT<aV;aT++){if(typeof aU[aT]=="string"){aW.push(o.jsPlumb.Anchors[aU[aT]]({elementId:aS,jsPlumbInstance:aR}))}else{if(d.isArray(aU[aT])){aW.push(aL.makeAnchor(aU[aT],aS,aR))}}}return aW};this.makeDynamicAnchor=function(aR,aS){return new o.jsPlumb.DynamicAnchor({anchors:aR,selector:aS,elementId:null,jsPlumbInstance:aL})};this.targetEndpointDefinitions={};var M=function(aS,aT,aR){};this.sourceEndpointDefinitions={};var ar=function(aX,aW,aS,aZ,aU){var aY=aX.target||aX.srcElement,aV=false,aR=aZ.getSelector(aW,aS);for(var aT=0;aT<aR.length;aT++){if(aR[aT]==aY){aV=true;break}}return aU?!aV:aV};var au=function(aV,aY,aT,aU,aX){var aS=new r(aY);var aR=aY._jsPlumb.EndpointDropHandler({jsPlumb:aL,enabled:function(){return aV.def.enabled},isFull:function(){var aZ=aL.select({target:aV.id}).length;return aV.def.maxConnections>0&&aZ>=aV.def.maxConnections},element:aV.el,elementId:aV.id,isSource:aU,isTarget:aX,addClass:function(aZ){aL.addClass(aV.el,aZ)},removeClass:function(aZ){aL.removeClass(aV.el,aZ)},onDrop:function(a0){var aZ=a0.endpoints[0];aZ.anchor.locked=false},isDropAllowed:function(){return aS.isDropAllowed.apply(aS,arguments)},isRedrop:function(aZ){return(aZ.suspendedElement!=null&&aZ.suspendedEndpoint!=null&&aZ.suspendedEndpoint.element===aV.el)},getEndpoint:function(a5){var a4=aV.def.endpoint;if(a4==null||a4._jsPlumb==null){var a1=aL.deriveEndpointAndAnchorSpec(a5.getType().join(" "),true);var a0=a1.endpoints?o.jsPlumb.extend(aY,{endpoint:aV.def.def.endpoint||a1.endpoints[1]}):aY;if(a1.anchors){a0=o.jsPlumb.extend(a0,{anchor:aV.def.def.anchor||a1.anchors[1]})}a4=aL.addEndpoint(aV.el,a0);a4._mtNew=true}if(aY.uniqueEndpoint){aV.def.endpoint=a4}a4._doNotDeleteOnDetach=false;a4._deleteOnDetach=true;if(a5.isDetachable()){a4.initDraggable()}if(a4.anchor.positionFinder!=null){var a2=aL.getUIPosition(arguments,aL.getZoom()),a6=aL.getOffset(aV.el),aZ=aL.getSize(aV.el),a3=a2==null?[0,0]:a4.anchor.positionFinder(a2,a6,aZ,a4.anchor.constructorParams);a4.anchor.x=a3[0];a4.anchor.y=a3[1]}return a4},maybeCleanup:function(aZ){if(aZ._mtNew&&aZ.connections.length===0){aL.deleteObject({endpoint:aZ})}else{delete aZ._mtNew}}});var aW=o.jsPlumb.dragEvents.drop;aT.scope=aT.scope||(aY.scope||aL.Defaults.Scope);aT[aW]=d.wrap(aT[aW],aR,true);if(aX){aT[o.jsPlumb.dragEvents.over]=function(){return true}}if(aY.allowLoopback===false){aT.canDrop=function(aZ){var a0=aZ.getDragElement()._jsPlumbRelatedElement;return a0!=aV.el}}aL.initDroppable(aV.el,aT,"internal");return aR};this.makeTarget=function(aU,aV,aZ){var aS=o.jsPlumb.extend({_jsPlumb:this},aZ);o.jsPlumb.extend(aS,aV);M(aS,1,this);var aT=aS.maxConnections||-1,aR=function(a4){var a2=Q(a4),a1=a2.id,a0=o.jsPlumb.extend({},aS.dropOptions||{}),a3=aS.connectionType||"default";this.targetEndpointDefinitions[a1]=this.targetEndpointDefinitions[a1]||{};v(a1);if(a2.el._isJsPlumbGroup&&a0.rank==null){a0.rank=-1}var a5={def:o.jsPlumb.extend({},aS),uniqueEndpoint:aS.uniqueEndpoint,maxConnections:aT,enabled:true};a2.def=a5;this.targetEndpointDefinitions[a1][a3]=a5;au(a2,aS,a0,aS.isSource===true,true);a2.el._katavorioDrop[a2.el._katavorioDrop.length-1].targetDef=a5}.bind(this);var aX=aU.length&&aU.constructor!=String?aU:[aU];for(var aW=0,aY=aX.length;aW<aY;aW++){aR(aX[aW])}return this};this.unmakeTarget=function(aR,aT){var aS=Q(aR);aL.destroyDroppable(aS.el,"internal");if(!aT){delete this.targetEndpointDefinitions[aS.id]}return this};this.makeSource=function(aV,aW,a1){var aT=o.jsPlumb.extend({_jsPlumb:this},a1);o.jsPlumb.extend(aT,aW);var aZ=aT.connectionType||"default";var a2=aL.deriveEndpointAndAnchorSpec(aZ);aT.endpoint=aT.endpoint||a2.endpoints[0];aT.anchor=aT.anchor||a2.anchors[0];M(aT,0,this);var aU=aT.maxConnections||-1,aS=aT.onMaxConnections,aR=function(a5){var a6=a5.id,a3=this.getElement(a5.el);this.sourceEndpointDefinitions[a6]=this.sourceEndpointDefinitions[a6]||{};v(a6);var a8={def:o.jsPlumb.extend({},aT),uniqueEndpoint:aT.uniqueEndpoint,maxConnections:aU,enabled:true};this.sourceEndpointDefinitions[a6][aZ]=a8;a5.def=a8;var a7=o.jsPlumb.dragEvents.stop,bc=o.jsPlumb.dragEvents.drag,bd=o.jsPlumb.extend({},aT.dragOptions||{}),ba=bd.drag,be=bd.stop,bf=null,bb=false;bd.scope=bd.scope||aT.scope;bd[bc]=d.wrap(bd[bc],function(){if(ba){ba.apply(this,arguments)}bb=false});bd[a7]=d.wrap(bd[a7],function(){if(be){be.apply(this,arguments)}this.currentlyDragging=false;if(bf._jsPlumb!=null){var bj=aT.anchor||this.Defaults.Anchor,bh=bf.anchor,bl=bf.connections[0];var bk=this.makeAnchor(bj,a6,this),bm=bf.element;if(bk.positionFinder!=null){var bi=aL.getOffset(bm),bo=this.getSize(bm),bn={left:bi.left+(bh.x*bo[0]),top:bi.top+(bh.y*bo[1])},bg=bk.positionFinder(bn,bi,bo,bk.constructorParams);bk.x=bg[0];bk.y=bg[1]}bf.setAnchor(bk,true);bf.repaint();this.repaint(bf.elementId);if(bl!=null){this.repaint(bl.targetId)}}}.bind(this));var a9=function(bk){if(bk.which===3||bk.button===2){return}var bi=this.sourceEndpointDefinitions[a6][aZ];if(!bi.enabled){return}a6=this.getId(this.getElement(a5.el));if(aT.filter){var bg=d.isString(aT.filter)?ar(bk,a5.el,aT.filter,this,aT.filterExclude):aT.filter(bk,a5.el);if(bg===false){return}}var bj=this.select({source:a6}).length;if(bi.maxConnections>=0&&(bj>=bi.maxConnections)){if(aS){aS({element:a5.el,maxConnections:aU},bk)}return false}var bh=o.jsPlumb.getPositionOnElement(bk,a3,N);var bp={};o.jsPlumb.extend(bp,aT);bp.isTemporarySource=true;bp.anchor=[bh[0],bh[1],0,0];bp.dragOptions=bd;if(bi.def.scope){bp.scope=bi.def.scope}bf=this.addEndpoint(a6,bp);bb=true;bf._doNotDeleteOnDetach=false;bf._deleteOnDetach=true;if(bi.uniqueEndpoint){if(!bi.endpoint){bi.endpoint=bf;bf._deleteOnDetach=false;bf._doNotDeleteOnDetach=true}else{bf.finalEndpoint=bi.endpoint}}var bo=function(){aL.off(bf.canvas,"mouseup",bo);aL.off(a5.el,"mouseup",bo);if(bb){bb=false;aL.deleteEndpoint(bf)}};aL.on(bf.canvas,"mouseup",bo);aL.on(a5.el,"mouseup",bo);var bm={};if(bi.def.extract){for(var bl in bi.def.extract){var bn=(bk.srcElement||bk.target).getAttribute(bl);if(bn){bm[bi.def.extract[bl]]=bn}}}aL.trigger(bf.canvas,"mousedown",bk,bm);d.consume(bk)}.bind(this);this.on(a5.el,"mousedown",a9);a8.trigger=a9;if(aT.filter&&(d.isString(aT.filter)||d.isFunction(aT.filter))){aL.setDragFilter(a5.el,aT.filter)}var a4=o.jsPlumb.extend({},aT.dropOptions||{});au(a5,aT,a4,true,aT.isTarget===true)}.bind(this);var aY=aV.length&&aV.constructor!=String?aV:[aV];for(var aX=0,a0=aY.length;aX<a0;aX++){aR(Q(aY[aX]))}return this};this.unmakeSource=function(aS,aW,aV){var aU=Q(aS);aL.destroyDroppable(aU.el,"internal");var aX=this.sourceEndpointDefinitions[aU.id];if(aX){for(var aT in aX){if(aW==null||aW===aT){var aR=aX[aT].trigger;if(aR){aL.off(aU.el,"mousedown",aR)}if(!aV){delete this.sourceEndpointDefinitions[aU.id][aT]}}}}return this};this.unmakeEverySource=function(){for(var aR in this.sourceEndpointDefinitions){aL.unmakeSource(aR,null,true)}this.sourceEndpointDefinitions={};return this};var ab=function(aT,aS,aU){aS=d.isArray(aS)?aS:[aS];var aW=w(aT);aU=aU||"default";for(var aR=0;aR<aS.length;aR++){var aV=this[aS[aR]][aW];if(aV&&aV[aU]){return aV[aU].def.scope||this.Defaults.Scope}}}.bind(this);var B=function(aU,aT,aS,aV){aS=d.isArray(aS)?aS:[aS];var aX=w(aU);aV=aV||"default";for(var aR=0;aR<aS.length;aR++){var aW=this[aS[aR]][aX];if(aW&&aW[aV]){aW[aV].def.scope=aT}}}.bind(this);this.getScope=function(aS,aR){return ab(aS,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(aR){return ab(aR,"sourceEndpointDefinitions")};this.getTargetScope=function(aR){return ab(aR,"targetEndpointDefinitions")};this.setScope=function(aS,aR,aT){this.setSourceScope(aS,aR,aT);this.setTargetScope(aS,aR,aT)};this.setSourceScope=function(aS,aR,aT){B(aS,aR,"sourceEndpointDefinitions",aT);this.setDragScope(aS,aR)};this.setTargetScope=function(aS,aR,aT){B(aS,aR,"targetEndpointDefinitions",aT);this.setDropScope(aS,aR)};this.unmakeEveryTarget=function(){for(var aR in this.targetEndpointDefinitions){aL.unmakeTarget(aR,true)}this.targetEndpointDefinitions={};return this};var aj=function(a0,aV,aS,aZ,aR){var a1=a0=="source"?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,aT,aW,aX;aR=aR||"default";if(aV.length&&!d.isString(aV)){aT=[];for(var aY=0,a2=aV.length;aY<a2;aY++){aW=Q(aV[aY]);if(a1[aW.id]&&a1[aW.id][aR]){aT[aY]=a1[aW.id][aR].enabled;aX=aZ?!aT[aY]:aS;a1[aW.id][aR].enabled=aX;aL[aX?"removeClass":"addClass"](aW.el,"jtk-"+a0+"-disabled")}}}else{aW=Q(aV);var aU=aW.id;if(a1[aU]&&a1[aU][aR]){aT=a1[aU][aR].enabled;aX=aZ?!aT:aS;a1[aU][aR].enabled=aX;aL[aX?"removeClass":"addClass"](aW.el,"jtk-"+a0+"-disabled")}}return aT}.bind(this);var ac=function(aS,aR){if(d.isString(aS)||!aS.length){return aR.apply(this,[aS])}else{if(aS.length){return aR.apply(this,[aS[0]])}}}.bind(this);this.toggleSourceEnabled=function(aR,aS){aj("source",aR,null,true,aS);return this.isSourceEnabled(aR,aS)};this.setSourceEnabled=function(aR,aS,aT){return aj("source",aR,aS,null,aT)};this.isSource=function(aR,aS){aS=aS||"default";return ac(aR,function(aU){var aT=this.sourceEndpointDefinitions[Q(aU).id];return aT!=null&&aT[aS]!=null}.bind(this))};this.isSourceEnabled=function(aR,aS){aS=aS||"default";return ac(aR,function(aU){var aT=this.sourceEndpointDefinitions[Q(aU).id];return aT&&aT[aS]&&aT[aS].enabled===true}.bind(this))};this.toggleTargetEnabled=function(aR,aS){aj("target",aR,null,true,aS);return this.isTargetEnabled(aR,aS)};this.isTarget=function(aR,aS){aS=aS||"default";return ac(aR,function(aU){var aT=this.targetEndpointDefinitions[Q(aU).id];return aT!=null&&aT[aS]!=null}.bind(this))};this.isTargetEnabled=function(aR,aS){aS=aS||"default";return ac(aR,function(aU){var aT=this.targetEndpointDefinitions[Q(aU).id];return aT&&aT[aS]&&aT[aS].enabled===true}.bind(this))};this.setTargetEnabled=function(aR,aS,aT){return aj("target",aR,aS,null,aT)};this.ready=function(aR){aL.bind("ready",aR)};var am=function(aU,aT){if(typeof aU=="object"&&aU.length){for(var aR=0,aS=aU.length;aR<aS;aR++){aT(aU[aR])}}else{aT(aU)}return aL};this.repaint=function(aR,aT,aS){return am(aR,function(aU){aA(aU,aT,aS)})};this.revalidate=function(aR,aS,aT){return am(aR,function(aV){var aU=aT?aV:aL.getId(aV);aL.updateOffset({elId:aU,recalc:true,timestamp:aS});aL.repaint(aV)})};this.repaintEverything=function(){var aS=i(),aR;for(aR in ap){aL.updateOffset({elId:aR,recalc:true,timestamp:aS})}for(aR in ap){aA(aR,null,aS)}return this};this.removeAllEndpoints=function(aT,aU,aR){aR=aR||[];var aS=function(aZ){var aX=Q(aZ),aY=ap[aX.id],aV,aW;if(aY){aR.push(aX);for(aV=0,aW=aY.length;aV<aW;aV++){aL.deleteEndpoint(aY[aV],false)}}delete ap[aX.id];if(aU){if(aX.el&&aX.el.nodeType!=3&&aX.el.nodeType!=8){for(aV=0,aW=aX.el.childNodes.length;aV<aW;aV++){aS(aX.el.childNodes[aV])}}}};aS(aT);return this};var aD=function(aU,aS){aL.removeAllEndpoints(aU.id,true,aS);var aT=function(aV){aL.getDragManager().elementRemoved(aV.id);aL.anchorManager.clearFor(aV.id);aL.anchorManager.removeFloatingConnection(aV.id);if(aL.isSource(aV.el)){aL.unmakeSource(aV.el)}if(aL.isTarget(aV.el)){aL.unmakeTarget(aV.el)}aL.destroyDraggable(aV.el);aL.destroyDroppable(aV.el);delete aL.floatingConnections[aV.id];delete I[aV.id];delete R[aV.id];if(aV.el){aL.removeElement(aV.el);aV.el._jsPlumb=null}};for(var aR=1;aR<aS.length;aR++){aT(aS[aR])}aT(aU)};this.remove=function(aS,aU){var aT=Q(aS),aR=[];if(aT.text){aT.el.parentNode.removeChild(aT.el)}else{if(aT.id){aL.batch(function(){aD(aT,aR)},aU===false)}}return aL};this.empty=function(aT,aU){var aR=[];var aS=function(aV,aX){var aW=Q(aV);if(aW.text){aW.el.parentNode.removeChild(aW.el)}else{if(aW.el){while(aW.el.childNodes.length>0){aS(aW.el.childNodes[0])}if(!aX){aD(aW,aR)}}}};aL.batch(function(){aS(aT,true)},aU===false);return aL};this.reset=function(){aL.silently(function(){ao=false;aL.removeAllGroups();aL.removeGroupManager();aL.deleteEveryEndpoint();aL.unbind();this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};H.length=0;if(this.doReset){this.doReset()}}.bind(this))};var x=function(aR){if(aR.canvas&&aR.canvas.parentNode){aR.canvas.parentNode.removeChild(aR.canvas)}aR.cleanup();aR.destroy()};this.clear=function(){aL.select().each(x);aL.selectEndpoints().each(x);ap={};aq={}};this.setDefaultScope=function(aR){G=aR;return aL};this.setDraggable=aG;this.deriveEndpointAndAnchorSpec=function(aU,aR){var aX=((aR?"":"default ")+aU).split(/[\s]/),aY=null,aZ=null,aV=null,aS=null;for(var aT=0;aT<aX.length;aT++){var aW=aL.getType(aX[aT],"connection");if(aW){if(aW.endpoints){aY=aW.endpoints}if(aW.endpoint){aZ=aW.endpoint}if(aW.anchors){aS=aW.anchors}if(aW.anchor){aV=aW.anchor}}}return{endpoints:aY?aY:[aZ,aZ],anchors:aS?aS:[aV,aV]}};this.setId=function(aT,aU,aY){var aR;if(d.isString(aT)){aR=aT}else{aT=this.getElement(aT);aR=this.getId(aT)}var aS=this.getConnections({source:aR,scope:"*"},true),aW=this.getConnections({target:aR,scope:"*"},true);aU=""+aU;if(!aY){aT=this.getElement(aR);this.setAttribute(aT,"id",aU)}else{aT=this.getElement(aU)}ap[aU]=ap[aR]||[];for(var aX=0,aZ=ap[aU].length;aX<aZ;aX++){ap[aU][aX].setElementId(aU);ap[aU][aX].setReferenceElement(aT)}delete ap[aR];this.sourceEndpointDefinitions[aU]=this.sourceEndpointDefinitions[aR];delete this.sourceEndpointDefinitions[aR];this.targetEndpointDefinitions[aU]=this.targetEndpointDefinitions[aR];delete this.targetEndpointDefinitions[aR];this.anchorManager.changeId(aR,aU);this.getDragManager().changeId(aR,aU);I[aU]=I[aR];delete I[aR];var aV=function(a4,a0,a3){for(var a1=0,a2=a4.length;a1<a2;a1++){a4[a1].endpoints[a0].setElementId(aU);a4[a1].endpoints[a0].setReferenceElement(aT);a4[a1][a3+"Id"]=aU;a4[a1][a3]=aT}};aV(aS,0,"source");aV(aW,1,"target");this.repaint(aU)};this.setDebugLog=function(aR){C=aR};this.setSuspendDrawing=function(aT,aR){var aS=ax;ax=aT;if(aT){az=new Date().getTime()}else{az=null}if(aR){this.repaintEverything()}return aS};this.isSuspendDrawing=function(){return ax};this.getSuspendedAt=function(){return az};this.batch=function(aS,aR){var aU=this.isSuspendDrawing();if(!aU){this.setSuspendDrawing(true)}try{aS()}catch(aT){d.log("Function run while suspended failed",aT)}if(!aU){this.setSuspendDrawing(false,!aR)}};this.doWhileSuspended=this.batch;this.getCachedData=ak;this.timestamp=i;this.show=function(aR,aS){av(aR,"block",aS);return aL};this.toggleVisible=an;this.toggleDraggable=aE;this.addListener=this.bind};d.extend(o.jsPlumbInstance,d.EventGenerator,{setAttribute:function(y,w,x){this.setAttribute(y,w,x)},getAttribute:function(w,v){return this.getAttribute(o.jsPlumb.getElement(w),v)},convertToFullOverlaySpec:function(v){if(d.isString(v)){v=[v,{}]}v[1].id=v[1].id||d.uuid();return v},registerConnectionType:function(z,x){this._connectionTypes[z]=o.jsPlumb.extend({},x);if(x.overlays){var y={};for(var w=0;w<x.overlays.length;w++){var v=this.convertToFullOverlaySpec(x.overlays[w]);y[v[1].id]=v}this._connectionTypes[z].overlays=y}},registerConnectionTypes:function(w){for(var v in w){this.registerConnectionType(v,w[v])}},registerEndpointType:function(z,x){this._endpointTypes[z]=o.jsPlumb.extend({},x);if(x.overlays){var y={};for(var w=0;w<x.overlays.length;w++){var v=this.convertToFullOverlaySpec(x.overlays[w]);y[v[1].id]=v}this._endpointTypes[z].overlays=y}},registerEndpointTypes:function(w){for(var v in w){this.registerEndpointType(v,w[v])}},getType:function(w,v){return v==="connection"?this._connectionTypes[w]:this._endpointTypes[w]},setIdChanged:function(w,v){this.setId(w,v,true)},setParent:function(y,z){var A=this.getElement(y),x=this.getId(A),v=this.getElement(z),w=this.getId(v);A.parentNode.removeChild(A);v.appendChild(A);this.getDragManager().setParent(A,x,v,w)},extend:function(x,w,y){var v;if(y){for(v=0;v<y.length;v++){x[y[v]]=w[y[v]]}}else{for(v in w){x[v]=w[v]}}return x},floatingConnections:{},getFloatingAnchorIndex:function(v){return v.endpoints[0].isFloating()?0:v.endpoints[1].isFloating()?1:-1}});n.prototype.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:true,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:false,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:false,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:false,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};var g=new n();o.jsPlumb=g;g.getInstance=function(y,v){var w=new n(y);if(v){for(var x in v){w[x]=v[x]}}w.init();return w};g.each=function(v,x){if(v==null){return}if(typeof v==="string"){x(g.getElement(v))}else{if(v.length!=null){for(var w=0;w<v.length;w++){x(g.getElement(v[w]))}}else{x(v)}}};if(typeof define==="function"){define("jsplumb",[],function(){return g})}if(typeof exports!=="undefined"){exports.jsPlumb=g}}).call(typeof window!=="undefined"?window:this);(function(){var l=this,k=l.jsPlumbUtil;var b=function(q,r){if(r==null){return[0,0]}var p=f(r),o=a(p,0);return[o[q+"X"],o[q+"Y"]]},h=b.bind(this,"page"),m=b.bind(this,"screen"),i=b.bind(this,"client"),a=function(p,o){return p.item?p.item(o):p[o]},f=function(o){return o.touches&&o.touches.length>0?o.touches:o.changedTouches&&o.changedTouches.length>0?o.changedTouches:o.targetTouches&&o.targetTouches.length>0?o.targetTouches:[o]};var e=function(t){var s={},r=[],p={},o={},q={};this.register=function(v){var x=t.getId(v),u=t.getOffset(v);if(!s[x]){s[x]=v;r.push(v);p[x]={}}var w=function(B){if(B){for(var y=0;y<B.childNodes.length;y++){if(B.childNodes[y].nodeType!=3&&B.childNodes[y].nodeType!=8){var A=jsPlumb.getElement(B.childNodes[y]),C=t.getId(B.childNodes[y],null,true);if(C&&o[C]&&o[C]>0){var z=t.getOffset(A);p[x][C]={id:C,offset:{left:z.left-u.left,top:z.top-u.top}};q[C]=x}w(B.childNodes[y])}}}};w(v)};this.updateOffsets=function(y,B){if(y!=null){B=B||{};var x=jsPlumb.getElement(y),v=t.getId(x),w=p[v],u=t.getOffset(x);if(w){for(var A in w){if(w.hasOwnProperty(A)){var C=jsPlumb.getElement(A),z=B[A]||t.getOffset(C);if(C.offsetParent==null&&p[v][A]!=null){continue}p[v][A]={id:A,offset:{left:z.left-u.left,top:z.top-u.top}};q[A]=v}}}}};this.endpointAdded=function(x,A){A=A||t.getId(x);var u=document.body,y=x.parentNode;o[A]=o[A]?o[A]+1:1;while(y!=null&&y!=u){var v=t.getId(y,null,true);if(v&&s[v]){var z=t.getOffset(y);if(p[v][A]==null){var w=t.getOffset(x);p[v][A]={id:A,offset:{left:w.left-z.left,top:w.top-z.top}};q[A]=v}break}y=y.parentNode}};this.endpointDeleted=function(v){if(o[v.elementId]){o[v.elementId]--;if(o[v.elementId]<=0){for(var u in p){if(p.hasOwnProperty(u)&&p[u]){delete p[u][v.elementId];delete q[v.elementId]}}}}};this.changeId=function(v,u){p[u]=p[v];p[v]={};q[u]=q[v];q[v]=null};this.getElementsForDraggable=function(u){return p[u]};this.elementRemoved=function(u){var v=q[u];if(v){delete p[v][u];delete q[u]}};this.reset=function(){s={};r=[];p={};o={}};this.dragEnded=function(v){if(v.offsetParent!=null){var w=t.getId(v),u=q[w];if(u){this.updateOffsets(u)}}};this.setParent=function(y,v,A,w,u){var z=q[v];if(!p[w]){p[w]={}}var B=t.getOffset(A),x=u||t.getOffset(y);if(z){delete p[z][v]}p[w][v]={id:v,offset:{left:x.left-B.left,top:x.top-B.top}};q[v]=w};this.clearParent=function(v,u){var w=q[u];if(w){delete p[w][u];delete q[u]}};this.revalidateParent=function(v,u,y){var w=q[u];if(w){var x={};x[u]=y;this.updateOffsets(w,x);t.revalidate(w)}};this.getDragAncestor=function(u){var x=jsPlumb.getElement(u),w=t.getId(x),v=q[w];if(v){return jsPlumb.getElement(v)}else{return null}}};var c=function(o){return o==null?null:(o.replace(/^\s\s*/,"").replace(/\s\s*$/,""))},n=function(o,p){p=c(p);if(typeof o.className.baseVal!="undefined"){o.className.baseVal=p}else{o.className=p}},g=function(o){return(typeof o.className.baseVal=="undefined")?o.className:o.className.baseVal},d=function(t,s,o){s=s==null?[]:k.isArray(s)?s:s.split(/\s+/);o=o==null?[]:k.isArray(o)?o:o.split(/\s+/);var r=g(t),p=r.split(/\s+/);var q=function(x,w){for(var v=0;v<w.length;v++){if(x){if(p.indexOf(w[v])==-1){p.push(w[v])}}else{var u=p.indexOf(w[v]);if(u!=-1){p.splice(u,1)}}}};q(true,s);q(false,o);n(t,p.join(" "))};l.jsPlumb.extend(l.jsPlumbInstance.prototype,{headless:false,pageLocation:h,screenLocation:m,clientLocation:i,getDragManager:function(){if(this.dragManager==null){this.dragManager=new e(this)}return this.dragManager},recalculateOffsets:function(o){this.getDragManager().updateOffsets(o)},createElement:function(o,q,p,r){return this.createElementNS(null,o,q,p,r)},createElementNS:function(s,o,r,p,u){var t=s==null?document.createElement(o):document.createElementNS(s,o);var q;r=r||{};for(q in r){t.style[q]=r[q]}if(p){t.className=p}u=u||{};for(q in u){t.setAttribute(q,""+u[q])}return t},getAttribute:function(o,p){return o.getAttribute!=null?o.getAttribute(p):null},setAttribute:function(q,o,p){if(q.setAttribute!=null){q.setAttribute(o,p)}},setAttributes:function(p,q){for(var o in q){if(q.hasOwnProperty(o)){p.setAttribute(o,q[o])}}},appendToRoot:function(o){document.body.appendChild(o)},getRenderModes:function(){return["svg"]},getClass:g,addClass:function(p,o){jsPlumb.each(p,function(q){d(q,o)})},hasClass:function(p,o){p=jsPlumb.getElement(p);if(p.classList){return p.classList.contains(o)}else{return g(p).indexOf(o)!=-1}},removeClass:function(p,o){jsPlumb.each(p,function(q){d(q,null,o)})},updateClasses:function(q,o,p){jsPlumb.each(q,function(r){d(r,o,p)})},setClass:function(p,o){jsPlumb.each(p,function(q){n(q,o)})},setPosition:function(o,q){o.style.left=q.left+"px";o.style.top=q.top+"px"},getPosition:function(p){var o=function(r){var q=p.style[r];return q?q.substring(0,q.length-2):0};return{left:o("left"),top:o("top")}},getStyle:function(o,p){if(typeof window.getComputedStyle!=="undefined"){return getComputedStyle(o,null).getPropertyValue(p)}else{return o.currentStyle[p]}},getSelector:function(o,p){var q=null;if(arguments.length==1){q=o.nodeType!=null?o:document.querySelectorAll(o)}else{q=o.querySelectorAll(p)}return q},getOffset:function(t,u,r){t=jsPlumb.getElement(t);r=r||this.getContainer();var s={left:t.offsetLeft,top:t.offsetTop},w=(u||(r!=null&&(t!=r&&t.offsetParent!=r)))?t.offsetParent:null,o=function(p){if(p!=null&&p!==document.body&&(p.scrollTop>0||p.scrollLeft>0)){s.left-=p.scrollLeft;s.top-=p.scrollTop}}.bind(this);while(w!=null){s.left+=w.offsetLeft;s.top+=w.offsetTop;o(w);w=u?w.offsetParent:w.offsetParent==r?null:w.offsetParent}if(r!=null&&!u&&(r.scrollTop>0||r.scrollLeft>0)){var q=t.offsetParent!=null?this.getStyle(t.offsetParent,"position"):"static",v=this.getStyle(t,"position");if(v!=="absolute"&&v!=="fixed"&&q!=="absolute"&&q!="fixed"){s.left-=r.scrollLeft;s.top-=r.scrollTop}}return s},getPositionOnElement:function(B,p,o){var v=typeof p.getBoundingClientRect!=="undefined"?p.getBoundingClientRect():{left:0,top:0,width:0,height:0},A=document.body,I=document.documentElement,q=window.pageYOffset||I.scrollTop||A.scrollTop,F=window.pageXOffset||I.scrollLeft||A.scrollLeft,D=I.clientTop||A.clientTop||0,J=I.clientLeft||A.clientLeft||0,E=0,H=0,C=v.top+q-D+(E*o),r=v.left+F-J+(H*o),s=jsPlumb.pageLocation(B),z=v.width||(p.offsetWidth*o),G=v.height||(p.offsetHeight*o),u=(s[0]-r)/z,t=(s[1]-C)/G;return[u,t]},getAbsolutePosition:function(p){var o=function(r){var q=p.style[r];if(q){return parseFloat(q.substring(0,q.length-2))}};return[o("left"),o("top")]},setAbsolutePosition:function(o,q,p,r){if(p){this.animate(o,{left:"+="+(q[0]-p[0]),top:"+="+(q[1]-p[1])},r)}else{o.style.left=q[0]+"px";o.style.top=q[1]+"px"}},getSize:function(o){return[o.offsetWidth,o.offsetHeight]},getWidth:function(o){return o.offsetWidth},getHeight:function(o){return o.offsetHeight},getRenderMode:function(){return"svg"}})}).call(typeof window!=="undefined"?window:this);(function(){var c=this,d=c.jsPlumb,b=c.jsPlumbUtil;var f="__label",a=function(h,k){var g={cssClass:k.cssClass,labelStyle:h.labelStyle,id:f,component:h,_jsPlumb:h._jsPlumb.instance},i=d.extend(g,k);return new d.Overlays[h._jsPlumb.instance.getRenderMode()].Label(i)},e=function(g,l){var i=null;if(b.isArray(l)){var h=l[0],k=d.extend({component:g,_jsPlumb:g._jsPlumb.instance},l[1]);if(l.length==3){d.extend(k,l[2])}i=new d.Overlays[g._jsPlumb.instance.getRenderMode()][h](k)}else{if(l.constructor==String){i=new d.Overlays[g._jsPlumb.instance.getRenderMode()][l]({component:g,_jsPlumb:g._jsPlumb.instance})}else{i=l}}i.id=i.id||b.uuid();g.cacheTypeItem("overlay",i,i.id);g._jsPlumb.overlays[i.id]=i;return i};d.OverlayCapableJsPlumbUIComponent=function(g){c.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.overlays={};this._jsPlumb.overlayPositions={};if(g.label){this.getDefaultType().overlays[f]=["Label",{label:g.label,location:g.labelLocation||this.defaultLabelLocation||0.5,labelStyle:g.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:f}]}this.setListenerComponent=function(k){if(this._jsPlumb){for(var h in this._jsPlumb.overlays){this._jsPlumb.overlays[h].setListenerComponent(k)}}}};d.OverlayCapableJsPlumbUIComponent.applyType=function(h,l){if(l.overlays){var g={},k;for(k in l.overlays){var m=h._jsPlumb.overlays[l.overlays[k][1].id];if(m){m.updateFrom(l.overlays[k][1]);g[l.overlays[k][1].id]=true}else{var n=h.getCachedTypeItem("overlay",l.overlays[k][1].id);if(n!=null){n.reattach(h._jsPlumb.instance);n.setVisible(true);n.updateFrom(l.overlays[k][1]);h._jsPlumb.overlays[n.id]=n}else{n=h.addOverlay(l.overlays[k],true)}g[n.id]=true}}for(k in h._jsPlumb.overlays){if(g[h._jsPlumb.overlays[k].id]==null){h.removeOverlay(h._jsPlumb.overlays[k].id,true)}}}};b.extend(d.OverlayCapableJsPlumbUIComponent,c.jsPlumbUIComponent,{setHover:function(h,k){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){for(var g in this._jsPlumb.overlays){this._jsPlumb.overlays[g][h?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)}}},addOverlay:function(g,h){var i=e(this,g);if(!h){this.repaint()}return i},getOverlay:function(g){return this._jsPlumb.overlays[g]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(h){var g=this.getOverlay(h);if(g){g.hide()}},hideOverlays:function(){for(var g in this._jsPlumb.overlays){this._jsPlumb.overlays[g].hide()}},showOverlay:function(h){var g=this.getOverlay(h);if(g){g.show()}},showOverlays:function(){for(var g in this._jsPlumb.overlays){this._jsPlumb.overlays[g].show()}},removeAllOverlays:function(h){for(var g in this._jsPlumb.overlays){if(this._jsPlumb.overlays[g].cleanup){this._jsPlumb.overlays[g].cleanup()}}this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null;if(!h){this.repaint()}},removeOverlay:function(g,i){var h=this._jsPlumb.overlays[g];if(h){h.setVisible(false);if(!i&&h.cleanup){h.cleanup()}delete this._jsPlumb.overlays[g];if(this._jsPlumb.overlayPositions){delete this._jsPlumb.overlayPositions[g]}}},removeOverlays:function(){for(var h=0,g=arguments.length;h<g;h++){this.removeOverlay(arguments[h])}},moveParent:function(k){if(this.bgCanvas){this.bgCanvas.parentNode.removeChild(this.bgCanvas);k.appendChild(this.bgCanvas)}if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas);k.appendChild(this.canvas);for(var g in this._jsPlumb.overlays){if(this._jsPlumb.overlays[g].isAppendedAtTopLevel){var h=this._jsPlumb.overlays[g].getElement();h.parentNode.removeChild(h);k.appendChild(h)}}}},getLabel:function(){var g=this.getOverlay(f);return g!=null?g.getLabel():null},getLabelOverlay:function(){return this.getOverlay(f)},setLabel:function(g){var h=this.getOverlay(f);if(!h){var i=g.constructor==String||g.constructor==Function?{label:g}:g;h=a(this,i);this._jsPlumb.overlays[f]=h}else{if(g.constructor==String||g.constructor==Function){h.setLabel(g)}else{if(g.label){h.setLabel(g.label)}if(g.location){h.setLocation(g.location)}}}if(!this._jsPlumb.instance.isSuspendDrawing()){this.repaint()}},cleanup:function(h){for(var g in this._jsPlumb.overlays){this._jsPlumb.overlays[g].cleanup(h);this._jsPlumb.overlays[g].destroy(h)}if(h){this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null}},setVisible:function(g){this[g?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(g,h){this._jsPlumb.overlayPositions[g.id]=h},getAbsoluteOverlayPosition:function(g){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[g.id]:null},_clazzManip:function(k,g,l){if(!l){for(var h in this._jsPlumb.overlays){this._jsPlumb.overlays[h][k+"Class"](g)}}},addClass:function(g,h){this._clazzManip("add",g,h)},removeClass:function(g,h){this._clazzManip("remove",g,h)}})}).call(typeof window!=="undefined"?window:this);(function(){var b=this,e=b.jsPlumb,a=b.jsPlumbUtil;var g=function(m,l,i){var k=false;return{drag:function(){if(k){k=false;return true}if(l.element){var n=i.getUIPosition(arguments,i.getZoom());if(n!=null){jsPlumb.setPosition(l.element,n)}i.repaint(l.element,n);m.paint({anchorPoint:m.anchor.getCurrentLocation({element:m})})}},stopDrag:function(){k=true}}};var d=function(m,i,k,l){var p=jsPlumb.createElement("div",{position:"absolute"});i.appendElement(p);var o=i.getId(p);jsPlumb.setPosition(p,k);p.style.width=l[0]+"px";p.style.height=l[1]+"px";i.manage(o,p,true);m.id=o;m.element=p};var h=function(l,r,o,m,i,n,k,p){var q=new e.FloatingAnchor({reference:r,referenceCanvas:m,jsPlumbInstance:n});return k({paintStyle:l,endpoint:o,anchor:q,source:i,scope:p})};var f=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"];var c=function(m,l){var k=0;if(l!=null){for(var n=0;n<m.connections.length;n++){if(m.connections[n].sourceId==l||m.connections[n].targetId==l){k=n;break}}}return m.connections[k]};e.Endpoint=function(k){var s=k._jsPlumb,l=k.newConnection,i=k.newEndpoint;this.idPrefix="_jsplumb_e_";this.defaultLabelLocation=[0.5,0.5];this.defaultOverlayKeys=["Overlays","EndpointOverlays"];e.OverlayCapableJsPlumbUIComponent.apply(this,arguments);this.appendToDefaultType({connectionType:k.connectionType,maxConnections:k.maxConnections==null?this._jsPlumb.instance.Defaults.MaxConnections:k.maxConnections,paintStyle:k.endpointStyle||k.paintStyle||k.style||this._jsPlumb.instance.Defaults.EndpointStyle||e.Defaults.EndpointStyle,hoverPaintStyle:k.endpointHoverStyle||k.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle,connectorStyle:k.connectorStyle,connectorHoverStyle:k.connectorHoverStyle,connectorClass:k.connectorClass,connectorHoverClass:k.connectorHoverClass,connectorOverlays:k.connectorOverlays,connector:k.connector,connectorTooltip:k.connectorTooltip});this._jsPlumb.enabled=!(k.enabled===false);this._jsPlumb.visible=true;this.element=e.getElement(k.source);this._jsPlumb.uuid=k.uuid;this._jsPlumb.floatingEndpoint=null;var m=null;if(this._jsPlumb.uuid){k.endpointsByUUID[this._jsPlumb.uuid]=this}this.elementId=k.elementId;this.dragProxy=k.dragProxy;this._jsPlumb.connectionCost=k.connectionCost;this._jsPlumb.connectionsDirected=k.connectionsDirected;this._jsPlumb.currentAnchorClass="";this._jsPlumb.events={};var t=function(){var w=s.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var v=s.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(w);this.addClass(v);e.updateClasses(this.element,v,w)}.bind(this);this.prepareAnchor=function(w){var v=this._jsPlumb.instance.makeAnchor(w,this.elementId,s);v.bind("anchorChanged",function(x){this.fire("anchorChanged",{endpoint:this,anchor:x});t()}.bind(this));return v};this.setPreparedAnchor=function(v,w){this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);this.anchor=v;t();if(!w){this._jsPlumb.instance.repaint(this.elementId)}return this};this.setAnchor=function(w,x){var v=this.prepareAnchor(w);this.setPreparedAnchor(v,x);return this};var n=function(w){if(this.connections.length>0){for(var v=0;v<this.connections.length;v++){this.connections[v].setHover(w,false)}}else{this.setHover(w)}}.bind(this);this.bind("mouseover",function(){n(true)});this.bind("mouseout",function(){n(false)});if(!k._transient){this._jsPlumb.instance.anchorManager.add(this,this.elementId)}this.prepareEndpoint=function(w,y){var v=function(A,C){var B=s.getRenderMode();if(e.Endpoints[B][A]){return new e.Endpoints[B][A](C)}if(!s.Defaults.DoNotThrowErrors){throw {msg:"jsPlumb: unknown endpoint type '"+A+"'"}}};var x={_jsPlumb:this._jsPlumb.instance,cssClass:k.cssClass,container:k.container,tooltip:k.tooltip,connectorTooltip:k.connectorTooltip,endpoint:this};var z;if(a.isString(w)){z=v(w,x)}else{if(a.isArray(w)){x=a.merge(w[1],x);z=v(w[0],x)}else{z=w.clone()}}z.clone=function(){if(a.isString(w)){return v(w,x)}else{if(a.isArray(w)){x=a.merge(w[1],x);return v(w[0],x)}}}.bind(this);z.typeId=y;return z};this.setEndpoint=function(v,x){var w=this.prepareEndpoint(v);this.setPreparedEndpoint(w,true)};this.setPreparedEndpoint=function(v,w){if(this.endpoint!=null){this.endpoint.cleanup();this.endpoint.destroy()}this.endpoint=v;this.type=this.endpoint.type;this.canvas=this.endpoint.canvas};e.extend(this,k,f);this.isSource=k.isSource||false;this.isTemporarySource=k.isTemporarySource||false;this.isTarget=k.isTarget||false;this.connections=k.connections||[];this.connectorPointerEvents=k["connector-pointer-events"];this.scope=k.scope||s.getDefaultScope();this.timestamp=null;this.reattachConnections=k.reattach||s.Defaults.ReattachConnections;this.connectionsDetachable=s.Defaults.ConnectionsDetachable;if(k.connectionsDetachable===false||k.detachable===false){this.connectionsDetachable=false}this.dragAllowedWhenFull=k.dragAllowedWhenFull!==false;if(k.onMaxConnections){this.bind("maxConnections",k.onMaxConnections)}this.addConnection=function(v){this.connections.push(v);this[(this.connections.length>0?"add":"remove")+"Class"](s.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](s.endpointFullClass)};this.detachFromConnection=function(x,v,w){v=v==null?this.connections.indexOf(x):v;if(v>=0){this.connections.splice(v,1);this[(this.connections.length>0?"add":"remove")+"Class"](s.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](s.endpointFullClass)}if((this._forceDeleteOnDetach||(!w&&this._deleteOnDetach))&&this.connections.length===0){s.deleteObject({endpoint:this,fireEvent:false,deleteAttachedObjects:w!==true})}};this.detach=function(z){var A=z.connectionIndex,x=z.connection,B=z.ignoreTarget,E=z.fireEvent,v=z.originalEvent,w=z.endpointBeingDeleted,y=z.forceDetach;var D=A==null?this.connections.indexOf(x):A,C=false;E=(E!==false);if(D>=0){if(y||x._forceDetach||(x.isDetachable()&&x.isDetachAllowed(x)&&this.isDetachAllowed(x)&&s.checkCondition("beforeDetach",x,w))){s.deleteObject({connection:x,fireEvent:(!B&&E),originalEvent:v,deleteAttachedObjects:z.deleteAttachedObjects});C=true}}return C};this.detachAll=function(x,v){var y=[];while(this.connections.length>0){var w=this.detach({connection:this.connections[0],ignoreTarget:false,forceDetach:v===true,fireEvent:x!==false,originalEvent:null,endpointBeingDeleted:this,connectionIndex:0});if(!w){y.push(this.connections[0]);this.connections.splice(0,1)}}this.connections=y;return this};this.detachFrom=function(z,y,v){var A=[];for(var x=0;x<this.connections.length;x++){if(this.connections[x].endpoints[1]==z||this.connections[x].endpoints[0]==z){A.push(this.connections[x])}}for(var w=0;w<A.length;w++){this.detach({connection:A[w],ignoreTarget:false,forceDetach:true,fireEvent:y,originalEvent:v})}return this};this.getElement=function(){return this.element};this.setElement=function(v){var x=this._jsPlumb.instance.getId(v),w=this.elementId;a.removeWithFunction(k.endpointsByElement[this.elementId],function(y){return y.id==this.id}.bind(this));this.element=e.getElement(v);this.elementId=s.getId(this.element);s.anchorManager.rehomeEndpoint(this,w,this.element);s.dragManager.endpointAdded(this.element);a.addToList(k.endpointsByElement,x,this);return this};this.makeInPlaceCopy=function(){var y=this.anchor.getCurrentLocation({element:this}),x=this.anchor.getOrientation(this),w=this.anchor.getCssClass(),v={bind:function(){},compute:function(){return[y[0],y[1]]},getCurrentLocation:function(){return[y[0],y[1]]},getOrientation:function(){return x},getCssClass:function(){return w}};return i({dropOptions:k.dropOptions,anchor:v,source:this.element,paintStyle:this.getPaintStyle(),endpoint:k.hideOnDrag?"Blank":this.endpoint,_transient:true,scope:this.scope,reference:this})};this.connectorSelector=function(){var v=this.connections[0];if(v){return v}else{return(this.connections.length<this._jsPlumb.maxConnections)||this._jsPlumb.maxConnections==-1?null:v}};this.setStyle=this.setPaintStyle;this.paint=function(z){z=z||{};var F=z.timestamp,E=!(z.recalc===false);if(!F||this.timestamp!==F){var y=s.updateOffset({elId:this.elementId,timestamp:F});var L=z.offset?z.offset.o:y.o;if(L!=null){var C=z.anchorPoint,A=z.connectorPaintStyle;if(C==null){var v=z.dimensions||y.s,x={xy:[L.left,L.top],wh:v,element:this,timestamp:F};if(E&&this.anchor.isDynamic&&this.connections.length>0){var H=c(this,z.elementWithPrecedence),K=H.endpoints[0]==this?1:0,B=K===0?H.sourceId:H.targetId,J=s.getCachedData(B),G=J.o,I=J.s;x.txy=[G.left,G.top];x.twh=I;x.tElement=H.endpoints[K]}C=this.anchor.compute(x)}this.endpoint.compute(C,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,A||this.paintStyleInUse);this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor);this.timestamp=F;for(var D in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(D)){var w=this._jsPlumb.overlays[D];if(w.isVisible()){this._jsPlumb.overlayPlacements[D]=w.draw(this.endpoint,this._jsPlumb.paintStyleInUse);w.paint(this._jsPlumb.overlayPlacements[D])}}}}}};this.getTypeDescriptor=function(){return"endpoint"};this.isVisible=function(){return this._jsPlumb.visible};this.repaint=this.paint;var r=false;this.initDraggable=function(){if(!r&&e.isDragSupported(this.element)){var x={id:null,element:null},E=null,v=false,G=null,B=g(this,x,s),H=k.dragOptions||{},I={},z=e.dragEvents.start,y=e.dragEvents.stop,D=e.dragEvents.drag,J=e.dragEvents.beforeStart,F;var C=function(K){F=K.e.payload||{}};var w=function(P){E=this.connectorSelector();var O=true;if(!this.isEnabled()){O=false}if(E==null&&!this.isSource&&!this.isTemporarySource){O=false}if(this.isSource&&this.isFull()&&!(E!=null&&this.dragAllowedWhenFull)){O=false}if(E!=null&&!E.isDetachable(this)){O=false}var W=s.checkCondition(E==null?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:E});if(W===false){O=false}else{if(typeof W==="object"){e.extend(W,F||{})}else{W=F||{}}}if(O===false){if(s.stopDrag){s.stopDrag(this.canvas)}B.stopDrag();return false}for(var M=0;M<this.connections.length;M++){this.connections[M].setHover(false)}this.addClass("endpointDrag");s.setConnectionBeingDragged(true);if(E&&!this.isFull()&&this.isSource){E=null}s.updateOffset({elId:this.elementId});var R=this._jsPlumb.instance.getOffset(this.canvas),T=this.canvas,U=this._jsPlumb.instance.getSize(this.canvas);d(x,s,R,U);s.setAttributes(this.canvas,{dragId:x.id,elId:this.elementId});var L=this.dragProxy||this.endpoint;if(this.dragProxy==null&&this.connectionType!=null){var V=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);if(V.endpoints[1]){L=V.endpoints[1]}}var S=this._jsPlumb.instance.makeAnchor("Center");S.isFloating=true;this._jsPlumb.floatingEndpoint=h(this.getPaintStyle(),S,L,this.canvas,x.element,s,i,this.scope);var N=this._jsPlumb.floatingEndpoint.anchor;if(E==null){this.setHover(false,false);E=l({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:x.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:k.connectorStyle,hoverPaintStyle:k.connectorHoverStyle,connector:k.connector,overlays:k.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:k.scope,data:W});E.pending=true;E.addClass(s.draggingClass);this._jsPlumb.floatingEndpoint.addClass(s.draggingClass);this._jsPlumb.floatingEndpoint.anchor=N;s.fire("connectionDrag",E);s.anchorManager.newConnection(E)}else{v=true;E.setHover(false);var K=E.endpoints[0].id==this.id?0:1;this.detachFromConnection(E,null,true);var Q=s.getDragScope(T);s.setAttribute(this.canvas,"originalScope",Q);s.fire("connectionDrag",E);if(K===0){G=[E.source,E.sourceId,T,Q];s.anchorManager.sourceChanged(E.endpoints[K].elementId,x.id,E,x.element)}else{G=[E.target,E.targetId,T,Q];E.target=x.element;E.targetId=x.id;s.anchorManager.updateOtherEndpoint(E.sourceId,E.endpoints[K].elementId,E.targetId,E)}E.suspendedEndpoint=E.endpoints[K];E.suspendedElement=E.endpoints[K].getElement();E.suspendedElementId=E.endpoints[K].elementId;E.suspendedElementType=K===0?"source":"target";E.suspendedEndpoint.setHover(false);this._jsPlumb.floatingEndpoint.referenceEndpoint=E.suspendedEndpoint;E.endpoints[K]=this._jsPlumb.floatingEndpoint;E.addClass(s.draggingClass);this._jsPlumb.floatingEndpoint.addClass(s.draggingClass)}s.floatingConnections[x.id]=E;a.addToList(k.endpointsByElement,x.id,this._jsPlumb.floatingEndpoint);s.currentlyDragging=true}.bind(this);var A=function(){s.setConnectionBeingDragged(false);if(E&&E.endpoints!=null){var L=s.getDropEvent(arguments);var K=s.getFloatingAnchorIndex(E);E.endpoints[K===0?1:0].anchor.locked=false;E.removeClass(s.draggingClass);if(this._jsPlumb&&(E.deleteConnectionNow||E.endpoints[K]==this._jsPlumb.floatingEndpoint)){if(v&&E.suspendedEndpoint){if(K===0){E.floatingElement=E.source;E.floatingId=E.sourceId;E.floatingEndpoint=E.endpoints[0];E.floatingIndex=0;E.source=G[0];E.sourceId=G[1]}else{E.floatingElement=E.target;E.floatingId=E.targetId;E.floatingEndpoint=E.endpoints[1];E.floatingIndex=1;E.target=G[0];E.targetId=G[1]}var M=this._jsPlumb.floatingEndpoint;s.setDragScope(G[2],G[3]);E.endpoints[K]=E.suspendedEndpoint;if(E.isReattach()||E._forceReattach||E._forceDetach||!E.endpoints[K===0?1:0].detach({connection:E,ignoreTarget:false,forceDetach:false,fireEvent:true,originalEvent:L,endpointBeingDeleted:true})){E.setHover(false);E._forceDetach=null;E._forceReattach=null;this._jsPlumb.floatingEndpoint.detachFromConnection(E);E.suspendedEndpoint.addConnection(E);if(K==1){s.anchorManager.updateOtherEndpoint(E.sourceId,E.floatingId,E.targetId,E)}else{s.anchorManager.sourceChanged(E.floatingId,E.sourceId,E,E.source)}s.repaint(G[1])}else{s.deleteObject({endpoint:M})}}}if(this.deleteAfterDragStop){s.deleteObject({endpoint:this})}else{if(this._jsPlumb){this.paint({recalc:false})}}s.fire("connectionDragStop",E,L);if(E.pending){s.fire("connectionAborted",E,L)}s.currentlyDragging=false;E.suspendedElement=null;E.suspendedEndpoint=null;E=null}if(x&&x.element){s.remove(x.element,false,false)}if(m){s.deleteObject({endpoint:m})}if(this._jsPlumb){this.canvas.style.visibility="visible";this.anchor.locked=false;this._jsPlumb.floatingEndpoint=null}}.bind(this);H=e.extend(I,H);H.scope=this.scope||H.scope;H[J]=a.wrap(H[J],C,false);H[z]=a.wrap(H[z],w,false);H[D]=a.wrap(H[D],B.drag);H[y]=a.wrap(H[y],A);H.multipleDrop=false;H.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0}.bind(this);s.initDraggable(this.canvas,H,"internal");this.canvas._jsPlumbRelatedElement=this.element;r=true}};var u=k.endpoint||this._jsPlumb.instance.Defaults.Endpoint||e.Defaults.Endpoint;this.setEndpoint(u,true);var q=k.anchor?k.anchor:k.anchors?k.anchors:(s.Defaults.Anchor||"Top");this.setAnchor(q,true);var o=["default",(k.type||"")].join(" ");this.addType(o,k.data,true);this.canvas=this.endpoint.canvas;this.canvas._jsPlumb=this;this.initDraggable();var p=function(y,B,E,v){if(e.isDropSupported(this.element)){var z=k.dropOptions||s.Defaults.DropOptions||e.Defaults.DropOptions;z=e.extend({},z);z.scope=z.scope||this.scope;var x=e.dragEvents.drop,C=e.dragEvents.over,w=e.dragEvents.out,D=this,A=s.EndpointDropHandler({getEndpoint:function(){return D},jsPlumb:s,enabled:function(){return E!=null?E.isEnabled():true},isFull:function(){return E.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(F){D.addClass(F)},removeClass:function(F){D.removeClass(F)},isDropAllowed:function(){return D.isDropAllowed.apply(D,arguments)},reference:v,isRedrop:function(G,F){return G.suspendedEndpoint&&F.reference&&(G.suspendedEndpoint.id===F.reference.id)}});z[x]=a.wrap(z[x],A,true);z[C]=a.wrap(z[C],function(){var G=e.getDragObject(arguments),K=s.getAttribute(e.getElement(G),"dragId"),J=s.floatingConnections[K];if(J!=null){var F=s.getFloatingAnchorIndex(J);var I=(this.isTarget&&F!==0)||(J.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==J.suspendedEndpoint.id);if(I){var H=s.checkCondition("checkDropAllowed",{sourceEndpoint:J.endpoints[F],targetEndpoint:this,connection:J});this[(H?"add":"remove")+"Class"](s.endpointDropAllowedClass);this[(H?"remove":"add")+"Class"](s.endpointDropForbiddenClass);J.endpoints[F].anchor.over(this.anchor,this)}}}.bind(this));z[w]=a.wrap(z[w],function(){var G=e.getDragObject(arguments),J=G==null?null:s.getAttribute(e.getElement(G),"dragId"),I=J?s.floatingConnections[J]:null;if(I!=null){var F=s.getFloatingAnchorIndex(I);var H=(this.isTarget&&F!==0)||(I.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==I.suspendedEndpoint.id);if(H){this.removeClass(s.endpointDropAllowedClass);this.removeClass(s.endpointDropForbiddenClass);I.endpoints[F].anchor.out()}}}.bind(this));s.initDroppable(y,z,"internal",B)}}.bind(this);if(!this.anchor.isFloating){p(this.canvas,!(k._transient||this.anchor.isFloating),this,k.reference)}return this};a.extend(e.Endpoint,e.OverlayCapableJsPlumbUIComponent,{setVisible:function(l,o,k){this._jsPlumb.visible=l;if(this.canvas){this.canvas.style.display=l?"block":"none"}this[l?"showOverlays":"hideOverlays"]();if(!o){for(var n=0;n<this.connections.length;n++){this.connections[n].setVisible(l);if(!k){var m=this===this.connections[n].endpoints[0]?1:0;if(this.connections[n].endpoints[m].connections.length==1){this.connections[n].endpoints[m].setVisible(l,true,true)}}}}},getAttachedElements:function(){return this.connections},applyType:function(i,k){this.setPaintStyle(i.endpointStyle||i.paintStyle,k);this.setHoverPaintStyle(i.endpointHoverStyle||i.hoverPaintStyle,k);if(i.maxConnections!=null){this._jsPlumb.maxConnections=i.maxConnections}if(i.scope){this.scope=i.scope}e.extend(this,i,f);if(i.cssClass!=null&&this.canvas){this._jsPlumb.instance.addClass(this.canvas,i.cssClass)}e.OverlayCapableJsPlumbUIComponent.applyType(this,i)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(i){this._jsPlumb.enabled=i},cleanup:function(){var i=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");e.removeClass(this.element,i);this.anchor=null;this.endpoint.cleanup(true);this.endpoint.destroy();this.endpoint=null;this._jsPlumb.instance.destroyDraggable(this.canvas,"internal");this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(i){if(this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){this.endpoint.setHover(i)}},isFull:function(){return this._jsPlumb.maxConnections===0?true:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return this.anchor!=null&&this.anchor.isFloating},isConnectedTo:function(m){var l=false;if(m){for(var k=0;k<this.connections.length;k++){if(this.connections[k].endpoints[1]==m||this.connections[k].endpoints[0]==m){l=true;break}}}return l},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(i){this._jsPlumb.connectionCost=i},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(i){this._jsPlumb.connectionsDirected=i},setElementId:function(i){this.elementId=i;this.anchor.elementId=i},setReferenceElement:function(i){this.element=e.getElement(i)},setDragAllowedWhenFull:function(i){this.dragAllowedWhenFull=i},equals:function(i){return this.anchor.equals(i.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(i){return this.anchor.compute(i)}});b.jsPlumbInstance.prototype.EndpointDropHandler=function(i){return function(r){var w=i.jsPlumb;i.removeClass(w.endpointDropAllowedClass);i.removeClass(w.endpointDropForbiddenClass);var k=w.getDropEvent(arguments),y=w.getDragObject(arguments),n=w.getAttribute(y,"dragId"),p=w.getAttribute(y,"elId"),x=w.getAttribute(y,"originalScope"),t=w.floatingConnections[n];if(t==null){return}var v=t.suspendedEndpoint!=null;if(v&&t.suspendedEndpoint._jsPlumb==null){return}var s=i.getEndpoint(t);if(s==null){return}if(i.isRedrop(t,i)){t._forceReattach=true;t.setHover(false);if(i.maybeCleanup){i.maybeCleanup(s)}return}var u=w.getFloatingAnchorIndex(t);if((u===0&&!i.isSource)||(u===1&&!i.isTarget)){if(i.maybeCleanup){i.maybeCleanup(s)}return}if(i.onDrop){i.onDrop(t)}if(x){w.setDragScope(y,x)}var m=i.isFull(r);if(m){s.fire("maxConnections",{endpoint:this,connection:t,maxConnections:s._jsPlumb.maxConnections},k)}if(!m&&i.enabled()){var q=true;if(u===0){t.floatingElement=t.source;t.floatingId=t.sourceId;t.floatingEndpoint=t.endpoints[0];t.floatingIndex=0;t.source=i.element;t.sourceId=i.elementId}else{t.floatingElement=t.target;t.floatingId=t.targetId;t.floatingEndpoint=t.endpoints[1];t.floatingIndex=1;t.target=i.element;t.targetId=i.elementId}if(v&&t.suspendedEndpoint.id!=s.id){if(!t.isDetachAllowed(t)||!t.endpoints[u].isDetachAllowed(t)||!t.suspendedEndpoint.isDetachAllowed(t)||!w.checkCondition("beforeDetach",t)){q=false}}var l=function(B){t.endpoints[u].detachFromConnection(t);if(t.suspendedEndpoint){t.suspendedEndpoint.detachFromConnection(t)}t.endpoints[u]=s;s.addConnection(t);var D=s.getParameters();for(var C in D){t.setParameter(C,D[C])}if(!v){if(D.draggable){w.initDraggable(this.element,dragOptions,"internal",w)}}else{var z=t.suspendedEndpoint.elementId;w.fireMoveEvent({index:u,originalSourceId:u===0?z:t.sourceId,newSourceId:u===0?s.elementId:t.sourceId,originalTargetId:u==1?z:t.targetId,newTargetId:u==1?s.elementId:t.targetId,originalSourceEndpoint:u===0?t.suspendedEndpoint:t.endpoints[0],newSourceEndpoint:u===0?s:t.endpoints[0],originalTargetEndpoint:u==1?t.suspendedEndpoint:t.endpoints[1],newTargetEndpoint:u==1?s:t.endpoints[1],connection:t},k)}if(u==1){w.anchorManager.updateOtherEndpoint(t.sourceId,t.floatingId,t.targetId,t)}else{w.anchorManager.sourceChanged(t.floatingId,t.sourceId,t,t.source)}if(t.endpoints[0].finalEndpoint){var A=t.endpoints[0];A.detachFromConnection(t);t.endpoints[0]=t.endpoints[0].finalEndpoint;t.endpoints[0].addConnection(t)}if(a.isObject(B)){t.mergeData(B)}w.finaliseConnection(t,null,k,false);t.setHover(false)}.bind(this);var o=function(){if(t.suspendedEndpoint){t.endpoints[u]=t.suspendedEndpoint;t.setHover(false);t._forceDetach=true;if(u===0){t.source=t.suspendedEndpoint.element;t.sourceId=t.suspendedEndpoint.elementId}else{t.target=t.suspendedEndpoint.element;t.targetId=t.suspendedEndpoint.elementId}t.suspendedEndpoint.addConnection(t);if(u==1){w.anchorManager.updateOtherEndpoint(t.sourceId,t.floatingId,t.targetId,t)}else{w.anchorManager.sourceChanged(t.floatingId,t.sourceId,t,t.source)}w.repaint(t.sourceId);t._forceDetach=false}};q=q&&i.isDropAllowed(t.sourceId,t.targetId,t.scope,t,s);if(q){l(q);return true}else{o()}}if(i.maybeCleanup){i.maybeCleanup(s)}w.currentlyDragging=false}}}).call(typeof window!=="undefined"?window:this);(function(){var b=this,d=b.jsPlumb,a=b.jsPlumbUtil;var f=function(g,i,l,k,h){if(!g.Defaults.DoNotThrowErrors&&d.Connectors[i][l]==null){throw {msg:"jsPlumb: unknown connector type '"+l+"'"}}return new d.Connectors[i][l](k,h)},c=function(i,h,g){return(i)?g.makeAnchor(i,h,g):null},e=function(k,i,h,g){if(i!=null){i._jsPlumbConnections=i._jsPlumbConnections||{};if(g){delete i._jsPlumbConnections[k.id]}else{i._jsPlumbConnections[k.id]=true}if(a.isEmpty(i._jsPlumbConnections)){h.removeClass(i,h.connectedClass)}else{h.addClass(i,h.connectedClass)}}};d.Connection=function(w){var u=w.newEndpoint;this.id=w.id;this.connector=null;this.idPrefix="_jsplumb_c_";this.defaultLabelLocation=0.5;this.defaultOverlayKeys=["Overlays","ConnectionOverlays"];this.previousConnection=w.previousConnection;this.source=d.getElement(w.source);this.target=d.getElement(w.target);if(w.sourceEndpoint){this.source=w.sourceEndpoint.getElement()}if(w.targetEndpoint){this.target=w.targetEndpoint.getElement()}d.OverlayCapableJsPlumbUIComponent.apply(this,arguments);this.sourceId=this._jsPlumb.instance.getId(this.source);this.targetId=this._jsPlumb.instance.getId(this.target);this.scope=w.scope;this.endpoints=[];this.endpointStyles=[];var x=this._jsPlumb.instance;x.manage(this.sourceId,this.source);x.manage(this.targetId,this.target);this._jsPlumb.visible=true;this._jsPlumb.editable=w.editable===true;this._jsPlumb.params={cssClass:w.cssClass,container:w.container,"pointer-events":w["pointer-events"],editorParams:w.editorParams,overlays:w.overlays};this._jsPlumb.lastPaintedAt=null;this.bind("mouseover",function(){this.setHover(true)}.bind(this));this.bind("mouseout",function(){this.setHover(false)}.bind(this));this.editableRequested=w.editable!==false;this.setEditable=function(A){return this.connector?this.connector.setEditable(A):false};this.isEditable=function(){return this.connector?this.connector.isEditable():false};this.isEditing=function(){return this.connector?this.connector.isEditing():false};this.makeEndpoint=function(C,D,B,A){B=B||this._jsPlumb.instance.getId(D);return this.prepareEndpoint(x,u,this,A,C?0:1,w,D,B)};if(w.type){w.endpoints=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(w.type).endpoints}var s=this.makeEndpoint(true,this.source,this.sourceId,w.sourceEndpoint),r=this.makeEndpoint(false,this.target,this.targetId,w.targetEndpoint);if(s){a.addToList(w.endpointsByElement,this.sourceId,s)}if(r){a.addToList(w.endpointsByElement,this.targetId,r)}if(!this.scope){this.scope=this.endpoints[0].scope}if(w.deleteEndpointsOnDetach!=null){this.endpoints[0]._deleteOnDetach=w.deleteEndpointsOnDetach;this.endpoints[1]._deleteOnDetach=w.deleteEndpointsOnDetach}else{if(!this.endpoints[0]._doNotDeleteOnDetach){this.endpoints[0]._deleteOnDetach=true}if(!this.endpoints[1]._doNotDeleteOnDetach){this.endpoints[1]._deleteOnDetach=true}}var i=x.Defaults.ConnectionsDetachable;if(w.detachable===false){i=false}if(this.endpoints[0].connectionsDetachable===false){i=false}if(this.endpoints[1].connectionsDetachable===false){i=false}var o=w.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||x.Defaults.ReattachConnections;this.appendToDefaultType({detachable:i,reattach:o,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||w.paintStyle||x.Defaults.PaintStyle||d.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||w.hoverPaintStyle||x.Defaults.HoverPaintStyle||d.Defaults.HoverPaintStyle});var l=x.getSuspendedAt();if(!x.isSuspendDrawing()){var k=x.getCachedData(this.sourceId),n=k.o,m=k.s,v=x.getCachedData(this.targetId),g=v.o,p=v.s,q=l||x.timestamp(),t=this.endpoints[0].anchor.compute({xy:[n.left,n.top],wh:m,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[g.left,g.top],twh:p,tElement:this.endpoints[1],timestamp:q});this.endpoints[0].paint({anchorLoc:t,timestamp:q});t=this.endpoints[1].anchor.compute({xy:[g.left,g.top],wh:p,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[n.left,n.top],twh:m,tElement:this.endpoints[0],timestamp:q});this.endpoints[1].paint({anchorLoc:t,timestamp:q})}this.getTypeDescriptor=function(){return"connection"};this.getAttachedElements=function(){return this.endpoints};this.isDetachable=function(){return this._jsPlumb.detachable===true};this.setDetachable=function(A){this._jsPlumb.detachable=A===true};this.isReattach=function(){return this._jsPlumb.reattach===true||this.endpoints[0].reattachConnections===true||this.endpoints[1].reattachConnections===true};this.setReattach=function(A){this._jsPlumb.reattach=A===true};this._jsPlumb.cost=w.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=w.directed;if(w.directed==null){this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected()}var y=d.extend({},this.endpoints[1].getParameters());d.extend(y,this.endpoints[0].getParameters());d.extend(y,this.getParameters());this.setParameters(y);this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||w.connector||x.Defaults.Connector||d.Defaults.Connector,true);if(w.geometry){this.connector.setGeometry(w.geometry)}var z=w.data==null||!a.isObject(w.data)?{}:w.data;this.getData=function(){return z};this.setData=function(A){z=A||{}};this.mergeData=function(A){z=d.extend(z,A)};var h=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,w.type].join(" ");if(/[^\s]/.test(h)){this.addType(h,w.data,true)}this.updateConnectedClass()};a.extend(d.Connection,d.OverlayCapableJsPlumbUIComponent,{applyType:function(h,i,k){if(h.detachable!=null){this.setDetachable(h.detachable)}if(h.reattach!=null){this.setReattach(h.reattach)}if(h.scope){this.scope=h.scope}if(h.cssClass!=null&&this.canvas){this._jsPlumb.instance.addClass(this.canvas,h.cssClass)}var g=null;if(h.anchor){g=this.getCachedTypeItem("anchors",k.anchor);if(g==null){g=[this._jsPlumb.instance.makeAnchor(h.anchor),this._jsPlumb.instance.makeAnchor(h.anchor)];this.cacheTypeItem("anchors",g,k.anchor)}}else{if(h.anchors){g=this.getCachedTypeItem("anchors",k.anchors);if(g==null){g=[this._jsPlumb.instance.makeAnchor(h.anchors[0]),this._jsPlumb.instance.makeAnchor(h.anchors[1])];this.cacheTypeItem("anchors",g,k.anchors)}}}if(g!=null){this.endpoints[0].anchor=g[0];this.endpoints[1].anchor=g[1];if(this.endpoints[1].anchor.isDynamic){this._jsPlumb.instance.repaint(this.endpoints[1].elementId)}}d.OverlayCapableJsPlumbUIComponent.applyType(this,h)},addClass:function(h,g){if(g){this.endpoints[0].addClass(h);this.endpoints[1].addClass(h);if(this.suspendedEndpoint){this.suspendedEndpoint.addClass(h)}}if(this.connector){this.connector.addClass(h)}},removeClass:function(h,g){if(g){this.endpoints[0].removeClass(h);this.endpoints[1].removeClass(h);if(this.suspendedEndpoint){this.suspendedEndpoint.removeClass(h)}}if(this.connector){this.connector.removeClass(h)}},isVisible:function(){return this._jsPlumb.visible},setVisible:function(g){this._jsPlumb.visible=g;if(this.connector){this.connector.setVisible(g)}this.repaint()},cleanup:function(){this.updateConnectedClass(true);this.endpoints=null;this.source=null;this.target=null;if(this.connector!=null){this.connector.cleanup(true);this.connector.destroy(true)}this.connector=null},updateConnectedClass:function(g){if(this._jsPlumb){e(this,this.source,this._jsPlumb.instance,g);e(this,this.target,this._jsPlumb.instance,g)}},setHover:function(g){if(this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){this.connector.setHover(g);b.jsPlumb[g?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass);b.jsPlumb[g?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass)}},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-Infinity},setCost:function(g){this._jsPlumb.cost=g},isDirected:function(){return this._jsPlumb.directed===true},getConnector:function(){return this.connector},getGeometry:function(){return this.connector?this.connector.getGeometry():null},setGeometry:function(h){if(this.connector){this.connector.setGeometry(h)}},prepareConnector:function(k,h){var l={_jsPlumb:this._jsPlumb.instance,cssClass:(this._jsPlumb.params.cssClass||"")+(this.isEditable()?this._jsPlumb.instance.editableConnectorClass:""),container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"],editable:this.editableRequested},i=this._jsPlumb.instance.getRenderMode(),g;if(a.isString(k)){g=f(this._jsPlumb.instance,i,k,l,this)}else{if(a.isArray(k)){if(k.length==1){g=f(this._jsPlumb.instance,i,k[0],l,this)}else{g=f(this._jsPlumb.instance,i,k[0],a.merge(k[1],l),this)}}}if(h!=null){g.typeId=h}return g},setPreparedConnector:function(h,p,g,m){var n,l="";if(this.connector!=null){n=this.connector;l=n.getClass();this.connector.cleanup();this.connector.destroy()}this.connector=h;if(m){this.cacheTypeItem("connector",h,m)}this.canvas=this.connector.canvas;this.bgCanvas=this.connector.bgCanvas;this.addClass(l);if(this.canvas){this.canvas._jsPlumb=this}if(this.bgCanvas){this.bgCanvas._jsPlumb=this}if(n!=null){var q=this.getOverlays();for(var k=0;k<q.length;k++){if(q[k].transfer){q[k].transfer(this.connector)}}}if(!g){this.setListenerComponent(this.connector)}if(!p){this.repaint()}},setConnector:function(l,k,h,i){var g=this.prepareConnector(l,i);this.setPreparedConnector(g,k,h,i)},paint:function(B){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){B=B||{};var k=B.timestamp,s=false,A=s?this.sourceId:this.targetId,n=s?this.targetId:this.sourceId,l=s?0:1,D=s?1:0;if(k==null||k!=this._jsPlumb.lastPaintedAt){var E=this._jsPlumb.instance.updateOffset({elId:n}).o,q=this._jsPlumb.instance.updateOffset({elId:A}).o,v=this.endpoints[D],g=this.endpoints[l];var m=v.anchor.getCurrentLocation({xy:[E.left,E.top],wh:[E.width,E.height],element:v,timestamp:k}),z=g.anchor.getCurrentLocation({xy:[q.left,q.top],wh:[q.width,q.height],element:g,timestamp:k});this.connector.resetBounds();this.connector.compute({sourcePos:m,targetPos:z,sourceEndpoint:this.endpoints[D],targetEndpoint:this.endpoints[l],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:E,targetInfo:q});var r={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};for(var y in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(y)){var u=this._jsPlumb.overlays[y];if(u.isVisible()){this._jsPlumb.overlayPlacements[y]=u.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(u));r.minX=Math.min(r.minX,this._jsPlumb.overlayPlacements[y].minX);r.maxX=Math.max(r.maxX,this._jsPlumb.overlayPlacements[y].maxX);r.minY=Math.min(r.minY,this._jsPlumb.overlayPlacements[y].minY);r.maxY=Math.max(r.maxY,this._jsPlumb.overlayPlacements[y].maxY)}}}var h=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,C=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),x={xmin:Math.min(this.connector.bounds.minX-(h+C),r.minX),ymin:Math.min(this.connector.bounds.minY-(h+C),r.minY),xmax:Math.max(this.connector.bounds.maxX+(h+C),r.maxX),ymax:Math.max(this.connector.bounds.maxY+(h+C),r.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,x);for(var w in this._jsPlumb.overlays){if(this._jsPlumb.overlays.hasOwnProperty(w)){var t=this._jsPlumb.overlays[w];if(t.isVisible()){t.paint(this._jsPlumb.overlayPlacements[w],x)}}}}this._jsPlumb.lastPaintedAt=k}},repaint:function(g){g=g||{};this.paint({elId:this.sourceId,recalc:!(g.recalc===false),timestamp:g.timestamp})},prepareEndpoint:function(s,h,i,g,n,k,l,m){var o;if(g){i.endpoints[n]=g;g.addConnection(i)}else{if(!k.endpoints){k.endpoints=[null,null]}var v=k.endpoints[n]||k.endpoint||s.Defaults.Endpoints[n]||d.Defaults.Endpoints[n]||s.Defaults.Endpoint||d.Defaults.Endpoint;if(!k.endpointStyles){k.endpointStyles=[null,null]}if(!k.endpointHoverStyles){k.endpointHoverStyles=[null,null]}var r=k.endpointStyles[n]||k.endpointStyle||s.Defaults.EndpointStyles[n]||d.Defaults.EndpointStyles[n]||s.Defaults.EndpointStyle||d.Defaults.EndpointStyle;if(r.fill==null&&k.paintStyle!=null){r.fill=k.paintStyle.stroke}if(r.outlineStroke==null&&k.paintStyle!=null){r.outlineStroke=k.paintStyle.outlineStroke}if(r.outlineWidth==null&&k.paintStyle!=null){r.outlineWidth=k.paintStyle.outlineWidth}var q=k.endpointHoverStyles[n]||k.endpointHoverStyle||s.Defaults.EndpointHoverStyles[n]||d.Defaults.EndpointHoverStyles[n]||s.Defaults.EndpointHoverStyle||d.Defaults.EndpointHoverStyle;if(k.hoverPaintStyle!=null){if(q==null){q={}}if(q.fill==null){q.fill=k.hoverPaintStyle.stroke}}var p=k.anchors?k.anchors[n]:k.anchor?k.anchor:c(s.Defaults.Anchors[n],m,s)||c(d.Defaults.Anchors[n],m,s)||c(s.Defaults.Anchor,m,s)||c(d.Defaults.Anchor,m,s),t=k.uuids?k.uuids[n]:null;o=h({paintStyle:r,hoverPaintStyle:q,endpoint:v,connections:[i],uuid:t,anchor:p,source:l,scope:k.scope,reattach:k.reattach||s.Defaults.ReattachConnections,detachable:k.detachable||s.Defaults.ConnectionsDetachable});i.endpoints[n]=o;if(k.drawEndpoints===false){o.setVisible(false,true,true)}}return o}})}).call(typeof window!=="undefined"?window:this);(function(){var c=this,a=c.jsPlumbUtil,e=c.jsPlumb;e.AnchorManager=function(z){var i={},x={},p={},B={},y={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},u=["left","top","right","bottom"],k={},r=this,l={},s=z.jsPlumbInstance,q={},n=function(Q,R,O,H,P,D){if(Q===R){return{orientation:y.IDENTITY,a:["top","top"]}}var E=Math.atan2((H.centery-O.centery),(H.centerx-O.centerx)),L=Math.atan2((O.centery-H.centery),(O.centerx-H.centerx));var K=[],J={};(function(T,U){for(var S=0;S<T.length;S++){J[T[S]]={left:[U[S].left,U[S].centery],right:[U[S].right,U[S].centery],top:[U[S].centerx,U[S].top],bottom:[U[S].centerx,U[S].bottom]}}})(["source","target"],[O,H]);for(var N=0;N<u.length;N++){for(var G=0;G<u.length;G++){K.push({source:u[N],target:u[G],dist:Biltong.lineLength(J.source[u[N]],J.target[u[G]])})}}K.sort(function(T,S){return T.dist<S.dist?-1:T.dist>S.dist?1:0});var F=K[0].source,M=K[0].target;for(var I=0;I<K.length;I++){if(!P.isContinuous||P.isEdgeSupported(K[I].source)){F=K[I].source}else{F=null}if(!D.isContinuous||D.isEdgeSupported(K[I].target)){M=K[I].target}else{M=null}if(F!=null&&M!=null){break}}return{a:[F,M],theta:E,theta2:L}},C=function(R,N,L,M,S,O,F){var T=[],E=N[S?0:1]/(M.length+1);for(var P=0;P<M.length;P++){var U=(P+1)*E,D=O*N[S?1:0];if(F){U=N[S?0:1]-U}var K=(S?U:D),H=L[0]+K,J=K/N[0],I=(S?D:U),G=L[1]+I,Q=I/N[1];T.push([H,G,J,Q,M[P][1],M[P][2]])}return T},A=function(D){return function(F,E){var G=true;if(D){G=F[0][0]<E[0][0]}else{G=F[0][0]>E[0][0]}return G===false?-1:1}},g=function(E,D){var G=E[0][0]<0?-Math.PI-E[0][0]:Math.PI-E[0][0],F=D[0][0]<0?-Math.PI-D[0][0]:Math.PI-D[0][0];if(G>F){return 1}else{return -1}},v={top:function(E,D){return E[0]>D[0]?1:-1},right:A(true),bottom:A(true),left:g},t=function(D,E){return D.sort(E)},m=function(E,D){var I=s.getCachedData(E),G=I.s,H=I.o,F=function(P,W,L,O,U,T,K){if(O.length>0){var S=t(O,v[P]),Q=P==="right"||P==="top",J=C(P,W,L,S,U,T,Q);var X=function(Z,Y){x[Z.id]=[Y[0],Y[1],Y[2],Y[3]];B[Z.id]=K};for(var M=0;M<J.length;M++){var R=J[M][4],V=R.endpoints[0].elementId===E,N=R.endpoints[1].elementId===E;if(V){X(R.endpoints[0],J[M])}if(N){X(R.endpoints[1],J[M])}}}};F("bottom",G,[H.left,H.top],D.bottom,true,1,[0,1]);F("top",G,[H.left,H.top],D.top,true,0,[0,-1]);F("left",G,[H.left,H.top],D.left,false,0,[-1,0]);F("right",G,[H.left,H.top],D.right,false,1,[1,0])};this.reset=function(){i={};k={};l={}};this.addFloatingConnection=function(D,E){q[D]=E};this.removeFloatingConnection=function(D){delete q[D]};this.newConnection=function(G){var I=G.sourceId,F=G.targetId,D=G.endpoints,H=true,E=function(J,K,M,L,N){if((I==F)&&M.isContinuous){G._jsPlumb.instance.removeElement(D[1].canvas);H=false}a.addToList(k,L,[N,K,M.constructor==e.DynamicAnchor])};E(0,D[0],D[0].anchor,F,G);if(H){E(1,D[1],D[1].anchor,I,G)}};var h=function(D){(function(G,E){if(G){var F=function(H){return H[4]==E};a.removeWithFunction(G.top,F);a.removeWithFunction(G.left,F);a.removeWithFunction(G.bottom,F);a.removeWithFunction(G.right,F)}})(l[D.elementId],D.id)};this.connectionDetached=function(J,G){var E=J.connection||J,I=J.sourceId,F=J.targetId,D=E.endpoints,H=function(K,L,N,M,O){a.removeWithFunction(k[M],function(P){return P[0].id==O.id})};H(1,D[1],D[1].anchor,I,E);H(0,D[0],D[0].anchor,F,E);if(E.floatingId){H(E.floatingIndex,E.floatingEndpoint,E.floatingEndpoint.anchor,E.floatingId,E);h(E.floatingEndpoint)}h(E.endpoints[0]);h(E.endpoints[1]);if(!G){r.redraw(E.sourceId);if(E.targetId!==E.sourceId){r.redraw(E.targetId)}}};this.add=function(E,D){a.addToList(i,D,E)};this.changeId=function(E,D){k[D]=k[E];i[D]=i[E];delete k[E];delete i[E]};this.getConnectionsFor=function(D){return k[D]||[]};this.getEndpointsFor=function(D){return i[D]||[]};this.deleteEndpoint=function(D){a.removeWithFunction(i[D.elementId],function(E){return E.id==D.id});h(D)};this.clearFor=function(D){delete i[D];i[D]=[]};var o=function(Y,L,T,H,O,P,R,N,aa,Q,G,X){var V=-1,F=-1,I=H.endpoints[R],S=I.id,M=[1,0][R],D=[[L,T],H,O,P,S],E=Y[aa],Z=I._continuousAnchorEdge?Y[I._continuousAnchorEdge]:null,U,J;if(Z){var W=a.findWithFunction(Z,function(ab){return ab[4]==S});if(W!=-1){Z.splice(W,1);for(U=0;U<Z.length;U++){J=Z[U][1];a.addWithFunction(G,J,function(ab){return ab.id==J.id});a.addWithFunction(X,Z[U][1].endpoints[R],function(ab){return ab.id==J.endpoints[R].id});a.addWithFunction(X,Z[U][1].endpoints[M],function(ab){return ab.id==J.endpoints[M].id})}}}for(U=0;U<E.length;U++){J=E[U][1];if(z.idx==1&&E[U][3]===P&&F==-1){F=U}a.addWithFunction(G,J,function(ab){return ab.id==J.id});a.addWithFunction(X,E[U][1].endpoints[R],function(ab){return ab.id==J.endpoints[R].id});a.addWithFunction(X,E[U][1].endpoints[M],function(ab){return ab.id==J.endpoints[M].id})}if(V!=-1){E[V]=D}else{var K=N?F!=-1?F:0:E.length;E.splice(K,0,D)}I._continuousAnchorEdge=aa};this.updateOtherEndpoint=function(E,H,I,D){var G=a.findWithFunction(k[E],function(J){return J[0].id===D.id}),F=a.findWithFunction(k[H],function(J){return J[0].id===D.id});if(G!=-1){k[E][G][0]=D;k[E][G][1]=D.endpoints[1];k[E][G][2]=D.endpoints[1].anchor.constructor==e.DynamicAnchor}if(F>-1){k[H].splice(F,1);a.addToList(k,I,[D,D.endpoints[0],D.endpoints[0].anchor.constructor==e.DynamicAnchor])}D.updateConnectedClass()};this.sourceChanged=function(E,G,F,H){if(E!==G){F.sourceId=G;F.source=H;a.removeWithFunction(k[E],function(I){return I[0].id===F.id});var D=a.findWithFunction(k[F.targetId],function(I){return I[0].id===F.id});if(D>-1){k[F.targetId][D][0]=F;k[F.targetId][D][1]=F.endpoints[0];k[F.targetId][D][2]=F.endpoints[0].anchor.constructor==e.DynamicAnchor}a.addToList(k,G,[F,F.endpoints[1],F.endpoints[1].anchor.constructor==e.DynamicAnchor]);if(F.endpoints[1].anchor.isContinuous){if(F.source===F.target){F._jsPlumb.instance.removeElement(F.endpoints[1].canvas)}else{if(F.endpoints[1].canvas.parentNode==null){F._jsPlumb.instance.appendElement(F.endpoints[1].canvas)}}}F.updateConnectedClass()}};this.rehomeEndpoint=function(G,E,J){var F=i[E]||[],H=s.getId(J);if(H!==E){var D=F.indexOf(G);if(D>-1){var K=F.splice(D,1)[0];r.add(K,H)}}for(var I=0;I<G.connections.length;I++){if(G.connections[I].sourceId==E){r.sourceChanged(E,G.elementId,G.connections[I],G.element)}else{if(G.connections[I].targetId==E){G.connections[I].targetId=G.elementId;G.connections[I].target=G.element;r.updateOtherEndpoint(G.connections[I].sourceId,E,G.elementId,G.connections[I])}}}};this.redraw=function(R,V,F,I,Z,T){if(!s.isSuspendDrawing()){var ae=i[R]||[],ad=k[R]||[],E=[],ac=[],G=[];F=F||s.timestamp();I=I||{left:0,top:0};if(V){V={left:V.left+I.left,top:V.top+I.top}}var M=s.updateOffset({elId:R,offset:V,recalc:false,timestamp:F}),O={};for(var aa=0;aa<ad.length;aa++){var J=ad[aa][0],L=J.sourceId,H=J.targetId,K=J.endpoints[0].anchor.isContinuous,Q=J.endpoints[1].anchor.isContinuous;if(K||Q){var ab=L+"_"+H,X=O[ab],P=J.sourceId==R?1:0;if(K&&!l[L]){l[L]={top:[],right:[],bottom:[],left:[]}}if(Q&&!l[H]){l[H]={top:[],right:[],bottom:[],left:[]}}if(R!=H){s.updateOffset({elId:H,timestamp:F})}if(R!=L){s.updateOffset({elId:L,timestamp:F})}var N=s.getCachedData(H),D=s.getCachedData(L);if(H==L&&(K||Q)){o(l[L],-Math.PI/2,0,J,false,H,0,false,"top",L,E,ac);o(l[H],-Math.PI/2,0,J,false,L,1,false,"top",H,E,ac)}else{if(!X){X=n(L,H,D.o,N.o,J.endpoints[0].anchor,J.endpoints[1].anchor);O[ab]=X}if(K){o(l[L],X.theta,0,J,false,H,0,false,X.a[0],L,E,ac)}if(Q){o(l[H],X.theta2,-1,J,true,L,1,true,X.a[1],H,E,ac)}}if(K){a.addWithFunction(G,L,function(af){return af===L})}if(Q){a.addWithFunction(G,H,function(af){return af===H})}a.addWithFunction(E,J,function(af){return af.id==J.id});if((K&&P===0)||(Q&&P===1)){a.addWithFunction(ac,J.endpoints[P],function(af){return af.id==J.endpoints[P].id})}}}for(aa=0;aa<ae.length;aa++){if(ae[aa].connections.length===0&&ae[aa].anchor.isContinuous){if(!l[R]){l[R]={top:[],right:[],bottom:[],left:[]}}o(l[R],-Math.PI/2,0,{endpoints:[ae[aa],ae[aa]],paint:function(){}},false,R,0,false,ae[aa].anchor.getDefaultFace(),R,E,ac);a.addWithFunction(G,R,function(af){return af===R})}}for(aa=0;aa<G.length;aa++){m(G[aa],l[G[aa]])}for(aa=0;aa<ae.length;aa++){ae[aa].paint({timestamp:F,offset:M,dimensions:M.s,recalc:T!==true})}for(aa=0;aa<ac.length;aa++){var U=s.getCachedData(ac[aa].elementId);ac[aa].paint({timestamp:F,offset:U,dimensions:U.s})}for(aa=0;aa<ad.length;aa++){var S=ad[aa][1];if(S.anchor.constructor==e.DynamicAnchor){S.paint({elementWithPrecedence:R,timestamp:F});a.addWithFunction(E,ad[aa][0],function(af){return af.id==ad[aa][0].id});for(var Y=0;Y<S.connections.length;Y++){if(S.connections[Y]!==ad[aa][0]){a.addWithFunction(E,S.connections[Y],function(af){return af.id==S.connections[Y].id})}}}else{if(S.anchor.constructor==e.Anchor){a.addWithFunction(E,ad[aa][0],function(af){return af.id==ad[aa][0].id})}}}var W=q[R];if(W){W.paint({timestamp:F,recalc:false,elId:R})}for(aa=0;aa<E.length;aa++){E[aa].paint({elId:R,timestamp:F,recalc:false,clearEdits:Z})}}};var w=function(F){a.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=true;this.isContinuous=true;var I=F.faces||["top","right","bottom","left"],E=!(F.clockwise===false),N={},L={top:"bottom",right:"left",left:"right",bottom:"top"},H={top:"right",right:"bottom",left:"top",bottom:"left"},J={top:"left",right:"top",left:"bottom",bottom:"right"},G=E?H:J,D=E?J:H,M=F.cssClass||"";for(var K=0;K<I.length;K++){N[I[K]]=true}this.getDefaultFace=function(){return I.length===0?"top":I[0]};this.verifyEdge=function(O){if(N[O]){return O}else{if(N[L[O]]){return L[O]}else{if(N[G[O]]){return G[O]}else{if(N[D[O]]){return D[O]}}}}return O};this.isEdgeSupported=function(O){return N[O]===true};this.compute=function(O){return p[O.element.id]||x[O.element.id]||[0,0]};this.getCurrentLocation=function(O){return p[O.element.id]||x[O.element.id]||[0,0]};this.getOrientation=function(O){return B[O.id]||[0,0]};this.clearUserDefinedLocation=function(){delete p[F.elementId]};this.setUserDefinedLocation=function(O){p[F.elementId]=O};this.getCssClass=function(){return M}};s.continuousAnchorFactory={get:function(D){return new w(D)},clear:function(D){delete p[D];delete x[D]}}};e.Anchor=function(g){this.x=g.x||0;this.y=g.y||0;this.elementId=g.elementId;this.cssClass=g.cssClass||"";this.userDefinedLocation=null;this.orientation=g.orientation||[0,0];this.lastReturnValue=null;this.offsets=g.offsets||[0,0];this.timestamp=null;a.EventGenerator.apply(this);this.compute=function(l){var k=l.xy,h=l.wh,i=l.timestamp;if(l.clearUserDefinedLocation){this.userDefinedLocation=null}if(i&&i===this.timestamp){return this.lastReturnValue}if(this.userDefinedLocation!=null){this.lastReturnValue=this.userDefinedLocation}else{this.lastReturnValue=[k[0]+(this.x*h[0])+this.offsets[0],k[1]+(this.y*h[1])+this.offsets[1]]}this.timestamp=i;return this.lastReturnValue};this.getCurrentLocation=function(h){h=h||{};return(this.lastReturnValue==null||(h.timestamp!=null&&this.timestamp!=h.timestamp))?this.compute(h):this.lastReturnValue}};a.extend(e.Anchor,a.EventGenerator,{equals:function(g){if(!g){return false}var h=g.getOrientation(),i=this.getOrientation();return this.x==g.x&&this.y==g.y&&this.offsets[0]==g.offsets[0]&&this.offsets[1]==g.offsets[1]&&i[0]==h[0]&&i[1]==h[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(g){this.userDefinedLocation=g},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}});e.FloatingAnchor=function(n){e.Anchor.apply(this,arguments);var l=n.reference,m=n.referenceCanvas,i=e.getSize(m),h=0,o=0,g=null,k=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=true;this.compute=function(r){var q=r.xy,p=[q[0]+(i[0]/2),q[1]+(i[1]/2)];k=p;return p};this.getOrientation=function(q){if(g){return g}else{var p=l.getOrientation(q);return[Math.abs(p[0])*h*-1,Math.abs(p[1])*o*-1]}};this.over=function(p,q){g=p.getOrientation(q)};this.out=function(){g=null};this.getCurrentLocation=function(p){return k==null?this.compute(p):k}};a.extend(e.FloatingAnchor,e.Anchor);var f=function(i,h,g){return i.constructor==e.Anchor?i:h.makeAnchor(i,g,h)};e.DynamicAnchor=function(n){e.Anchor.apply(this,arguments);this.isDynamic=true;this.anchors=[];this.elementId=n.elementId;this.jsPlumbInstance=n.jsPlumbInstance;for(var l=0;l<n.anchors.length;l++){this.anchors[l]=f(n.anchors[l],this.jsPlumbInstance,this.elementId)}this.getAnchors=function(){return this.anchors};this.locked=false;var k=this.anchors.length>0?this.anchors[0]:null,m=k,h=this,g=function(u,r,q,v,p){var i=v[0]+(u.x*p[0]),w=v[1]+(u.y*p[1]),t=v[0]+(p[0]/2),s=v[1]+(p[1]/2);return(Math.sqrt(Math.pow(r-i,2)+Math.pow(q-w,2))+Math.sqrt(Math.pow(t-i,2)+Math.pow(s-w,2)))},o=n.selector||function(z,q,r,s,p){var u=r[0]+(s[0]/2),t=r[1]+(s[1]/2);var w=-1,y=Infinity;for(var v=0;v<p.length;v++){var x=g(p[v],u,t,z,q);if(x<y){w=v+0;y=x}}return p[w]};this.compute=function(s){var r=s.xy,i=s.wh,p=s.txy,t=s.twh;this.timestamp=s.timestamp;var q=h.getUserDefinedLocation();if(q!=null){return q}if(this.locked||p==null||t==null){return k.compute(s)}else{s.timestamp=null}k=o(r,i,p,t,this.anchors);this.x=k.x;this.y=k.y;if(k!=m){this.fire("anchorChanged",k)}m=k;return k.compute(s)};this.getCurrentLocation=function(i){return this.getUserDefinedLocation()||(k!=null?k.getCurrentLocation(i):null)};this.getOrientation=function(i){return k!=null?k.getOrientation(i):[0,0]};this.over=function(i,p){if(k!=null){k.over(i,p)}};this.out=function(){if(k!=null){k.out()}};this.getCssClass=function(){return(k&&k.getCssClass())||""}};a.extend(e.DynamicAnchor,e.Anchor);var d=function(g,m,i,h,l,k){e.Anchors[l]=function(o){var n=o.jsPlumbInstance.makeAnchor([g,m,i,h,0,0],o.elementId,o.jsPlumbInstance);n.type=l;if(k){k(n,o)}return n}};d(0.5,0,0,-1,"TopCenter");d(0.5,1,0,1,"BottomCenter");d(0,0.5,-1,0,"LeftMiddle");d(1,0.5,1,0,"RightMiddle");d(0.5,0,0,-1,"Top");d(0.5,1,0,1,"Bottom");d(0,0.5,-1,0,"Left");d(1,0.5,1,0,"Right");d(0.5,0.5,0,0,"Center");d(1,0,0,-1,"TopRight");d(1,1,0,1,"BottomRight");d(0,0,0,-1,"TopLeft");d(0,1,0,1,"BottomLeft");e.Defaults.DynamicAnchors=function(g){return g.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],g.elementId,g.jsPlumbInstance)};e.Anchors.AutoDefault=function(h){var g=h.jsPlumbInstance.makeDynamicAnchor(e.Defaults.DynamicAnchors(h));g.type="AutoDefault";return g};var b=function(h,g){e.Anchors[h]=function(k){var i=k.jsPlumbInstance.makeAnchor(["Continuous",{faces:g}],k.elementId,k.jsPlumbInstance);i.type=h;return i}};e.Anchors.Continuous=function(g){return g.jsPlumbInstance.continuousAnchorFactory.get(g)};b("ContinuousLeft",["left"]);b("ContinuousTop",["top"]);b("ContinuousBottom",["bottom"]);b("ContinuousRight",["right"]);d(0,0,0,0,"Assign",function(h,i){var g=i.position||"Fixed";h.positionFinder=g.constructor==String?i.jsPlumbInstance.AnchorPositionFinders[g]:g;h.constructorParams=i});c.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(i,g,h){return[(i.left-g.left)/h[0],(i.top-g.top)/h[1]]},Grid:function(g,q,l,h){var p=g.left-q.left,o=g.top-q.top,n=l[0]/(h.grid[0]),m=l[1]/(h.grid[1]),k=Math.floor(p/n),i=Math.floor(o/m);return[((k*n)+(n/2))/l[0],((i*m)+(m/2))/l[1]]}};e.Anchors.Perimeter=function(g){g=g||{};var h=g.anchorCount||60,l=g.shape;if(!l){throw new Error("no shape supplied to Perimeter Anchor type")}var i=function(){var w=0.5,v=Math.PI*2/h,z=0,t=[];for(var u=0;u<h;u++){var s=w+(w*Math.sin(z)),A=w+(w*Math.cos(z));t.push([s,A,0,0]);z+=v}return t},m=function(u){var w=h/u.length,s=[],t=function(A,D,z,C,E){w=h*E;var y=(z-A)/w,x=(C-D)/w;for(var B=0;B<w;B++){s.push([A+(y*B),D+(x*B),0,0])}};for(var v=0;v<u.length;v++){t.apply(null,u[v])}return s},p=function(t){var v=[];for(var u=0;u<t.length;u++){v.push([t[u][0],t[u][1],t[u][2],t[u][3],1/t.length])}return m(v)},n=function(){return p([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])};var k={Circle:i,Ellipse:i,Diamond:function(){return p([[0.5,0,1,0.5],[1,0.5,0.5,1],[0.5,1,0,0.5],[0,0.5,0.5,0]])},Rectangle:n,Square:n,Triangle:function(){return p([[0.5,0,1,1],[1,1,0,1],[0,1,0.5,0]])},Path:function(y){var w=y.points,x=[],t=0;for(var v=0;v<w.length-1;v++){var s=Math.sqrt(Math.pow(w[v][2]-w[v][0])+Math.pow(w[v][3]-w[v][1]));t+=s;x.push([w[v][0],w[v][1],w[v+1][0],w[v+1][1],s])}for(var u=0;u<x.length;u++){x[u][4]=x[u][4]/t}return m(x)}},q=function(x,w){var y=[],v=w/180*Math.PI;for(var u=0;u<x.length;u++){var t=x[u][0]-0.5,s=x[u][1]-0.5;y.push([0.5+((t*Math.cos(v))-(s*Math.sin(v))),0.5+((t*Math.sin(v))+(s*Math.cos(v))),x[u][2],x[u][3]])}return y};if(!k[l]){throw new Error("Shape ["+l+"] is unknown by Perimeter Anchor type")}var r=k[l](g);if(g.rotation){r=q(r,g.rotation)}var o=g.jsPlumbInstance.makeDynamicAnchor(r);o.type="Perimeter";return o}}).call(typeof window!=="undefined"?window:this);(function(){var g=this,i=g.jsPlumb,f=g.jsPlumbUtil,c=g.Biltong;i.Segments={AbstractSegment:function(k){this.params=k;this.findClosestPointOnPath=function(l,m){return{d:Infinity,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(k.x1,k.x2),minY:Math.min(k.y1,k.y2),maxX:Math.max(k.x1,k.x2),maxY:Math.max(k.y1,k.y2)}}},Straight:function(r){var v=i.Segments.AbstractSegment.apply(this,arguments),p,q,w,o,l,u,t,k=function(){p=Math.sqrt(Math.pow(l-o,2)+Math.pow(t-u,2));q=c.gradient({x:o,y:u},{x:l,y:t});w=-1/q};this.type="Straight";this.getLength=function(){return p};this.getGradient=function(){return q};this.getCoordinates=function(){return{x1:o,y1:u,x2:l,y2:t}};this.setCoordinates=function(m){o=m.x1;u=m.y1;l=m.x2;t=m.y2;k()};this.setCoordinates({x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2});this.getBounds=function(){return{minX:Math.min(o,l),minY:Math.min(u,t),maxX:Math.max(o,l),maxY:Math.max(u,t)}};this.pointOnPath=function(x,y){if(x===0&&!y){return{x:o,y:u}}else{if(x==1&&!y){return{x:l,y:t}}else{var m=y?x>0?x:p+x:x*p;return c.pointOnLine({x:o,y:u},{x:l,y:t},m)}}};this.gradientAtPoint=function(m){return q};this.pointAlongPathFrom=function(m,A,z){var y=this.pointOnPath(m,z),x=A<=0?{x:o,y:u}:{x:l,y:t};if(A<=0&&Math.abs(A)>1){A*=-1}return c.pointOnLine(y,x,A)};var s=function(x,m,y){return y>=Math.min(x,m)&&y<=Math.max(x,m)};var n=function(x,m,y){return Math.abs(y-x)<Math.abs(y-m)?x:m};this.findClosestPointOnPath=function(z,F){var B={d:Infinity,x:null,y:null,l:null,x1:o,x2:l,y1:u,y2:t};if(q===0){B.y=u;B.x=s(o,l,z)?z:n(o,l,z)}else{if(q==Infinity||q==-Infinity){B.x=o;B.y=s(u,t,F)?F:n(u,t,F)}else{var m=u-(q*o),A=F-(w*z),C=(A-m)/(q-w),E=(q*C)+m;B.x=s(o,l,C)?C:n(o,l,C);B.y=s(u,t,E)?E:n(u,t,E)}}var D=c.lineLength([B.x,B.y],[o,u]);B.d=c.lineLength([z,F],[B.x,B.y]);B.l=D/p;return B}},Arc:function(o){var u=i.Segments.AbstractSegment.apply(this,arguments),q=function(w,v){return c.theta([o.cx,o.cy],[w,v])},k=function(A,w){if(A.anticlockwise){var v=A.startAngle<A.endAngle?A.startAngle+n:A.startAngle,z=Math.abs(v-A.endAngle);return v-(z*w)}else{var y=A.endAngle<A.startAngle?A.endAngle+n:A.endAngle,x=Math.abs(y-A.startAngle);return A.startAngle+(x*w)}},n=2*Math.PI;this.radius=o.r;this.anticlockwise=o.ac;this.type="Arc";if(o.startAngle&&o.endAngle){this.startAngle=o.startAngle;this.endAngle=o.endAngle;this.x1=o.cx+(this.radius*Math.cos(o.startAngle));this.y1=o.cy+(this.radius*Math.sin(o.startAngle));this.x2=o.cx+(this.radius*Math.cos(o.endAngle));this.y2=o.cy+(this.radius*Math.sin(o.endAngle))}else{this.startAngle=q(o.x1,o.y1);this.endAngle=q(o.x2,o.y2);this.x1=o.x1;this.y1=o.y1;this.x2=o.x2;this.y2=o.y2}if(this.endAngle<0){this.endAngle+=n}if(this.startAngle<0){this.startAngle+=n}var r=this.endAngle<this.startAngle?this.endAngle+n:this.endAngle;this.sweep=Math.abs(r-this.startAngle);if(this.anticlockwise){this.sweep=n-this.sweep}var t=2*Math.PI*this.radius,l=this.sweep/n,m=t*l;this.getLength=function(){return m};this.getBounds=function(){return{minX:o.cx-o.r,maxX:o.cx+o.r,minY:o.cy-o.r,maxY:o.cy+o.r}};var p=1e-10,s=function(x){var w=Math.floor(x),v=Math.ceil(x);if(x-w<p){return w}else{if(v-x<p){return v}}return x};this.pointOnPath=function(v,z){if(v===0){return{x:this.x1,y:this.y1,theta:this.startAngle}}else{if(v==1){return{x:this.x2,y:this.y2,theta:this.endAngle}}}if(z){v=v/m}var y=k(this,v),x=o.cx+(o.r*Math.cos(y)),w=o.cy+(o.r*Math.sin(y));return{x:s(x),y:s(w),theta:y}};this.gradientAtPoint=function(w,y){var x=this.pointOnPath(w,y);var v=c.normal([o.cx,o.cy],[x.x,x.y]);if(!this.anticlockwise&&(v==Infinity||v==-Infinity)){v*=-1}return v};this.pointAlongPathFrom=function(D,v,C){var x=this.pointOnPath(D,C),w=v/t*2*Math.PI,y=this.anticlockwise?-1:1,B=x.theta+(y*w),A=o.cx+(this.radius*Math.cos(B)),z=o.cy+(this.radius*Math.sin(B));return{x:A,y:z}}},Bezier:function(m){this.curve=[{x:m.x1,y:m.y1},{x:m.cp1x,y:m.cp1y},{x:m.cp2x,y:m.cp2y},{x:m.x2,y:m.y2}];var k=i.Segments.AbstractSegment.apply(this,arguments);this.bounds={minX:Math.min(m.x1,m.x2,m.cp1x,m.cp2x),minY:Math.min(m.y1,m.y2,m.cp1y,m.cp2y),maxX:Math.max(m.x1,m.x2,m.cp1x,m.cp2x),maxY:Math.max(m.y1,m.y2,m.cp1y,m.cp2y)};this.type="Bezier";var l=function(o,n,p){if(p){n=g.jsBezier.locationAlongCurveFrom(o,n>0?0:1,n)}return n};this.pointOnPath=function(n,o){n=l(this.curve,n,o);return g.jsBezier.pointOnCurve(this.curve,n)};this.gradientAtPoint=function(n,o){n=l(this.curve,n,o);return g.jsBezier.gradientAtPoint(this.curve,n)};this.pointAlongPathFrom=function(n,p,o){n=l(this.curve,n,o);return g.jsBezier.pointAlongCurveFrom(this.curve,n,p)};this.getLength=function(){return g.jsBezier.getLength(this.curve)};this.getBounds=function(){return this.bounds}}};i.SegmentRenderer={getPath:function(k){return({Straight:function(){var l=k.getCoordinates();return"M "+l.x1+" "+l.y1+" L "+l.x2+" "+l.y2},Bezier:function(){var l=k.params;return"M "+l.x1+" "+l.y1+" C "+l.cp1x+" "+l.cp1y+" "+l.cp2x+" "+l.cp2y+" "+l.x2+" "+l.y2},Arc:function(){var n=k.params,l=k.sweep>Math.PI?1:0,m=k.anticlockwise?0:1;return"M"+k.x1+" "+k.y1+" A "+k.radius+" "+n.r+" 0 "+l+","+m+" "+k.x2+" "+k.y2}})[k.type]()}};var b=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};this.resetBounds()};i.Connectors.AbstractConnector=function(G){b.apply(this,arguments);var D=[],w=0,n=[],z=[],k=G.stub||0,q=f.isArray(k)?k[0]:k,y=f.isArray(k)?k[1]:k,B=G.gap||0,r=f.isArray(B)?B[0]:B,v=f.isArray(B)?B[1]:B,u=null,o=false,p=null,s=null,E=G.editable!==false&&i.ConnectorEditors!=null&&i.ConnectorEditors[this.type]!=null;var t=this.setGeometry=function(I,J){o=(!J);s=I};var l=this.getGeometry=function(){return s};this.getPathData=function(){var J="";for(var I=0;I<D.length;I++){J+=i.SegmentRenderer.getPath(D[I]);J+=" "}return J};this.hasBeenEdited=function(){return o};this.isEditing=function(){return this.editor!=null&&this.editor.isActive()};this.setEditable=function(I){if(I&&i.ConnectorEditors!=null&&i.ConnectorEditors[this.type]!=null&&(this.overrideSetEditable==null||this.overrideSetEditable())){E=I}else{E=false}return E};this.isEditable=function(){return E};this.findSegmentForPoint=function(I,M){var J={d:Infinity,s:null,x:null,y:null,l:null};for(var K=0;K<D.length;K++){var L=D[K].findClosestPointOnPath(I,M);if(L.d<J.d){J.d=L.d;J.l=L.l;J.x=L.x;J.y=L.y;J.s=D[K];J.x1=L.x1;J.x2=L.x2;J.y1=L.y1;J.y2=L.y2;J.index=K}}return J};var F=function(){var K=0;for(var J=0;J<D.length;J++){var I=D[J].getLength();z[J]=I/w;n[J]=[K,(K+=(I/w))]}},m=function(K,M){if(M){K=K>0?K/w:(w+K)/w}var I=n.length-1,J=1;for(var L=0;L<n.length;L++){if(n[L][1]>=K){I=L;J=K==1?1:K===0?0:(K-n[L][0])/z[L];break}}return{segment:D[I],proportion:J,index:I}},C=function(K,J,L){if(L.x1==L.x2&&L.y1==L.y2){return}var I=new i.Segments[J](L);D.push(I);w+=I.getLength();K.updateBounds(I)},H=function(){w=D.length=n.length=z.length=0};this.setSegments=function(J){u=[];w=0;for(var I=0;I<J.length;I++){u.push(J[I]);w+=J[I].getLength()}};this.getLength=function(){return w};var x=function(Y){this.strokeWidth=Y.strokeWidth;var I=c.quadrant(Y.sourcePos,Y.targetPos),U=Y.targetPos[0]<Y.sourcePos[0],S=Y.targetPos[1]<Y.sourcePos[1],L=Y.strokeWidth||1,X=Y.sourceEndpoint.anchor.getOrientation(Y.sourceEndpoint),J=Y.targetEndpoint.anchor.getOrientation(Y.targetEndpoint),O=U?Y.targetPos[0]:Y.sourcePos[0],N=S?Y.targetPos[1]:Y.sourcePos[1],Q=Math.abs(Y.targetPos[0]-Y.sourcePos[0]),W=Math.abs(Y.targetPos[1]-Y.sourcePos[1]);if(X[0]===0&&X[1]===0||J[0]===0&&J[1]===0){var M=Q>W?0:1,K=[1,0][M];X=[];J=[];X[M]=Y.sourcePos[M]>Y.targetPos[M]?-1:1;J[M]=Y.sourcePos[M]>Y.targetPos[M]?1:-1;X[K]=0;J[K]=0}var T=U?Q+(r*X[0]):r*X[0],R=S?W+(r*X[1]):r*X[1],aa=U?v*J[0]:Q+(v*J[0]),Z=S?v*J[1]:W+(v*J[1]),V=((X[0]*J[0])+(X[1]*J[1]));var P={sx:T,sy:R,tx:aa,ty:Z,lw:L,xSpan:Math.abs(aa-T),ySpan:Math.abs(Z-R),mx:(T+aa)/2,my:(R+Z)/2,so:X,to:J,x:O,y:N,w:Q,h:W,segment:I,startStubX:T+(X[0]*q),startStubY:R+(X[1]*q),endStubX:aa+(J[0]*y),endStubY:Z+(J[1]*y),isXGreaterThanStubTimes2:Math.abs(T-aa)>(q+y),isYGreaterThanStubTimes2:Math.abs(R-Z)>(q+y),opposite:V==-1,perpendicular:V===0,orthogonal:V==1,sourceAxis:X[0]===0?"y":"x",points:[O,N,Q,W,T,R,aa,Z]};P.anchorOrientation=P.opposite?"opposite":P.orthogonal?"orthogonal":"perpendicular";return P};this.getSegments=function(){return D};this.updateBounds=function(J){var I=J.getBounds();this.bounds.minX=Math.min(this.bounds.minX,I.minX);this.bounds.maxX=Math.max(this.bounds.maxX,I.maxX);this.bounds.minY=Math.min(this.bounds.minY,I.minY);this.bounds.maxY=Math.max(this.bounds.maxY,I.maxY)};var A=function(){console.log("SEGMENTS:");for(var I=0;I<D.length;I++){console.log(D[I].type,D[I].getLength(),n[I])}};this.pointOnPath=function(J,K){var I=m(J,K);return I.segment&&I.segment.pointOnPath(I.proportion,false)||[0,0]};this.gradientAtPoint=function(J,K){var I=m(J,K);return I.segment&&I.segment.gradientAtPoint(I.proportion,false)||0};this.pointAlongPathFrom=function(J,L,K){var I=m(J,K);return I.segment&&I.segment.pointAlongPathFrom(I.proportion,L,false)||[0,0]};this.compute=function(I){p=x.call(this,I);H();this._compute(p,I);this.x=p.points[0];this.y=p.points[1];this.w=p.points[2];this.h=p.points[3];this.segment=p.segment;F()};return{addSegment:C,prepareCompute:x,sourceStub:q,targetStub:y,maxStub:Math.max(q,y),sourceGap:r,targetGap:v,maxGap:Math.max(r,v),setGeometry:t,getGeometry:l}};f.extend(i.Connectors.AbstractConnector,b);i.Endpoints.AbstractEndpoint=function(l){b.apply(this,arguments);var k=this.compute=function(p,m,q,o){var n=this._compute.apply(this,arguments);this.x=n[0];this.y=n[1];this.w=n[2];this.h=n[3];this.bounds.minX=this.x;this.bounds.minY=this.y;this.bounds.maxX=this.x+this.w;this.bounds.maxY=this.y+this.h;return n};return{compute:k,cssClass:l.cssClass}};f.extend(i.Endpoints.AbstractEndpoint,b);i.Endpoints.Dot=function(l){this.type="Dot";var k=i.Endpoints.AbstractEndpoint.apply(this,arguments);l=l||{};this.radius=l.radius||10;this.defaultOffset=0.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(t,m,n,p){this.radius=n.radius||this.radius;var s=t[0]-this.radius,r=t[1]-this.radius,u=this.radius*2,q=this.radius*2;if(n.stroke){var o=n.strokeWidth||1;s-=o;r-=o;u+=(o*2);q+=(o*2)}return[s,r,u,q,this.radius]}};f.extend(i.Endpoints.Dot,i.Endpoints.AbstractEndpoint);i.Endpoints.Rectangle=function(l){this.type="Rectangle";var k=i.Endpoints.AbstractEndpoint.apply(this,arguments);l=l||{};this.width=l.width||20;this.height=l.height||20;this._compute=function(r,o,t,q){var p=t.width||this.width,n=t.height||this.height,m=r[0]-(p/2),s=r[1]-(n/2);return[m,s,p,n]}};f.extend(i.Endpoints.Rectangle,i.Endpoints.AbstractEndpoint);var a=function(k){i.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};f.extend(a,i.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(k){this._jsPlumb.displayElements.push(k)}});i.Endpoints.Image=function(n){this.type="Image";a.apply(this,arguments);i.Endpoints.AbstractEndpoint.apply(this,arguments);var k=n.onload,m=n.src||n.url,l=n.cssClass?" "+n.cssClass:"";this._jsPlumb.img=new Image();this._jsPlumb.ready=false;this._jsPlumb.initialized=false;this._jsPlumb.deleted=false;this._jsPlumb.widthToUse=n.width;this._jsPlumb.heightToUse=n.height;this._jsPlumb.endpoint=n.endpoint;this._jsPlumb.img.onload=function(){if(this._jsPlumb!=null){this._jsPlumb.ready=true;this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width;this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height;if(k){k(this)}}}.bind(this);this._jsPlumb.endpoint.setImage=function(o,q){var p=o.constructor==String?o:o.src;k=q;this._jsPlumb.img.src=p;if(this.canvas!=null){this.canvas.setAttribute("src",this._jsPlumb.img.src)}}.bind(this);this._jsPlumb.endpoint.setImage(m,k);this._compute=function(q,o,r,p){this.anchorPoint=q;if(this._jsPlumb.ready){return[q[0]-this._jsPlumb.widthToUse/2,q[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]}else{return[0,0,0,0]}};this.canvas=i.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+l);if(this._jsPlumb.widthToUse){this.canvas.setAttribute("width",this._jsPlumb.widthToUse)}if(this._jsPlumb.heightToUse){this.canvas.setAttribute("height",this._jsPlumb.heightToUse)}this._jsPlumb.instance.appendElement(this.canvas);this.actuallyPaint=function(r,q,p){if(!this._jsPlumb.deleted){if(!this._jsPlumb.initialized){this.canvas.setAttribute("src",this._jsPlumb.img.src);this.appendDisplayElement(this.canvas);this._jsPlumb.initialized=true}var o=this.anchorPoint[0]-(this._jsPlumb.widthToUse/2),s=this.anchorPoint[1]-(this._jsPlumb.heightToUse/2);f.sizeElement(this.canvas,o,s,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(p,o){if(this._jsPlumb!=null){if(this._jsPlumb.ready){this.actuallyPaint(p,o)}else{g.setTimeout(function(){this.paint(p,o)}.bind(this),200)}}}};f.extend(i.Endpoints.Image,[a,i.Endpoints.AbstractEndpoint],{cleanup:function(k){if(k){this._jsPlumb.deleted=true;if(this.canvas){this.canvas.parentNode.removeChild(this.canvas)}this.canvas=null}}});i.Endpoints.Blank=function(m){var l=i.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank";a.apply(this,arguments);this._compute=function(p,n,q,o){return[p[0],p[1],10,0]};var k=m.cssClass?" "+m.cssClass:"";this.canvas=i.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+k);this._jsPlumb.instance.appendElement(this.canvas);this.paint=function(o,n){f.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};f.extend(i.Endpoints.Blank,[i.Endpoints.AbstractEndpoint,a],{cleanup:function(){if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}}});i.Endpoints.Triangle=function(k){this.type="Triangle";i.Endpoints.AbstractEndpoint.apply(this,arguments);k=k||{};k.width=k.width||55;k.height=k.height||55;this.width=k.width;this.height=k.height;this._compute=function(q,n,s,p){var o=s.width||self.width,m=s.height||self.height,l=q[0]-(o/2),r=q[1]-(m/2);return[l,r,o,m]}};var d=i.Overlays.AbstractOverlay=function(k){this.visible=true;this.isAppendedAtTopLevel=true;this.component=k.component;this.loc=k.location==null?0.5:k.location;this.endpointLoc=k.endpointLocation==null?[0.5,0.5]:k.endpointLocation;this.visible=k.visible!==false};d.prototype={cleanup:function(k){if(k){this.component=null;this.canvas=null;this.endpointLoc=null}},reattach:function(k){},setVisible:function(k){this.visible=k;this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(false)},show:function(){this.setVisible(true)},incrementLocation:function(k){this.loc+=k;this.component.repaint()},setLocation:function(k){this.loc=k;this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}};i.Overlays.Arrow=function(n){this.type="Arrow";d.apply(this,arguments);this.isAppendedAtTopLevel=false;n=n||{};this.length=n.length||20;this.width=n.width||20;this.id=n.id;var m=(n.direction||1)<0?-1:1,l=n.paintStyle||{"stroke-width":1},k=n.foldback||0.623;this.computeMaxSize=function(){return self.width*1.5};this.elementCreated=function(r,o){this.path=r;if(n.events){for(var q in n.events){i.on(r,q,n.events[q])}}};this.draw=function(v,C){var s,y,o,t,r;if(v.pointAlongPathFrom){if(f.isString(this.loc)||this.loc>1||this.loc<0){var p=parseInt(this.loc,10),w=this.loc<0?1:0;s=v.pointAlongPathFrom(w,p,false);y=v.pointAlongPathFrom(w,p-(m*this.length/2),false);o=c.pointOnLine(s,y,this.length)}else{if(this.loc==1){s=v.pointOnPath(this.loc);y=v.pointAlongPathFrom(this.loc,-(this.length));o=c.pointOnLine(s,y,this.length);if(m==-1){var z=o;o=s;s=z}}else{if(this.loc===0){o=v.pointOnPath(this.loc);y=v.pointAlongPathFrom(this.loc,this.length);s=c.pointOnLine(o,y,this.length);if(m==-1){var x=o;o=s;s=x}}else{s=v.pointAlongPathFrom(this.loc,m*this.length/2);y=v.pointOnPath(this.loc);o=c.pointOnLine(s,y,this.length)}}}t=c.perpendicularLineTo(s,o,this.width);r=c.pointOnLine(s,o,k*this.length);var u={hxy:s,tail:t,cxy:r},B=l.stroke||C.stroke,A=l.fill||C.stroke,q=l.strokeWidth||C.strokeWidth;return{component:v,d:u,"stroke-width":q,stroke:B,fill:A,minX:Math.min(s.x,t[0].x,t[1].x),maxX:Math.max(s.x,t[0].x,t[1].x),minY:Math.min(s.y,t[0].y,t[1].y),maxY:Math.max(s.y,t[0].y,t[1].y)}}else{return{component:v,minX:0,maxX:0,minY:0,maxY:0}}}};f.extend(i.Overlays.Arrow,d,{updateFrom:function(k){this.length=k.length||this.length;this.width=k.width||this.width;this.direction=k.direction!=null?k.direction:this.direction;this.foldback=k.foldback||this.foldback}});i.Overlays.PlainArrow=function(l){l=l||{};var k=i.extend(l,{foldback:1});i.Overlays.Arrow.call(this,k);this.type="PlainArrow"};f.extend(i.Overlays.PlainArrow,i.Overlays.Arrow);i.Overlays.Diamond=function(n){n=n||{};var k=n.length||40,m=i.extend(n,{length:k/2,foldback:2});i.Overlays.Arrow.call(this,m);this.type="Diamond"};f.extend(i.Overlays.Diamond,i.Overlays.Arrow);var h=function(k,l){if(k._jsPlumb.cachedDimensions==null||l){k._jsPlumb.cachedDimensions=k.getDimensions()}return k._jsPlumb.cachedDimensions};var e=function(k){i.jsPlumbUIComponent.apply(this,arguments);d.apply(this,arguments);var l=this.fire;this.fire=function(){l.apply(this,arguments);if(this.component){this.component.fire.apply(this.component,arguments)}};this.detached=false;this.id=k.id;this._jsPlumb.div=null;this._jsPlumb.initialised=false;this._jsPlumb.component=k.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=k.create;this._jsPlumb.initiallyInvisible=k.visible===false;this.getElement=function(){if(this._jsPlumb.div==null){var n=this._jsPlumb.div=i.getElement(this._jsPlumb.create(this._jsPlumb.component));n.style.position="absolute";n.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:k.cssClass?k.cssClass:"");this._jsPlumb.instance.appendElement(n);this._jsPlumb.instance.getId(n);this.canvas=n;var m="translate(-50%, -50%)";n.style.webkitTransform=m;n.style.mozTransform=m;n.style.msTransform=m;n.style.oTransform=m;n.style.transform=m;n._jsPlumb=this;if(k.visible===false){n.style.display="none"}}return this._jsPlumb.div};this.draw=function(q,v,m){var n=h(this);if(n!=null&&n.length==2){var o={x:0,y:0};if(m){o={x:m[0],y:m[1]}}else{if(q.pointOnPath){var p=this.loc,r=false;if(f.isString(this.loc)||this.loc<0||this.loc>1){p=parseInt(this.loc,10);r=true}o=q.pointOnPath(p,r)}else{var u=this.loc.constructor==Array?this.loc:this.endpointLoc;o={x:u[0]*q.w,y:u[1]*q.h}}}var t=o.x-(n[0]/2),s=o.y-(n[1]/2);return{component:q,d:{minx:t,miny:s,td:n,cxy:o},minX:t,maxX:t+n[0],minY:s,maxY:s+n[1]}}else{return{minX:0,maxX:0,minY:0,maxY:0}}}};f.extend(e,[i.jsPlumbUIComponent,d],{getDimensions:function(){return[1,1]},setVisible:function(k){if(this._jsPlumb.div){this._jsPlumb.div.style.display=k?"block":"none";if(k&&this._jsPlumb.initiallyInvisible){h(this,true);this.component.repaint();this._jsPlumb.initiallyInvisible=false}}},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(k){if(k){if(this._jsPlumb.div!=null){this._jsPlumb.div._jsPlumb=null;this._jsPlumb.instance.removeElement(this._jsPlumb.div)}}else{if(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode){this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)}this.detached=true}},reattach:function(k){if(this._jsPlumb.div!=null){k.getContainer().appendChild(this._jsPlumb.div)}this.detached=false},computeMaxSize:function(){var k=h(this);return Math.max(k[0],k[1])},paint:function(l,k){if(!this._jsPlumb.initialised){this.getElement();l.component.appendDisplayElement(this._jsPlumb.div);this._jsPlumb.initialised=true;if(this.detached){this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)}}this._jsPlumb.div.style.left=(l.component.x+l.d.minx)+"px";this._jsPlumb.div.style.top=(l.component.y+l.d.miny)+"px"}});i.Overlays.Custom=function(k){this.type="Custom";e.apply(this,arguments)};f.extend(i.Overlays.Custom,e);i.Overlays.GuideLines=function(){var k=this;k.length=50;k.strokeWidth=5;this.type="GuideLines";d.apply(this,arguments);i.jsPlumbUIComponent.apply(this,arguments);this.draw=function(m,r){var q=m.pointAlongPathFrom(k.loc,k.length/2),p=m.pointOnPath(k.loc),o=c.pointOnLine(q,p,k.length),n=c.perpendicularLineTo(q,o,40),l=c.perpendicularLineTo(o,q,20);return{connector:m,head:q,tail:o,headLine:l,tailLine:n,minX:Math.min(q.x,o.x,l[0].x,l[1].x),minY:Math.min(q.y,o.y,l[0].y,l[1].y),maxX:Math.max(q.x,o.x,l[0].x,l[1].x),maxY:Math.max(q.y,o.y,l[0].y,l[1].y)}}};i.Overlays.Label=function(s){this.labelStyle=s.labelStyle;var k=null,r=null,n=null,o=null;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var q=i.extend({create:function(){return i.createElement("div")}},s);i.Overlays.Custom.call(this,q);this.type="Label";this.label=s.label||"";this.labelText=null;if(this.labelStyle){var m=this.getElement();this.labelStyle.font=this.labelStyle.font||"12px sans-serif";m.style.font=this.labelStyle.font;m.style.color=this.labelStyle.color||"black";if(this.labelStyle.fill){m.style.background=this.labelStyle.fill}if(this.labelStyle.borderWidth>0){var l=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";m.style.border=this.labelStyle.borderWidth+"px solid "+l}if(this.labelStyle.padding){m.style.padding=this.labelStyle.padding}}};f.extend(i.Overlays.Label,i.Overlays.Custom,{cleanup:function(k){if(k){this.div=null;this.label=null;this.labelText=null;this.cssClass=null;this.labelStyle=null}},getLabel:function(){return this.label},setLabel:function(k){this.label=k;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){this.update();return e.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var k=this.label(this);this.getElement().innerHTML=k.replace(/\r\n/g,"<br/>")}else{if(this.labelText==null){this.labelText=this.label;this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>")}}},updateFrom:function(k){if(k.label!=null){this.setLabel(k.label)}}})}).call(typeof window!=="undefined"?window:this);(function(){var a=this,c=a.jsPlumb;var b=function(d){var f=d._mottle;if(!f){f=d._mottle=new a.Mottle()}return f};c.extend(a.jsPlumbInstance.prototype,{getEventManager:function(){return b(this)},on:function(d,e,f){this.getEventManager().on.apply(this,arguments);return this},off:function(d,e,f){this.getEventManager().off.apply(this,arguments);return this}})}).call(typeof window!=="undefined"?window:this);(function(){var m=this,c=m.jsPlumbUtil,l=m.jsPlumbInstance;var f="jtk-group-collapsed";var h="jtk-group-expanded";var k="[jtk-group-content]";var q="elementDraggable";var a="stop";var g="revert";var b="_groupManager";var t="_jsPlumbGroup";var n="_jsPlumbGroupDrag";var d="group:addMember";var r="group:removeMember";var o="group:add";var p="group:remove";var u="group:expand";var s="group:collapse";var e=function(D){var C={},z={},y={},E=this;D.bind("connection",function(F){if(F.source[t]!=null&&F.target[t]!=null&&F.source[t]===F.target[t]){z[F.connection.id]=F.source[t];y[F.connection.id]=F.source[t]}else{if(F.source[t]!=null){c.suggest(F.source[t].connections.source,F.connection);z[F.connection.id]=F.source[t]}if(F.target[t]!=null){c.suggest(F.target[t].connections.target,F.connection);y[F.connection.id]=F.target[t]}}});function w(F){delete F.proxies;var H=z[F.id],G;if(H!=null){G=function(I){return I.id===F.id};c.removeWithFunction(H.connections.source,G);c.removeWithFunction(H.connections.target,G);delete z[F.id]}H=y[F.id];if(H!=null){G=function(I){return I.id===F.id};c.removeWithFunction(H.connections.source,G);c.removeWithFunction(H.connections.target,G);delete y[F.id]}}D.bind("internal.connectionDetached",function(F){w(F.connection)});D.bind("connectionMoved",function(I){var J=I.index===0?z:y;var H=J[I.connection.id];if(H){var G=H.connections[I.index===0?"source":"target"];var F=G.indexOf(I.connection);if(F!=-1){G.splice(F,1)}}});this.addGroup=function(F){D.addClass(F.getEl(),h);C[F.id]=F;F.manager=this;B(F);D.fire(o,{group:F})};this.addToGroup=function(M,G,F){M=this.getGroup(M);if(M){var J=M.getEl();if(G._isJsPlumbGroup){return}var O=G._jsPlumbGroup;if(O!==M){var L=D.getOffset(G,true);var N=M.collapsed?D.getOffset(J,true):D.getOffset(M.getDragArea(),true);if(O!=null){O.remove(G,F);E.updateConnectionsForGroup(O)}M.add(G,F);var K=function(Q,P){var R=P==0?1:0;Q.each(function(S){S.setVisible(false);if(S.endpoints[R].element._jsPlumbGroup===M){S.endpoints[R].setVisible(false);E.expandConnection(S,R,M)}else{S.endpoints[P].setVisible(false);E.collapseConnection(S,P,M)}})};if(M.collapsed){K(D.select({source:G}),0);K(D.select({target:G}),1)}var I=D.getId(G);D.dragManager.setParent(G,I,J,D.getId(J),L);var H={left:L.left-N.left,top:L.top-N.top};D.setPosition(G,H);D.dragManager.revalidateParent(G,I,L);E.updateConnectionsForGroup(M);setTimeout(function(){D.fire(d,{group:M,el:G})},0)}}};this.removeFromGroup=function(H,G,F){H=this.getGroup(H);if(H){H.remove(G,null,F)}};this.getGroup=function(F){var G=F;if(c.isString(F)){G=C[F];if(G==null){throw new TypeError("No such group ["+F+"]")}}return G};this.getGroups=function(){var G=[];for(var F in C){G.push(C[F])}return G};this.removeGroup=function(I,H,F,G){I=this.getGroup(I);this.expandGroup(I,true);I[H?"removeAll":"orphanAll"](F,G);D.remove(I.getEl());delete C[I.id];delete D._groups[I.id];D.fire(p,{group:I})};this.removeAllGroups=function(H,F,G){for(var I in C){this.removeGroup(C[I],H,F,G)}};function x(I,H){var F=I.getMembers();for(var G=0;G<F.length;G++){D[H?"show":"hide"](F[G],true)}}var A=this.collapseConnection=function(M,F,J){var I,L=J.getEl(),K=D.getId(L),G=M.endpoints[F].elementId;var H=M.endpoints[F===0?1:0].element;if(H[t]&&(!H[t].shouldProxy()&&H[t].collapsed)){return}M.proxies=M.proxies||[];if(M.proxies[F]){I=M.proxies[F].ep}else{I=D.addEndpoint(L,{endpoint:J.getEndpoint(M,F),anchor:J.getAnchor(M,F),parameters:{isProxyEndpoint:true}});I._forceDeleteOnDetach=true}M.proxies[F]={ep:I,originalEp:M.endpoints[F]};if(F===0){D.anchorManager.sourceChanged(G,K,M,L)}else{D.anchorManager.updateOtherEndpoint(M.endpoints[0].elementId,G,K,M);M.target=L;M.targetId=K}M.proxies[F].originalEp.detachFromConnection(M,null,true);I.connections=[M];M.endpoints[F]=I;M.setVisible(true)};this.collapseGroup=function(G){G=this.getGroup(G);if(G==null||G.collapsed){return}var H=G.getEl();x(G,false);if(G.shouldProxy()){var F=function(I,J){for(var K=0;K<I.length;K++){var L=I[K];A(L,J,G)}};F(G.connections.source,0);F(G.connections.target,1)}G.collapsed=true;D.removeClass(H,h);D.addClass(H,f);D.revalidate(H);D.fire(s,{group:G})};var v=this.expandConnection=function(K,G,I){if(K.proxies==null||K.proxies[G]==null){return}var J=D.getId(I.getEl()),F=K.proxies[G].originalEp.element,H=K.proxies[G].originalEp.elementId;K.endpoints[G]=K.proxies[G].originalEp;if(G===0){D.anchorManager.sourceChanged(J,H,K,F)}else{D.anchorManager.updateOtherEndpoint(K.endpoints[0].elementId,J,H,K);K.target=F;K.targetId=H}K.proxies[G].ep.detachFromConnection(K,null,true);K.proxies[G].originalEp.addConnection(K);delete K.proxies[G]};this.expandGroup=function(H,G){H=this.getGroup(H);if(H==null||!H.collapsed){return}var I=H.getEl();x(H,true);if(H.shouldProxy()){var F=function(J,K){for(var L=0;L<J.length;L++){var M=J[L];v(M,K,H)}};F(H.connections.source,0);F(H.connections.target,1)}H.collapsed=false;D.addClass(I,h);D.removeClass(I,f);D.revalidate(I);this.repaintGroup(H);if(!G){D.fire(u,{group:H})}};this.repaintGroup=function(H){H=this.getGroup(H);var F=H.getMembers();for(var G=0;G<F.length;G++){D.revalidate(F[G])}};function B(J){var G=J.getMembers();var I=D.getConnections({source:G},true);var H=D.getConnections({target:G},true);var K={};J.connections.source.length=0;J.connections.target.length=0;var F=function(M){for(var L=0;L<M.length;L++){if(K[M[L].id]){continue}K[M[L].id]=true;if(M[L].source._jsPlumbGroup===J){if(M[L].target._jsPlumbGroup!==J){J.connections.source.push(M[L])}z[M[L].id]=J}else{if(M[L].target._jsPlumbGroup===J){J.connections.target.push(M[L]);y[M[L].id]=J}}}};F(I);F(H)}this.updateConnectionsForGroup=B;this.refreshAllGroups=function(){for(var F in C){B(C[F]);D.dragManager.updateOffsets(D.getId(C[F].getEl()))}}};var i=function(O,N){var H=this;var v=N.el;this.getEl=function(){return v};this.id=N.id||c.uuid();v._isJsPlumbGroup=true;var Q=this.getDragArea=function(){var R=O.getSelector(v,k);return R&&R.length>0?R[0]:v};var y=N.ghost===true;var K=y||(N.constrain===true);var w=N.revert!==false;var M=N.orphan===true;var x=N.prune===true;var B=N.dropOverride===true;var E=N.proxied!==false;var F=[];this.connections={source:[],target:[],internal:[]};this.getAnchor=function(R,S){return N.anchor||"Continuous"};this.getEndpoint=function(R,S){return N.endpoint||["Dot",{radius:10}]};this.collapsed=false;if(N.draggable!==false){var G={stop:function(R){O.fire("groupDragStop",jsPlumb.extend(R,{group:H}))},scope:n};if(N.dragOptions){m.jsPlumb.extend(G,N.dragOptions)}O.draggable(N.el,G)}if(N.droppable!==false){O.droppable(N.el,{drop:function(T){var R=T.drag.el;if(R._isJsPlumbGroup){return}var S=R._jsPlumbGroup;if(S!==H){if(S!=null){if(S.overrideDrop(R,H)){return}}O.getGroupManager().addToGroup(H,R,false)}}})}var L=function(U,T){var S=U.nodeType==null?U:[U];for(var R=0;R<S.length;R++){T(S[R])}};this.overrideDrop=function(S,R){return B&&(w||x||M)};this.add=function(T,R){var S=Q();L(T,function(U){if(U._jsPlumbGroup!=null){if(U._jsPlumbGroup===H){return}else{U._jsPlumbGroup.remove(U,true,R,false)}}U._jsPlumbGroup=H;F.push(U);if(O.isAlreadyDraggable(U)){I(U)}if(U.parentNode!=S){S.appendChild(U)}if(!R){O.fire(d,{group:H,el:U})}});O.getGroupManager().updateConnectionsForGroup(H)};this.remove=function(U,S,T,R){L(U,function(V){delete V._jsPlumbGroup;c.removeWithFunction(F,function(X){return X===V});if(S){try{H.getDragArea().removeChild(V)}catch(W){jsPlumbUtil.log("Could not remove element from Group "+W)}}C(V);if(!T){O.fire(r,{group:H,el:V})}});if(!R){O.getGroupManager().updateConnectionsForGroup(H)}};this.removeAll=function(T,U){for(var S=0,R=F.length;S<R;S++){H.remove(F[0],T,U,true)}F.length=0;O.getGroupManager().updateConnectionsForGroup(H)};this.orphanAll=function(){for(var R=0;R<F.length;R++){z(F[R])}F.length=0};this.getMembers=function(){return F};v[t]=this;O.bind(q,function(R){if(R.el._jsPlumbGroup==this){I(R.el)}}.bind(this));function P(R){return R.offsetParent}function A(X,U){var S=P(X),Y=O.getSize(S),Z=O.getSize(X),R=U[0],V=R+Z[0],W=U[1],T=W+Z[1];return V>0&&R<Y[0]&&T>0&&W<Y[1]}function z(T){var S=O.getId(T);var R=O.getOffset(T);T.parentNode.removeChild(T);O.getContainer().appendChild(T);O.setPosition(T,R);delete T._jsPlumbGroup;C(T);O.dragManager.clearParent(T,S)}function D(R){if(!A(R.el,R.pos)){R.el._jsPlumbGroup.remove(R.el);if(x){O.remove(R.el)}else{z(R.el)}}}function J(S){var R=O.getId(S);O.revalidate(S);O.dragManager.revalidateParent(S,R)}function C(R){if(!R._katavorioDrag){return}if(x||M){R._katavorioDrag.off(a,D)}if(!x&&!M&&w){R._katavorioDrag.off(g,J);R._katavorioDrag.setRevert(null)}}function I(R){if(!R._katavorioDrag){return}if(x||M){R._katavorioDrag.on(a,D)}if(K){R._katavorioDrag.setConstrain(true)}if(y){R._katavorioDrag.setUseGhostProxy(true)}if(!x&&!M&&w){R._katavorioDrag.on(g,J);R._katavorioDrag.setRevert(function(S,T){return !A(S,T)})}}this.shouldProxy=function(){return E};O.getGroupManager().addGroup(this)};l.prototype.addGroup=function(x){var v=this;v._groups=v._groups||{};if(v._groups[x.id]!=null){throw new TypeError("cannot create Group ["+x.id+"]; a Group with that ID exists")}if(x.el[t]!=null){throw new TypeError("cannot create Group ["+x.id+"]; the given element is already a Group")}var w=new i(v,x);v._groups[w.id]=w;return w};l.prototype.addToGroup=function(x,w,v){var y=this.getId(w);this.manage(y,w);this.getGroupManager().addToGroup(x,w,v)};l.prototype.removeFromGroup=function(x,w,v){this.getGroupManager().removeFromGroup(x,w,v)};l.prototype.removeGroup=function(y,x,v,w){this.getGroupManager().removeGroup(y,x,v,w)};l.prototype.removeAllGroups=function(x,v,w){this.getGroupManager().removeAllGroups(x,v,w)};l.prototype.getGroup=function(v){return this.getGroupManager().getGroup(v)};l.prototype.getGroups=function(){return this.getGroupManager().getGroups()};l.prototype.expandGroup=function(v){this.getGroupManager().expandGroup(v)};l.prototype.collapseGroup=function(v){this.getGroupManager().collapseGroup(v)};l.prototype.repaintGroup=function(v){this.getGroupManager().repaintGroup(v)};l.prototype.toggleGroup=function(v){v=this.getGroupManager().getGroup(v);if(v!=null){this.getGroupManager()[v.collapsed?"expandGroup":"collapseGroup"](v)}};l.prototype.getGroupManager=function(){var v=this[b];if(v==null){v=this[b]=new e(this)}return v};l.prototype.removeGroupManager=function(){delete this[b]};l.prototype.getGroupFor=function(v){v=this.getElement(v);if(v){return v[t]}}}).call(typeof window!=="undefined"?window:this);(function(){var b=this,d=b.jsPlumb,a=b.jsPlumbUtil;var c=function(g){this.type="Flowchart";g=g||{};g.stub=g.stub==null?30:g.stub;var l,t=d.Connectors.AbstractConnector.apply(this,arguments),u=g.midpoint==null?0.5:g.midpoint,i=g.alwaysRespectStubs===true,s=null,q=null,n,m=g.cornerRadius!=null?g.cornerRadius:0,e=g.loopbackRadius||25,k=false,h=function(v){return v<0?-1:v===0?0:1},f=function(B,D,C,A){if(s==D&&q==C){return}var z=s==null?A.sx:s,w=q==null?A.sy:q,v=z==D?"v":"h",F=h(D-z),E=h(C-w);s=D;q=C;B.push([z,w,D,C,v,F,E])},r=function(v){return Math.sqrt(Math.pow(v[0]-v[2],2)+Math.pow(v[1]-v[3],2))},p=function(v){var w=[];w.push.apply(w,v);return w},o=function(w,B,v){var D=null,A;for(var z=0;z<B.length-1;z++){D=D||p(B[z]);A=p(B[z+1]);if(m>0&&D[4]!=A[4]){var H=Math.min(m,r(D),r(A));D[2]-=D[5]*H;D[3]-=D[6]*H;A[0]+=A[5]*H;A[1]+=A[6]*H;var I=(D[6]==A[5]&&A[5]==1)||((D[6]==A[5]&&A[5]===0)&&D[5]!=A[6])||(D[6]==A[5]&&A[5]==-1),E=A[1]>D[3]?1:-1,F=A[0]>D[2]?1:-1,C=E==F,y=(C&&I||(!C&&!I))?A[0]:D[2],x=(C&&I||(!C&&!I))?D[3]:A[1];t.addSegment(w,"Straight",{x1:D[0],y1:D[1],x2:D[2],y2:D[3]});t.addSegment(w,"Arc",{r:H,x1:D[2],y1:D[3],x2:A[0],y2:A[1],cx:y,cy:x,ac:I})}else{var J=(D[2]==D[0])?0:(D[2]>D[0])?(v.lw/2):-(v.lw/2),G=(D[3]==D[1])?0:(D[3]>D[1])?(v.lw/2):-(v.lw/2);t.addSegment(w,"Straight",{x1:D[0]-J,y1:D[1]-G,x2:D[2]+J,y2:D[3]+G})}D=A}if(A!=null){t.addSegment(w,"Straight",{x1:A[0],y1:A[1],x2:A[2],y2:A[3]})}};this._compute=function(A,C){l=[];s=null;q=null;n=null;var w=function(){return[A.startStubX,A.startStubY,A.endStubX,A.endStubY]},J={perpendicular:w,orthogonal:w,opposite:function(O){var P=A,N=O=="x"?0:1,M={x:function(){return((P.so[N]==1&&(((P.startStubX>P.endStubX)&&(P.tx>P.startStubX))||((P.sx>P.endStubX)&&(P.tx>P.sx)))))||((P.so[N]==-1&&(((P.startStubX<P.endStubX)&&(P.tx<P.startStubX))||((P.sx<P.endStubX)&&(P.tx<P.sx)))))},y:function(){return((P.so[N]==1&&(((P.startStubY>P.endStubY)&&(P.ty>P.startStubY))||((P.sy>P.endStubY)&&(P.ty>P.sy)))))||((P.so[N]==-1&&(((P.startStubY<P.endStubY)&&(P.ty<P.startStubY))||((P.sy<P.endStubY)&&(P.ty<P.sy)))))}};if(!i&&M[O]()){return{x:[(A.sx+A.tx)/2,A.startStubY,(A.sx+A.tx)/2,A.endStubY],y:[A.startStubX,(A.sy+A.ty)/2,A.endStubX,(A.sy+A.ty)/2]}[O]}else{return[A.startStubX,A.startStubY,A.endStubX,A.endStubY]}}};var x=J[A.anchorOrientation](A.sourceAxis),G=A.sourceAxis=="x"?0:1,I=A.sourceAxis=="x"?1:0,L=x[G],z=x[I],H=x[G+2],K=x[I+2];f(l,x[0],x[1],A);if(false&&C.sourcePos[0]==C.targetPos[0]&&C.sourcePos[1]==C.targetPos[1]){f(l,x[0]-e,x[1],A);f(l,x[0]-e,x[1]-(2*e),A);f(l,x[0]+e,x[1]-(2*e),A);f(l,x[0]+e,x[1],A);f(l,x[0],x[1],A)}else{var D=A.startStubX+((A.endStubX-A.startStubX)*u),B=A.startStubY+((A.endStubY-A.startStubY)*u);var F={x:[0,1],y:[1,0]},v={perpendicular:function(N){var Q=A,R={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},M={x:[[Q.startStubX,Q.endStubX],null,[Q.endStubX,Q.startStubX]],y:[[Q.startStubY,Q.endStubY],null,[Q.endStubY,Q.startStubY]]},ab={x:[[D,Q.startStubY],[D,Q.endStubY]],y:[[Q.startStubX,B],[Q.endStubX,B]]},O={x:[[Q.endStubX,Q.startStubY]],y:[[Q.startStubX,Q.endStubY]]},U={x:[[Q.startStubX,Q.endStubY],[Q.endStubX,Q.endStubY]],y:[[Q.endStubX,Q.startStubY],[Q.endStubX,Q.endStubY]]},V={x:[[Q.startStubX,B],[Q.endStubX,B],[Q.endStubX,Q.endStubY]],y:[[D,Q.startStubY],[D,Q.endStubY],[Q.endStubX,Q.endStubY]]},T={x:[Q.startStubY,Q.endStubY],y:[Q.startStubX,Q.endStubX]},aa=F[N][0],X=F[N][1],W=Q.so[aa]+1,P=Q.to[X]+1,S=(Q.to[X]==-1&&(T[N][1]<T[N][0]))||(Q.to[X]==1&&(T[N][1]>T[N][0])),ac=M[N][W][0],Z=M[N][W][1],Y=R[N][W][P];if(Q.segment==Y[3]||(Q.segment==Y[2]&&S)){return ab[N]}else{if(Q.segment==Y[2]&&Z<ac){return O[N]}else{if((Q.segment==Y[2]&&Z>=ac)||(Q.segment==Y[1]&&!S)){return V[N]}else{if(Q.segment==Y[0]||(Q.segment==Y[1]&&S)){return U[N]}}}}},orthogonal:function(Q,P,R,N,M){var S=A,O={x:S.so[0]==-1?Math.min(P,N):Math.max(P,N),y:S.so[1]==-1?Math.min(P,N):Math.max(P,N)}[Q];return{x:[[O,R],[O,M],[N,M]],y:[[R,O],[M,O],[M,N]]}[Q]},opposite:function(O,U,N,T){var R=A,P={x:"y",y:"x"}[O],S={x:"height",y:"width"}[O],M=R["is"+O.toUpperCase()+"GreaterThanStubTimes2"];if(C.sourceEndpoint.elementId==C.targetEndpoint.elementId){var Q=N+((1-C.sourceEndpoint.anchor[P])*C.sourceInfo[S])+t.maxStub;return{x:[[U,Q],[T,Q]],y:[[Q,U],[Q,T]]}[O]}else{if(!M||(R.so[G]==1&&U>T)||(R.so[G]==-1&&U<T)){return{x:[[U,B],[T,B]],y:[[D,U],[D,T]]}[O]}else{if((R.so[G]==1&&U<T)||(R.so[G]==-1&&U>T)){return{x:[[D,R.sy],[D,R.ty]],y:[[R.sx,B],[R.tx,B]]}[O]}}}}};var y=v[A.anchorOrientation](A.sourceAxis,L,z,H,K);if(y){for(var E=0;E<y.length;E++){f(l,y[E][0],y[E][1],A)}}f(l,x[2],x[3],A)}f(l,A.tx,A.ty,A);o(this,l,A)}};a.extend(c,d.Connectors.AbstractConnector);d.registerConnectorType(c,"Flowchart")}).call(typeof window!=="undefined"?window:this);(function(){var b=this,c=b.jsPlumb,a=b.jsPlumbUtil;c.Connectors.AbstractBezierConnector=function(h){h=h||{};var n=h.showLoopback!==false,e=h.curviness||10,i=h.margin||5,l=h.proximityLimit||80,f=h.orientation&&h.orientation==="clockwise",g=h.loopbackRadius||25,k=false,m;this.overrideSetEditable=function(){return !k};this._compute=function(s,o){var q=o.sourcePos,y=o.targetPos,A=Math.abs(q[0]-y[0]),v=Math.abs(q[1]-y[1]);if(!n||(o.sourceEndpoint.elementId!==o.targetEndpoint.elementId)){k=false;this._computeBezier(s,o,q,y,A,v)}else{k=true;var r=o.sourcePos[0],z=o.sourcePos[1]-i,u=r,t=z-g,x=u-g,w=t-g;A=2*g;v=2*g;s.points[0]=x;s.points[1]=w;s.points[2]=A;s.points[3]=v;m.addSegment(this,"Arc",{loopback:true,x1:(r-x)+4,y1:z-w,startAngle:0,endAngle:2*Math.PI,r:g,ac:!f,x2:(r-x)-4,y2:z-w,cx:u-x,cy:t-w})}};m=c.Connectors.AbstractConnector.apply(this,arguments);return m};a.extend(c.Connectors.AbstractBezierConnector,c.Connectors.AbstractConnector);var d=function(h){h=h||{};this.type="Bezier";var g=c.Connectors.AbstractBezierConnector.apply(this,arguments),e=h.curviness||150,f=10;this.getCurviness=function(){return e};this._findControlPoint=function(s,i,o,k,m,q,r){var n=q[0]!=r[0]||q[1]==r[1],l=[];if(!n){if(q[0]===0){l.push(i[0]<o[0]?s[0]+f:s[0]-f)}else{l.push(s[0]-(e*q[0]))}if(q[1]===0){l.push(i[1]<o[1]?s[1]+f:s[1]-f)}else{l.push(s[1]+(e*r[1]))}}else{if(r[0]===0){l.push(o[0]<i[0]?s[0]+f:s[0]-f)}else{l.push(s[0]+(e*r[0]))}if(r[1]===0){l.push(o[1]<i[1]?s[1]+f:s[1]-f)}else{l.push(s[1]+(e*q[1]))}}return l};this._computeBezier=function(n,l,m,u,v,r){var s=this.getGeometry(),w,t,q=m[0]<u[0]?v:0,o=m[1]<u[1]?r:0,k=m[0]<u[0]?0:v,i=m[1]<u[1]?0:r;if((this.hasBeenEdited()||this.isEditing())&&s!=null&&s.controlPoints!=null&&s.controlPoints[0]!=null&&s.controlPoints[1]!=null){w=s.controlPoints[0];t=s.controlPoints[1]}else{w=this._findControlPoint([q,o],m,u,l.sourceEndpoint,l.targetEndpoint,n.so,n.to);t=this._findControlPoint([k,i],u,m,l.targetEndpoint,l.sourceEndpoint,n.to,n.so)}g.setGeometry({controlPoints:[w,t]},true);g.addSegment(this,"Bezier",{x1:q,y1:o,x2:k,y2:i,cp1x:w[0],cp1y:w[1],cp2x:t[0],cp2y:t[1]})}};a.extend(d,c.Connectors.AbstractBezierConnector);c.registerConnectorType(d,"Bezier")}).call(typeof window!=="undefined"?window:this);(function(){var c=this,e=c.jsPlumb,b=c.jsPlumbUtil;var d=function(h,k,g,i){if(h<=g&&i<=k){return 1}else{if(h<=g&&k<=i){return 2}else{if(g<=h&&i>=k){return 3}}}return 4},f=function(k,i,m,h,l,p,o,g,n){if(g<=n){return[k,i]}if(m===1){if(h[3]<=0&&l[3]>=1){return[k+(h[2]<0.5?-1*p:p),i]}else{if(h[2]>=1&&l[2]<=0){return[k,i+(h[3]<0.5?-1*o:o)]}else{return[k+(-1*p),i+(-1*o)]}}}else{if(m===2){if(h[3]>=1&&l[3]<=0){return[k+(h[2]<0.5?-1*p:p),i]}else{if(h[2]>=1&&l[2]<=0){return[k,i+(h[3]<0.5?-1*o:o)]}else{return[k+p,i+(-1*o)]}}}else{if(m===3){if(h[3]>=1&&l[3]<=0){return[k+(h[2]<0.5?-1*p:p),i]}else{if(h[2]<=0&&l[2]>=1){return[k,i+(h[3]<0.5?-1*o:o)]}else{return[k+(-1*p),i+(-1*o)]}}}else{if(m===4){if(h[3]<=0&&l[3]>=1){return[k+(h[2]<0.5?-1*p:p),i]}else{if(h[2]<=0&&l[2]>=1){return[k,i+(h[3]<0.5?-1*o:o)]}else{return[k+p,i+(-1*o)]}}}}}}};var a=function(n){n=n||{};this.type="StateMachine";var k=e.Connectors.AbstractBezierConnector.apply(this,arguments),i=n.curviness||10,l=n.margin||5,m=n.proximityLimit||80,g=n.orientation&&n.orientation==="clockwise",h;this._computeBezier=function(u,H,D,p,A,E){var s=H.sourcePos[0]<H.targetPos[0]?0:A,q=H.sourcePos[1]<H.targetPos[1]?0:E,C=H.sourcePos[0]<H.targetPos[0]?A:0,B=H.sourcePos[1]<H.targetPos[1]?E:0;if(H.sourcePos[2]===0){s-=l}if(H.sourcePos[2]===1){s+=l}if(H.sourcePos[3]===0){q-=l}if(H.sourcePos[3]===1){q+=l}if(H.targetPos[2]===0){C-=l}if(H.targetPos[2]===1){C+=l}if(H.targetPos[3]===0){B-=l}if(H.targetPos[3]===1){B+=l}var z=(s+C)/2,y=(q+B)/2,o=d(s,q,C,B),v=Math.sqrt(Math.pow(C-s,2)+Math.pow(B-q,2)),G,t,F,r,x=k.getGeometry();if((this.hasBeenEdited()||this.isEditing())&&x!=null){G=x.controlPoints[0][0];F=x.controlPoints[0][1];t=x.controlPoints[1][0];r=x.controlPoints[1][1]}else{h=f(z,y,o,H.sourcePos,H.targetPos,i,i,v,m);G=h[0];t=h[0];F=h[1];r=h[1];k.setGeometry({controlPoints:[h,h]},true)}k.addSegment(this,"Bezier",{x1:C,y1:B,x2:s,y2:q,cp1x:G,cp1y:F,cp2x:t,cp2y:r})}};b.extend(a,e.Connectors.AbstractBezierConnector);e.registerConnectorType(a,"StateMachine")}).call(typeof window!=="undefined"?window:this);(function(){var b=this,c=b.jsPlumb,a=b.jsPlumbUtil;var d="Straight";var e=function(g){this.type=d;var f=c.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(i,h){f.addSegment(this,d,{x1:i.sx,y1:i.sy,x2:i.startStubX,y2:i.startStubY});f.addSegment(this,d,{x1:i.startStubX,y1:i.startStubY,x2:i.endStubX,y2:i.endStubY});f.addSegment(this,d,{x1:i.endStubX,y1:i.endStubY,x2:i.tx,y2:i.ty})}};a.extend(e,c.Connectors.AbstractConnector);c.registerConnectorType(e,d)}).call(typeof window!=="undefined"?window:this);(function(){var v=this,e=v.jsPlumb,d=v.jsPlumbUtil;var i=0;var n={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},x="stroke-dasharray",C="dashstyle",f="linearGradient",b="radialGradient",l="defs",c="fill",a="stop",B="stroke",s="stroke-width",k="style",o="none",u="jsplumb_gradient_",q="strokeWidth",D={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},h=function(G,E){for(var F in E){G.setAttribute(F,""+E[F])}},g=function(F,E){E=E||{};E.version="1.1";E.name=i++;E.xmlns=D.xhtml;return e.createElementNS(D.svg,F,null,null,E)},p=function(E){return"position:absolute;left:"+E[0]+"px;top:"+E[1]+"px"},m=function(G){var F=G.querySelectorAll(" defs,linearGradient,radialGradient");for(var E=0;E<F.length;E++){F[E].parentNode.removeChild(F[E])}},w=function(P,J,G,E,K){var H=u+K._jsPlumb.instance.idstamp();m(P);var N;if(!G.gradient.offset){N=g(f,{id:H,gradientUnits:"userSpaceOnUse"})}else{N=g(b,{id:H})}var L=g(l);P.appendChild(L);L.appendChild(N);for(var M=0;M<G.gradient.stops.length;M++){var I=K.segment==1||K.segment==2?M:G.gradient.stops.length-1-M,O=G.gradient.stops[I][1],Q=g(a,{offset:Math.floor(G.gradient.stops[M][0]*100)+"%","stop-color":O});N.appendChild(Q)}var F=G.stroke?B:c;J.setAttribute(F,"url(#"+H+")")},y=function(L,H,F,E,I){H.setAttribute(c,F.fill?F.fill:o);H.setAttribute(B,F.stroke?F.stroke:o);if(F.gradient){w(L,H,F,E,I)}else{m(L);H.setAttribute(k,"")}if(F.strokeWidth){H.setAttribute(s,F.strokeWidth)}if(F[C]&&F[q]&&!F[x]){var M=F[C].indexOf(",")==-1?" ":",",J=F[C].split(M),G="";J.forEach(function(N){G+=(Math.floor(N*F.strokeWidth)+M)});H.setAttribute(x,G)}else{if(F[x]){H.setAttribute(x,F[x])}}for(var K in n){if(F[K]){H.setAttribute(n[K],F[K])}}},A=function(F,G,E){if(F.childNodes.length>E){F.insertBefore(G,F.childNodes[E])}else{F.appendChild(G)}};d.svg={node:g,attr:h,pos:p};var t=function(I){var G=I.pointerEventsSpec||"all",H={};e.jsPlumbUIComponent.apply(this,I.originalArgs);this.canvas=null;this.path=null;this.svg=null;this.bgCanvas=null;var F=I.cssClass+" "+(I.originalArgs[0].cssClass||""),J={style:"",width:0,height:0,"pointer-events":G,position:"absolute"};this.svg=g("svg",J);if(I.useDivWrapper){this.canvas=e.createElement("div",{position:"absolute"});d.sizeElement(this.canvas,0,0,1,1);this.canvas.className=F}else{h(this.svg,{"class":F});this.canvas=this.svg}I._jsPlumb.appendElement(this.canvas,I.originalArgs[0].parent);if(I.useDivWrapper){this.canvas.appendChild(this.svg)}var E=[this.canvas];this.getDisplayElements=function(){return E};this.appendDisplayElement=function(K){E.push(K)};this.paint=function(M,L,N){if(M!=null){var P=[this.x,this.y],K=[this.w,this.h],O;if(N!=null){if(N.xmin<0){P[0]+=N.xmin}if(N.ymin<0){P[1]+=N.ymin}K[0]=N.xmax+((N.xmin<0)?-N.xmin:0);K[1]=N.ymax+((N.ymin<0)?-N.ymin:0)}if(I.useDivWrapper){d.sizeElement(this.canvas,P[0],P[1],K[0],K[1]);P[0]=0;P[1]=0;O=p([0,0])}else{O=p([P[0],P[1]])}H.paint.apply(this,arguments);h(this.svg,{style:O,width:K[0]||0,height:K[1]||0})}};return{renderer:H}};d.extend(t,e.jsPlumbUIComponent,{cleanup:function(E){if(E||this.typeId==null){if(this.canvas){this.canvas._jsPlumb=null}if(this.svg){this.svg._jsPlumb=null}if(this.bgCanvas){this.bgCanvas._jsPlumb=null}if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}this.svg=null;this.canvas=null;this.path=null;this.group=null}else{if(this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode){this.bgCanvas.parentNode.removeChild(this.bgCanvas)}}},reattach:function(E){var F=E.getContainer();if(this.canvas&&this.canvas.parentNode==null){F.appendChild(this.canvas)}if(this.bgCanvas&&this.bgCanvas.parentNode==null){F.appendChild(this.bgCanvas)}},setVisible:function(E){if(this.canvas){this.canvas.style.display=E?"block":"none"}}});e.ConnectorRenderers.svg=function(H){var E=this,F=t.apply(this,[{cssClass:H._jsPlumb.connectorClass+(this.isEditable()?" "+H._jsPlumb.editableConnectorClass:""),originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:H._jsPlumb}]);var G=this.setEditable;this.setEditable=function(J){var I=G.apply(this,[J]);e[I?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.editableConnectorClass)};F.renderer.paint=function(I,L,Q){var M=E.getSegments(),J="",K=[0,0];if(Q.xmin<0){K[0]=-Q.xmin}if(Q.ymin<0){K[1]=-Q.ymin}if(M.length>0){J=E.getPathData();var R={d:J,transform:"translate("+K[0]+","+K[1]+")","pointer-events":H["pointer-events"]||"visibleStroke"},O=null,N=[E.x,E.y,E.w,E.h];if(I.outlineStroke){var P=I.outlineWidth||1,S=I.strokeWidth+(2*P);O=e.extend({},I);delete O.gradient;O.stroke=I.outlineStroke;O.strokeWidth=S;if(E.bgPath==null){E.bgPath=g("path",R);e.addClass(E.bgPath,e.connectorOutlineClass);A(E.svg,E.bgPath,0)}else{h(E.bgPath,R)}y(E.svg,E.bgPath,O,N,E)}if(E.path==null){E.path=g("path",R);A(E.svg,E.path,I.outlineStroke?1:0)}else{h(E.path,R)}y(E.svg,E.path,I,N,E)}}};d.extend(e.ConnectorRenderers.svg,t);var z=e.SvgEndpoint=function(F){var E=t.apply(this,[{cssClass:F._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:true,_jsPlumb:F._jsPlumb}]);E.renderer.paint=function(H){var G=e.extend({},H);if(G.outlineStroke){G.strokeWidth=G.strokeWidth;G.stroke=G.outlineStroke}if(this.node==null){this.node=this.makeNode(G);this.svg.appendChild(this.node)}else{if(this.updateNode!=null){this.updateNode(this.node)}}y(this.svg,this.node,G,[this.x,this.y,this.w,this.h],this);p(this.node,[this.x,this.y])}.bind(this)};d.extend(z,t);e.Endpoints.svg.Dot=function(){e.Endpoints.Dot.apply(this,arguments);z.apply(this,arguments);this.makeNode=function(E){return g("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(E){h(E,{cx:this.w/2,cy:this.h/2,r:this.radius})}};d.extend(e.Endpoints.svg.Dot,[e.Endpoints.Dot,z]);e.Endpoints.svg.Rectangle=function(){e.Endpoints.Rectangle.apply(this,arguments);z.apply(this,arguments);this.makeNode=function(E){return g("rect",{width:this.w,height:this.h})};this.updateNode=function(E){h(E,{width:this.w,height:this.h})}};d.extend(e.Endpoints.svg.Rectangle,[e.Endpoints.Rectangle,z]);e.Endpoints.svg.Image=e.Endpoints.Image;e.Endpoints.svg.Blank=e.Endpoints.Blank;e.Overlays.svg.Label=e.Overlays.Label;e.Overlays.svg.Custom=e.Overlays.Custom;var r=function(H,G){H.apply(this,G);e.jsPlumbUIComponent.apply(this,G);this.isAppendedAtTopLevel=false;var E=this;this.path=null;this.paint=function(L,I){if(L.component.svg&&I){if(this.path==null){this.path=g("path",{"pointer-events":"all"});L.component.svg.appendChild(this.path);if(this.elementCreated){this.elementCreated(this.path,L.component)}this.canvas=L.component.svg}var J=G&&(G.length==1)?(G[0].cssClass||""):"",K=[0,0];if(I.xmin<0){K[0]=-I.xmin}if(I.ymin<0){K[1]=-I.ymin}h(this.path,{d:F(L.d),"class":J,stroke:L.stroke?L.stroke:null,fill:L.fill?L.fill:null,transform:"translate("+K[0]+","+K[1]+")"})}};var F=function(I){return(isNaN(I.cxy.x)||isNaN(I.cxy.y))?"":"M"+I.hxy.x+","+I.hxy.y+" L"+I.tail[0].x+","+I.tail[0].y+" L"+I.cxy.x+","+I.cxy.y+" L"+I.tail[1].x+","+I.tail[1].y+" L"+I.hxy.x+","+I.hxy.y};this.transfer=function(I){if(I.canvas&&this.path&&this.path.parentNode){this.path.parentNode.removeChild(this.path);I.canvas.appendChild(this.path)}}};d.extend(r,[e.jsPlumbUIComponent,e.Overlays.AbstractOverlay],{cleanup:function(E){if(this.path!=null){if(E){this._jsPlumb.instance.removeElement(this.path)}else{if(this.path.parentNode){this.path.parentNode.removeChild(this.path)}}}},reattach:function(E){if(this.path&&this.canvas&&this.path.parentNode==null){this.canvas.appendChild(this.path)}},setVisible:function(E){if(this.path!=null){(this.path.style.display=(E?"block":"none"))}}});e.Overlays.svg.Arrow=function(){r.apply(this,[e.Overlays.Arrow,arguments])};d.extend(e.Overlays.svg.Arrow,[e.Overlays.Arrow,r]);e.Overlays.svg.PlainArrow=function(){r.apply(this,[e.Overlays.PlainArrow,arguments])};d.extend(e.Overlays.svg.PlainArrow,[e.Overlays.PlainArrow,r]);e.Overlays.svg.Diamond=function(){r.apply(this,[e.Overlays.Diamond,arguments])};d.extend(e.Overlays.svg.Diamond,[e.Overlays.Diamond,r]);e.Overlays.svg.GuideLines=function(){var I=null,E=this,H,G;e.Overlays.GuideLines.apply(this,arguments);this.paint=function(L,J){if(I==null){I=g("path");L.connector.svg.appendChild(I);E.attachListeners(I,L.connector);E.attachListeners(I,E);H=g("path");L.connector.svg.appendChild(H);E.attachListeners(H,L.connector);E.attachListeners(H,E);G=g("path");L.connector.svg.appendChild(G);E.attachListeners(G,L.connector);E.attachListeners(G,E)}var K=[0,0];if(J.xmin<0){K[0]=-J.xmin}if(J.ymin<0){K[1]=-J.ymin}h(I,{d:F(L.head,L.tail),stroke:"red",fill:null,transform:"translate("+K[0]+","+K[1]+")"});h(H,{d:F(L.tailLine[0],L.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+K[0]+","+K[1]+")"});h(G,{d:F(L.headLine[0],L.headLine[1]),stroke:"green",fill:null,transform:"translate("+K[0]+","+K[1]+")"})};var F=function(K,J){return"M "+K.x+","+K.y+" L"+J.x+","+J.y}};d.extend(e.Overlays.svg.GuideLines,e.Overlays.GuideLines)}).call(typeof window!=="undefined"?window:this);(function(){var b=this,g=b.jsPlumb,a=b.jsPlumbUtil,h=b.Katavorio,c=b.Biltong;var d=function(i,n){n=n||"main";var m="_katavorio_"+n;var l=i[m],o=i.getEventManager();if(!l){l=new h({bind:o.on,unbind:o.off,getSize:g.getSize,getPosition:function(k,p){var q=i.getOffset(k,p,k._katavorioDrag?k.offsetParent:null);return[q.left,q.top]},setPosition:function(k,p){k.style.left=p[0]+"px";k.style.top=p[1]+"px"},addClass:g.addClass,removeClass:g.removeClass,intersects:c.intersects,indexOf:function(k,p){return k.indexOf(p)},scope:i.getDefaultScope(),css:{noSelect:i.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}});i[m]=l;i.bind("zoom",l.setZoom)}return l};var f=function(l,k){var i=function(o){if(k[o]!=null){if(a.isString(k[o])){var n=k[o].match(/-=/)?-1:1,p=k[o].substring(2);return l[o]+(n*p)}else{return k[o]}}else{return l[o]}};return[i("left"),i("top")]};g.extend(b.jsPlumbInstance.prototype,{animationSupported:true,getElement:function(i){if(i==null){return null}i=typeof i==="string"?i:i.length!=null&&i.enctype==null?i[0]:i;return typeof i==="string"?document.getElementById(i):i},removeElement:function(i){d(this).elementRemoved(i);this.getEventManager().remove(i)},doAnimate:function(l,s,x){x=x||{};var k=this.getOffset(l),p=f(k,s),n=p[0]-k.left,q=p[1]-k.top,r=x.duration||250,m=15,u=r/m,i=(m/r)*n,w=(m/r)*q,v=0,t=setInterval(function(){g.setPosition(l,{left:k.left+(i*(v+1)),top:k.top+(w*(v+1))});if(x.step!=null){x.step(v,Math.ceil(u))}v++;if(v>=u){window.clearInterval(t);if(x.complete!=null){x.complete()}}},m)},destroyDraggable:function(i,k){d(this,k).destroyDraggable(i)},destroyDroppable:function(i,k){d(this,k).destroyDroppable(i)},initDraggable:function(k,i,l){d(this,l).draggable(k,i)},initDroppable:function(k,i,l){d(this,l).droppable(k,i)},isAlreadyDraggable:function(i){return i._katavorioDrag!=null},isDragSupported:function(k,i){return true},isDropSupported:function(k,i){return true},isElementDraggable:function(i){i=g.getElement(i);return i._katavorioDrag&&i._katavorioDrag.isEnabled()},getDragObject:function(i){return i[0].drag.getDragElement()},getDragScope:function(i){return i._katavorioDrag&&i._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(i){return i[0].e},getUIPosition:function(k,m){var l=k[0].el;if(l.offsetParent==null){return null}var n=k[0].finalPos||k[0].pos;var o={left:n[0],top:n[1]};if(l._katavorioDrag&&l.offsetParent!==this.getContainer()){var i=this.getOffset(l.offsetParent);o.left+=i.left;o.top+=i.top}return o},setDragFilter:function(k,i,l){if(k._katavorioDrag){k._katavorioDrag.setFilter(i,l)}},setElementDraggable:function(k,i){k=g.getElement(k);if(k._katavorioDrag){k._katavorioDrag.setEnabled(i)}},setDragScope:function(k,i){if(k._katavorioDrag){k._katavorioDrag.k.setDragScope(k,i)}},setDropScope:function(k,i){if(k._katavorioDrop&&k._katavorioDrop.length>0){k._katavorioDrop[0].k.setDropScope(k,i)}},addToPosse:function(l,k){var m=Array.prototype.slice.call(arguments,1);var i=d(this);g.each(l,function(n){n=[g.getElement(n)];n.push.apply(n,m);i.addToPosse.apply(i,n)})},setPosse:function(l,k){var m=Array.prototype.slice.call(arguments,1);var i=d(this);g.each(l,function(n){n=[g.getElement(n)];n.push.apply(n,m);i.setPosse.apply(i,n)})},removeFromPosse:function(k,l){var m=Array.prototype.slice.call(arguments,1);var i=d(this);g.each(k,function(n){n=[g.getElement(n)];n.push.apply(n,m);i.removeFromPosse.apply(i,n)})},removeFromAllPosses:function(k){var i=d(this);g.each(k,function(l){i.removeFromAllPosses(g.getElement(l))})},setPosseState:function(k,l,m){var i=d(this);g.each(k,function(n){i.setPosseState(g.getElement(n),l,m)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(i){if(i._katavorioDrag){i._katavorioDrag.abort()}},addToDragSelection:function(i){d(this).select(i)},removeFromDragSelection:function(i){d(this).deselect(i)},clearDragSelection:function(){d(this).deselectAll()},trigger:function(k,l,i,m){this.getEventManager().trigger(k,l,i,m)},doReset:function(){for(var i in this){if(i.indexOf("_katavorio_")===0){this[i].reset()}}}});var e=function(k){var i=function(){if(/complete|loaded|interactive/.test(document.readyState)&&typeof(document.body)!="undefined"&&document.body!=null){k()}else{setTimeout(i,9)}};i()};e(g.init)}).call(typeof window!=="undefined"?window:this);