!function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(b){return 0==b?0:b>0?1:-1});var U={subtract:function(d,c){return{x:d.x-c.x,y:d.y-c.y}},dotProduct:function(d,c){return d.x*c.x+d.y*c.y},square:function(b){return Math.sqrt(b.x*b.x+b.y*b.y)},scale:function(d,c){return{x:d.x*c,y:d.y*c}}},T=64,S=Math.pow(2,-T-1),R=function(x,w){for(var v=[],u=P(x,w),t=w.length-1,s=2*t-1,r=O(u,s,v,0),q=U.subtract(x,w[0]),l=U.square(q),g=0,f=0;r>f;f++){q=U.subtract(x,K(w,t,v[f],null,null));var a=U.square(q);l>a&&(l=a,g=v[f])}return q=U.subtract(x,w[t]),a=U.square(q),l>a&&(l=a,g=1),{location:g,distance:l}},Q=function(e,d){var f=R(e,d);return{point:K(d,d.length-1,f.location,null,null),location:f.location}},P=function(ae,ad){for(var ac=ad.length-1,ab=2*ac-1,aa=[],Z=[],Y=[],X=[],W=[[1,0.6,0.3,0.1],[0.4,0.6,0.6,0.4],[0.1,0.3,0.6,1]],V=0;ac>=V;V++){aa[V]=U.subtract(ad[V],ae)}for(var V=0;ac-1>=V;V++){Z[V]=U.subtract(ad[V+1],ad[V]),Z[V]=U.scale(Z[V],3)}for(var x=0;ac-1>=x;x++){for(var w=0;ac>=w;w++){Y[x]||(Y[x]=[]),Y[x][w]=U.dotProduct(Z[x],aa[w])}}for(V=0;ab>=V;V++){X[V]||(X[V]=[]),X[V].y=0,X[V].x=parseFloat(V)/ab}for(var v=ac,u=ac-1,t=0;v+u>=t;t++){var a=Math.max(0,t-u),af=Math.min(t,v);for(V=a;af>=V;V++){j=t-V,X[V+j].y+=Y[j][V]*W[j][V]}}return X},O=function(v,u,t,s){var r,l,k=[],i=[],h=[],g=[];switch(N(v,u)){case 0:return 0;case 1:if(s>=T){return t[0]=(v[0].x+v[u].x)/2,1}if(M(v,u)){return t[0]=L(v,u),1}}K(v,u,0.5,k,i),r=O(k,u,h,s+1),l=O(i,u,g,s+1);for(var b=0;r>b;b++){t[b]=h[b]}for(var b=0;l>b;b++){t[b+r]=g[b]}return r+l},N=function(h,g){var m,l,k=0;m=l=Math.sgn(h[0].y);for(var i=1;g>=i;i++){m=Math.sgn(h[i].y),m!=l&&k++,l=m}return k},M=function(am,al){var ak,aj,ai,ah,ag,af,ae,ad,ac,ab,aa,Z,Y,X,W,V;af=am[0].y-am[al].y,ae=am[al].x-am[0].x,ad=am[0].x*am[al].y-am[al].x*am[0].y;for(var x=max_distance_below=0,w=1;al>w;w++){var c=af*am[w].x+ae*am[w].y+ad;c>x?x=c:max_distance_below>c&&(max_distance_below=c)}return aa=0,Z=1,Y=0,X=af,W=ae,V=ad-x,ac=aa*W-X*Z,ab=1/ac,aj=(Z*V-W*Y)*ab,X=af,W=ae,V=ad-max_distance_below,ac=aa*W-X*Z,ab=1/ac,ai=(Z*V-W*Y)*ab,ah=Math.min(aj,ai),ag=Math.max(aj,ai),ak=ag-ah,S>ak?1:0},L=function(v,u){var t=1,s=0,r=v[u].x-v[0].x,q=v[u].y-v[0].y,p=v[0].x-0,o=v[0].y-0,n=r*s-q*t,m=1/n,l=(r*o-q*p)*m;return 0+t*l},K=function(k,i,q,p,o){for(var n=[[]],m=0;i>=m;m++){n[0][m]=k[m]}for(var l=1;i>=l;l++){for(var m=0;i-l>=m;m++){n[l]||(n[l]=[]),n[l][m]||(n[l][m]={}),n[l][m].x=(1-q)*n[l-1][m].x+q*n[l-1][m+1].x,n[l][m].y=(1-q)*n[l-1][m].y+q*n[l-1][m+1].y}}if(null!=p){for(m=0;i>=m;m++){p[m]=n[m][0]}}if(null!=o){for(m=0;i>=m;m++){o[m]=n[i-m][m]}}return n[i][0]},J={},I=function(v){var u=J[v];if(!u){u=[];var t=function(){return function(a){return Math.pow(a,v)}},s=function(){return function(a){return Math.pow(1-a,v)}},r=function(b){return function(){return b}},q=function(){return function(b){return b}},p=function(){return function(b){return 1-b}},o=function(b){return function(a){for(var f=1,e=0;e<b.length;e++){f*=b[e](a)}return f}};u.push(new t);for(var n=1;v>n;n++){for(var m=[new r(v)],l=0;v-n>l;l++){m.push(new q)}for(var l=0;n>l;l++){m.push(new p)}u.push(new o(m))}u.push(new s),J[v]=u}return u},H=function(h,g){for(var m=I(h.length-1),l=0,k=0,i=0;i<h.length;i++){l+=h[i].x*m[i](g),k+=h[i].y*m[i](g)}return{x:l,y:k}},G=function(d,c){return Math.sqrt(Math.pow(d.x-c.x,2)+Math.pow(d.y-c.y,2))},F=function(b){return b[0].x==b[1].x&&b[0].y==b[1].y},E=function(k,i,q){if(F(k)){return{point:k[0],location:i}}for(var p=H(k,i),o=0,n=i,m=q>0?1:-1,l=null;o<Math.abs(q);){n+=0.005*m,l=H(k,n),o+=G(l,p),p=l}return{point:l,location:n}},D=function(h){if(F(h)){return 0}for(var g=H(h,0),m=0,l=0,k=1,i=null;1>l;){l+=0.005*k,i=H(h,l),m+=G(i,g),g=i}return m},C=function(e,d,f){return E(e,d,f).point},B=function(e,d,f){return E(e,d,f).location},A=function(h,g){var m=H(h,g),l=H(h.slice(0,h.length-1),g),k=l.y-m.y,i=l.x-m.x;return 0==k?1/0:Math.atan(k/i)},z=function(f,e,h){var g=E(f,e,h);return g.location>1&&(g.location=1),g.location<0&&(g.location=0),A(f,g.location)},y=function(s,r,q,p){p=null==p?0:p;var o=E(s,r,p),n=A(s,o.location),m=Math.atan(-1/n),l=q/2*Math.sin(m),k=q/2*Math.cos(m);return[{x:o.point.x+k,y:o.point.y+l},{x:o.point.x-k,y:o.point.y-l}]};window.jsBezier={distanceFromCurve:R,gradientAtPoint:A,gradientAtPointAlongCurveFrom:z,nearestPointOnCurve:Q,pointOnCurve:H,pointAlongCurveFrom:C,perpendicularToCurveAt:y,locationAlongCurveFrom:B,getLength:D}}(),function(){var i=this.Biltong={},h=function(b){return"[object Array]"===Object.prototype.toString.call(b)},o=function(b,f,e){return b=h(b)?b:[b.x,b.y],f=h(f)?f:[f.x,f.y],e(b,f)},n=i.gradient=function(d,c){return o(d,c,function(f,e){return e[0]==f[0]?e[1]>f[1]?1/0:-1/0:e[1]==f[1]?e[0]>f[0]?0:-0:(e[1]-f[1])/(e[0]-f[0])})},m=(i.normal=function(d,c){return -1/n(d,c)},i.lineLength=function(d,c){return o(d,c,function(f,e){return Math.sqrt(Math.pow(e[1]-f[1],2)+Math.pow(e[0]-f[0],2))})},i.quadrant=function(d,c){return o(d,c,function(f,e){return e[0]>f[0]?e[1]>f[1]?2:1:e[0]==f[0]?e[1]>f[1]?2:1:e[1]>f[1]?3:4})}),l=(i.theta=function(d,c){return o(d,c,function(p,e){var s=n(p,e),r=Math.atan(s),q=m(p,e);return(4==q||3==q)&&(r+=Math.PI),0>r&&(r+=2*Math.PI),r})},i.intersects=function(y,x){var w=y.x,v=y.x+y.w,u=y.y,t=y.y+y.h,s=x.x,r=x.x+x.w,q=x.y,p=x.y+x.h;return s>=w&&v>=s&&q>=u&&t>=q||r>=w&&v>=r&&q>=u&&t>=q||s>=w&&v>=s&&p>=u&&t>=p||r>=w&&v>=s&&p>=u&&t>=p||w>=s&&r>=w&&u>=q&&p>=u||v>=s&&r>=v&&u>=q&&p>=u||w>=s&&r>=w&&t>=q&&p>=t||v>=s&&r>=w&&t>=q&&p>=t},i.encloses=function(A,z,y){var x=A.x,w=A.x+A.w,v=A.y,u=A.y+A.h,t=z.x,s=z.x+z.w,r=z.y,q=z.y+z.h,p=function(f,c,B,g){return y?c>=f&&B>=g:c>f&&B>g};return p(x,t,w,s)&&p(v,r,u,q)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),k=[null,[-1,-1],[-1,1],[1,1],[1,-1]];i.pointOnLine=function(t,s,r){var q=n(t,s),p=m(t,s),g=r>0?l[p]:k[p],f=Math.atan(q),e=Math.abs(r*Math.sin(f))*g[1],d=Math.abs(r*Math.cos(f))*g[0];return{x:t.x+d,y:t.y+e}},i.perpendicularLineTo=function(p,d,u){var t=n(p,d),s=Math.atan(-1/t),r=u/2*Math.sin(s),q=u/2*Math.cos(s);return[{x:d.x+q,y:d.y+r},{x:d.x-q,y:d.y-r}]}}.call(this),function(){var s=function(b){return"[object Array]"===Object.prototype.toString.call(b)},r=function(b){return"[object Number]"===Object.prototype.toString.call(b)},q=function(b){return"string"==typeof b},p=function(b){return"boolean"==typeof b},o=function(b){return null==b},n=function(b){return null==b?!1:"[object Object]"===Object.prototype.toString.call(b)},m=function(b){return"[object Date]"===Object.prototype.toString.call(b)},l=function(b){return"[object Function]"===Object.prototype.toString.call(b)},k=function(d){for(var c in d){if(d.hasOwnProperty(c)){return !1}}return !0};jsPlumbUtil={isArray:s,isString:q,isBoolean:p,isNull:o,isObject:n,isDate:m,isFunction:l,isEmpty:k,isNumber:r,clone:function(a){if(q(a)){return""+a}if(p(a)){return !!a}if(m(a)){return new Date(a.getTime())}if(l(a)){return a}if(s(a)){for(var g=[],f=0;f<a.length;f++){g.push(this.clone(a[f]))}return g}if(n(a)){var d={};for(var c in a){d[c]=this.clone(a[c])}return d}return a},matchesSelector:function(g,f,t){t=t||g.parentNode;for(var i=t.querySelectorAll(f),h=0;h<i.length;h++){if(i[h]===g){return !0}}return !1},merge:function(a,u){var t=this.clone(a);for(var f in u){if(null==t[f]||q(u[f])||p(u[f])){t[f]=u[f]}else{if(s(u[f])){var d=[];s(t[f])&&d.push.apply(d,t[f]),d.push.apply(d,u[f]),t[f]=d}else{if(n(u[f])){n(t[f])||(t[f]={});for(var c in u[f]){t[f][c]=u[f][c]}}}}}return t},replace:function(g,f,t){var i=g,h=i;return f.replace(/([^\.])+/g,function(e,c,z,y){var x=e.match(/([^\[0-9]+){1}(\[)([0-9+])/),w=z+e.length>=y.length,v=function(){return h[x[1]]||function(){return h[x[1]]=[],h[x[1]]}()};if(w){x?v()[x[3]]=t:h[e]=t}else{if(x){var u=v();h=u[x[3]]||function(){return u[x[3]]={},u[x[3]]}()}else{h=h[e]||function(){return h[e]={},h[e]}()}}}),g},functionChain:function(g,f,t){for(var i=0;i<t.length;i++){var h=t[i][0][t[i][1]].apply(t[i][0],t[i][2]);if(h===f){return h}}return g},populate:function(a,h){var f=function(g){var d=g.match(/(\${.*?})/g);if(null!=d){for(var t=0;t<d.length;t++){var i=h[d[t].substring(2,d[t].length-1)];null!=i&&(g=g.replace(d[t],i))}}return g},c=function(e){if(null!=e){if(q(e)){return f(e)}if(s(e)){for(var v=[],u=0;u<e.length;u++){v.push(c(e[u]))}return v}if(n(e)){var t={};for(var g in e){t[g]=c(e[g])}return t}return e}};return c(a)},convertStyle:function(i,h){if("transparent"===i){return i}var x=i,w=function(b){return 1==b.length?"0"+b:b},v=function(b){return w(Number(b).toString(16))},u=/(rgb[a]?\()(.*)(\))/;if(i.match(u)){var t=i.match(u)[2].split(",");x="#"+v(t[0])+v(t[1])+v(t[2]),h||4!=t.length||(x+=v(t[3]))}return x},findWithFunction:function(e,d){if(e){for(var f=0;f<e.length;f++){if(d(e[f])){return f}}}return -1},indexOf:function(d,c){return d.indexOf?d.indexOf(c):jsPlumbUtil.findWithFunction(d,function(b){return b==c})},removeWithFunction:function(e,d){var f=jsPlumbUtil.findWithFunction(e,d);return f>-1&&e.splice(f,1),-1!=f},remove:function(e,d){var f=jsPlumbUtil.indexOf(e,d);return f>-1&&e.splice(f,1),-1!=f},addWithFunction:function(e,d,f){-1==jsPlumbUtil.findWithFunction(e,f)&&e.push(d)},addToList:function(g,f,t,i){var h=g[f];return null==h&&(h=[],g[f]=h),h[i?"unshift":"push"](t),h},consume:function(d,c){d.stopPropagation?d.stopPropagation():d.returnValue=!1,!c&&d.preventDefault&&d.preventDefault()},extend:function(a,v){var u;for(v=s(v)?v:[v],u=0;u<v.length;u++){for(var t in v[u].prototype){v[u].prototype.hasOwnProperty(t)&&(a.prototype[t]=v[u].prototype[t])}}var i=function(d,c){return function(){for(u=0;u<v.length;u++){v[u].prototype[d]&&v[u].prototype[d].apply(this,arguments)}return c.apply(this,arguments)}},h=function(b){for(var d in b){a.prototype[d]=i(d,b[d])}};if(arguments.length>2){for(u=2;u<arguments.length;u++){h(arguments[u])}}return a},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=0|16*Math.random(),f="x"==e?d:8|3&d;return f.toString(16)})},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&"undefined"!=typeof console){try{var d=arguments[arguments.length-1];console.log(d)}catch(c){}}},sizeElement:function(g,f,t,i,h){g&&(g.style.height=h+"px",g.height=h,g.style.width=i+"px",g.width=i,g.style.left=f+"px",g.style.top=t+"px")},wrap:function(e,d,f){return e=e||function(){},d=d||function(){},function(){var b=null;try{b=d.apply(this,arguments)}catch(a){jsPlumbUtil.log("jsPlumb function failed : "+a)}if(null==f||b!==f){try{b=e.apply(this,arguments)}catch(a){jsPlumbUtil.log("wrapped function failed : "+a)}}return b}},ieVersion:/MSIE\s([\d.]+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1},jsPlumbUtil.oldIE=jsPlumbUtil.ieVersion>-1&&jsPlumbUtil.ieVersion<9,jsPlumbUtil.EventGenerator=function(){var e={},d=!1,f={ready:!0};this.bind=function(a,h,g){return jsPlumbUtil.addToList(e,a,h,g),this},this.fire=function(x,w,v){if(!d&&e[x]){var u=e[x].length,t=0,c=!1,b=null;if(!this.shouldFireEvent||this.shouldFireEvent(x,w,v)){for(;!c&&u>t&&b!==!1;){if(f[x]){e[x][t].apply(this,[w,v])}else{try{b=e[x][t].apply(this,[w,v])}catch(a){jsPlumbUtil.log("jsPlumb: fire failed for event "+x+" : "+a)}}t++,(null==e||null==e[x])&&(c=!0)}}}return this},this.unbind=function(a){return a?delete e[a]:e={},this},this.getListener=function(a){return e[a]},this.setSuspendEvents=function(b){d=b},this.isSuspendEvents=function(){return d},this.cleanupListeners=function(){for(var a in e){e[a]=null}}},jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}},Function.prototype.bind||(Function.prototype.bind=function(g){if("function"!=typeof this){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var f=Array.prototype.slice.call(arguments,1),t=this,i=function(){},h=function(){return t.apply(this instanceof i&&g?this:g,f.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,h.prototype=new i,h})}(),function(){var F=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),E=function(){if(void 0===E.vml){var b=document.body.appendChild(document.createElement("div"));b.innerHTML='<v:shape id="vml_flag1" adj="1" />';var d=b.firstChild;null!=d&&null!=d.style?(d.style.behavior="url(#default#VML)",E.vml=d?"object"==typeof d.adj:!0):E.vml=!1,b.parentNode.removeChild(b)}return E.vml},D=function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var d=navigator.userAgent,f=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=f.exec(d)&&(e=parseFloat(RegExp.$1))}return e}(),C=D>-1&&9>D,B=function(f,e){if(null==f){return[0,0]}var h=w(f),g=x(h,0);return[g[e+"X"],g[e+"Y"]]},A=function(b){return null==b?[0,0]:C?[b.clientX+document.documentElement.scrollLeft,b.clientY+document.documentElement.scrollTop]:B(b,"page")},z=function(b){return B(b,"screen")},y=function(b){return B(b,"client")},x=function(d,c){return d.item?d.item(c):d[c]},w=function(b){return b.touches&&b.touches.length>0?b.touches:b.changedTouches&&b.changedTouches.length>0?b.changedTouches:b.targetTouches&&b.targetTouches.length>0?b.targetTouches:[b]},v=function(h){var g={},m=[],l={},k={},i={};this.register=function(d){var c=h.getId(d),b=jsPlumbAdapter.getOffset(d,h);g[c]||(g[c]=d,m.push(d),l[c]={});var a=function(e){if(e){for(var p=0;p<e.childNodes.length;p++){if(3!=e.childNodes[p].nodeType&&8!=e.childNodes[p].nodeType){var o=jsPlumb.getElementObject(e.childNodes[p]),n=h.getId(e.childNodes[p],null,!0);if(n&&k[n]&&k[n]>0){var f=jsPlumbAdapter.getOffset(o,h);l[c][n]={id:n,offset:{left:f.left-b.left,top:f.top-b.top}},i[n]=c}a(e.childNodes[p])}}}};a(d)},this.updateOffsets=function(a){if(null!=a){var H=jsPlumb.getDOMElement(a),G=h.getId(H),p=l[G],o=jsPlumbAdapter.getOffset(H,h);if(p){for(var n in p){var f=jsPlumb.getElementObject(n),d=jsPlumbAdapter.getOffset(f,h);l[G][n]={id:n,offset:{left:d.left-o.left,top:d.top-o.top}},i[n]=G}}}},this.endpointAdded=function(o){var n=document.body,f=h.getId(o),e=jsPlumbAdapter.getOffset(o,h),d=o.parentNode;for(k[f]=k[f]?k[f]+1:1;null!=d&&d!=n;){var b=h.getId(d,null,!0);if(b&&g[b]){var a=jsPlumbAdapter.getOffset(d,h);null==l[b][f]&&(l[b][f]={id:f,offset:{left:e.left-a.left,top:e.top-a.top}},i[f]=b);break}d=d.parentNode}},this.endpointDeleted=function(d){if(k[d.elementId]&&(k[d.elementId]--,k[d.elementId]<=0)){for(var c in l){l[c]&&(delete l[c][d.elementId],delete i[d.elementId])}}},this.changeId=function(d,c){l[c]=l[d],l[d]={},i[c]=i[d],i[d]=null},this.getElementsForDraggable=function(b){return l[b]},this.elementRemoved=function(d){var c=i[d];c&&(delete l[c][d],delete i[d])},this.reset=function(){g={},m=[],l={},k={}},this.dragEnded=function(a){var f=h.getId(a),e=i[f];e&&this.updateOffsets(e)},this.setParent=function(a,G,p,o){var n=i[G];if(n){l[o]||(l[o]={}),l[o][G]=l[n][G],delete l[n][G];var f=jsPlumbAdapter.getOffset(p,h),d=jsPlumbAdapter.getOffset(a,h);l[o][G].offset={left:d.left-f.left,top:d.top-f.top},i[G]=o}}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}});var u=function(b){return null==b?null:b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},t=function(d,c){c=u(c),"undefined"!=typeof d.className.baseVal?d.className.baseVal=c:d.className=c},s=function(b){return"undefined"==typeof b.className.baseVal?b.className:b.className.baseVal},r=function(k,i,G){for(var p=G.split(/\s+/),o=s(k),n=o.split(/\s+/),m=0;m<p.length;m++){if(i){-1==jsPlumbUtil.indexOf(n,p[m])&&n.push(p[m])}else{var l=jsPlumbUtil.indexOf(n,p[m]);-1!=l&&n.splice(l,1)}}t(k,n.join(" "))},q=function(e,d){if(null!=e){if("string"==typeof e){d(jsPlumb.getDOMElement(e))}else{if(null!=e.length){for(var f=0;f<e.length;f++){d(jsPlumb.getDOMElement(e[f]))}}else{d(e)}}}};window.jsPlumbAdapter={headless:!1,pageLocation:A,screenLocation:z,clientLocation:y,getAttribute:function(d,c){return d.getAttribute(c)},setAttribute:function(e,d,f){e.setAttribute(d,f)},appendToRoot:function(b){document.body.appendChild(b)},getRenderModes:function(){return["svg","vml"]},isRenderModeAvailable:function(a){return{svg:F,vml:E()}[a]},getDragManager:function(b){return new v(b)},setRenderMode:function(f){var e;if(f){f=f.toLowerCase();var h=this.isRenderModeAvailable("svg"),g=this.isRenderModeAvailable("vml");"svg"===f?h?e="svg":g&&(e="vml"):g&&(e="vml")}return e},addClass:function(d,c){q(d,function(b){r(b,!0,c)})},hasClass:function(d,c){return d=jsPlumb.getDOMElement(d),d.classList?d.classList.contains(c):-1!=s(d).indexOf(c)},removeClass:function(d,c){q(d,function(b){r(b,!1,c)})},setClass:function(d,c){q(d,function(b){t(b,c)})},setPosition:function(d,c){d.style.left=c.left+"px",d.style.top=c.top+"px"},getPosition:function(d){var c=function(a){var e=d.style[a];return e?e.substring(0,e.length-2):0};return{left:c("left"),top:c("top")}},getOffset:function(i,h,o){i=jsPlumb.getDOMElement(i);for(var n=h.getContainer(),m=i.offsetLeft,l=i.offsetTop,k=o||null!=n&&i.offsetParent!=n?i.offsetParent:null;null!=k;){m+=k.offsetLeft,l+=k.offsetTop,k=o?k.offsetParent:k.offsetParent==n?null:k.offsetParent}return{left:m,top:l}},getPositionOnElement:function(Y,X,W){var V="undefined"!=typeof X.getBoundingClientRect?X.getBoundingClientRect():{left:0,top:0,width:0,height:0},U=document.body,T=document.documentElement,S=(X.offsetParent,window.pageYOffset||T.scrollTop||U.scrollTop),R=window.pageXOffset||T.scrollLeft||U.scrollLeft,Q=T.clientTop||U.clientTop||0,P=T.clientLeft||U.clientLeft||0,O=0,N=0,M=V.top+S-Q+O*W,L=V.left+R-P+N*W,K=jsPlumbAdapter.pageLocation(Y),J=V.width||X.offsetWidth*W,I=V.height||X.offsetHeight*W,H=(K[0]-L)/J,G=(K[1]-M)/I;return[H,G]}}}(),function(){var N=jsPlumbUtil,M=function(e,d,f){return jsPlumbAdapter.getOffset(e,d,f)},L=function(){return""+(new Date).getTime()},K=function(d){if(d._jsPlumb.paintStyle&&d._jsPlumb.hoverPaintStyle){var c={};u.extend(c,d._jsPlumb.paintStyle),u.extend(c,d._jsPlumb.hoverPaintStyle),delete d._jsPlumb.hoverPaintStyle,c.gradient&&d._jsPlumb.paintStyle.fillStyle&&delete c.gradient,d._jsPlumb.hoverPaintStyle=c}},J=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],I={mouseout:"mouseleave",mouseexit:"mouseleave"},H=function(i,h,o,n){var m=i.getAttachedElements();if(m){for(var l=0,k=m.length;k>l;l++){n&&n==m[l]||m[l].setHover(h,!0,o)}}},G=function(b){return null==b?null:b.split(" ")},F=function(a,o,n){if(a.getDefaultType){for(var m=a.getTypeDescriptor(),l=N.merge({},a.getDefaultType()),k=0,i=a._jsPlumb.types.length;i>k;k++){l=N.merge(l,a._jsPlumb.instance.getType(a._jsPlumb.types[k],m))}o&&(l=N.populate(l,o)),a.applyType(l,n),n||a.repaint()}},E=window.jsPlumbUIComponent=function(P){jsPlumbUtil.EventGenerator.apply(this,arguments);var O=this,t=arguments,s=O.idPrefix,r=s+(new Date).getTime();if(this._jsPlumb={instance:P._jsPlumb,parameters:P.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:P.beforeDetach,beforeDrop:P.beforeDrop,overlayPlacements:[],hoverClass:P.hoverClass||P._jsPlumb.Defaults.HoverClass,types:[]},this.getId=function(){return r},P.events){for(var q in P.events){O.bind(q,P.events[q])}}this.clone=function(){var b={};return this.constructor.apply(b,t),b}.bind(this),this.isDetachAllowed=function(g){var i=!0;if(this._jsPlumb.beforeDetach){try{i=this._jsPlumb.beforeDetach(g)}catch(h){N.log("jsPlumb: beforeDetach callback failed",h)}}return i},this.isDropAllowed=function(U,T,S,R,Q,n,m){var l=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:U,targetId:T,scope:S,connection:R,dropEndpoint:Q,source:n,target:m});if(this._jsPlumb.beforeDrop){try{l=this._jsPlumb.beforeDrop({sourceId:U,targetId:T,scope:S,connection:R,dropEndpoint:Q,source:n,target:m})}catch(k){N.log("jsPlumb: beforeDrop callback failed",k)}}return l};var p=[],o=function(g,d,h){p.push([g,d,h]),g.bind(d,h)},f=[],e=function(i,h,n,m){var l=I[n]||n,k=function(b){m&&m(b)===!1||h.fire(l,h,b)};f.push([i,n,k,h]),h._jsPlumb.instance.on(i,n,k)},a=function(h,g,k,i){I[g]||g,i._jsPlumb.instance.off(h,g,k)};this.bindListeners=function(g,d,h){o(g,"click",function(b,i){d.fire("click",d,i)}),o(g,"dblclick",function(b,i){d.fire("dblclick",d,i)}),o(g,"contextmenu",function(b,i){d.fire("contextmenu",d,i)}),o(g,"mouseleave",function(b,c){d.isHover()&&(h(!1),d.fire("mouseleave",d,c))}),o(g,"mouseenter",function(b,c){d.isHover()||(h(!0),d.fire("mouseenter",d,c))}),o(g,"mousedown",function(b,i){d.fire("mousedown",d,i)}),o(g,"mouseup",function(b,i){d.fire("mouseup",d,i)})},this.unbindListeners=function(){for(var d=0;d<p.length;d++){var c=p[d];c[0].unbind(c[1],c[2])}p=null},this.attachListeners=function(h,g,l){l=l||{};for(var k=0,i=J.length;i>k;k++){e(h,g,J[k],l[J[k]])}},this.detachListeners=function(){for(var b=0;b<f.length;b++){a(f[b][0],f[b][1],f[b][2],f[b][3])}f=null},this.reattachListenersForElement=function(g){if(arguments.length>1){for(var d=0,h=J.length;h>d;d++){a(g,J[d])}for(d=1,h=arguments.length;h>d;d++){this.attachListeners(g,arguments[d])}}}};jsPlumbUtil.extend(E,jsPlumbUtil.EventGenerator,{getParameter:function(b){return this._jsPlumb.parameters[b]},setParameter:function(d,c){this._jsPlumb.parameters[d]=c},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(b){this._jsPlumb.parameters=b},addClass:function(b){jsPlumbAdapter.addClass(this.canvas,b)},removeClass:function(b){jsPlumbAdapter.removeClass(this.canvas,b)},setType:function(e,d,f){this._jsPlumb.types=G(e)||[],F(this,d,f)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(d,c){F(this,d,c)},hasType:function(b){return -1!=jsPlumbUtil.indexOf(this._jsPlumb.types,b)},addType:function(i,h,o){var n=G(i),m=!1;if(null!=n){for(var l=0,k=n.length;k>l;l++){this.hasType(n[l])||(this._jsPlumb.types.push(n[l]),m=!0)}m&&F(this,h,o)}},removeType:function(a,n){var m=G(a),l=!1,k=function(d){var e=N.indexOf(this._jsPlumb.types,d);return -1!=e?(this._jsPlumb.types.splice(e,1),!0):!1}.bind(this);if(null!=m){for(var i=0,h=m.length;h>i;i++){l=k(m[i])||l}l&&F(this,null,n)}},toggleType:function(i,h,o){var n=G(i);if(null!=n){for(var m=0,l=n.length;l>m;m++){var k=jsPlumbUtil.indexOf(this._jsPlumb.types,n[m]);-1!=k?this._jsPlumb.types.splice(k,1):this._jsPlumb.types.push(n[m])}F(this,h,o)}},applyType:function(e,d){if(this.setPaintStyle(e.paintStyle,d),this.setHoverPaintStyle(e.hoverPaintStyle,d),e.parameters){for(var f in e.parameters){this.setParameter(f,e.parameters[f])}}},setPaintStyle:function(d,c){this._jsPlumb.paintStyle=d,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,K(this),c||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(d,c){this._jsPlumb.hoverPaintStyle=d,K(this),c||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},cleanup:function(){this.unbindListeners(),this.detachListeners()},destroy:function(){this.cleanupListeners(),this.clone=null,this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(f,c,h){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){if(this._jsPlumb.hover=f,null!=this.canvas){if(null!=this._jsPlumb.instance.hoverClass){var g=f?"addClass":"removeClass";this._jsPlumb.instance[g](this.canvas,this._jsPlumb.instance.hoverClass)}null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[g](this.canvas,this._jsPlumb.hoverClass)}null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=f?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(h=h||L(),this.repaint({timestamp:h,recalc:!1}))),this.getAttachedElements&&!c&&H(this,f,L(),this)}}});var D="__label",C=function(g,f){for(var k=-1,i=0,h=g._jsPlumb.overlays.length;h>i;i++){if(f===g._jsPlumb.overlays[i].id){k=i;break}}return k},B=function(f,e){var h={cssClass:e.cssClass,labelStyle:f.labelStyle,id:D,component:f,_jsPlumb:f._jsPlumb.instance},g=u.extend(h,e);return new (u.Overlays[f._jsPlumb.instance.getRenderMode()].Label)(g)},A=function(a,k){var i=null;if(N.isArray(k)){var h=k[0],g=u.extend({component:a,_jsPlumb:a._jsPlumb.instance},k[1]);3==k.length&&u.extend(g,k[2]),i=new (u.Overlays[a._jsPlumb.instance.getRenderMode()][h])(g)}else{i=k.constructor==String?new (u.Overlays[a._jsPlumb.instance.getRenderMode()][k])({component:a,_jsPlumb:a._jsPlumb.instance}):k}a._jsPlumb.overlays.push(i)},z=function(i,h){var o=i.defaultOverlayKeys||[],n=h.overlays,m=function(a){return i._jsPlumb.instance.Defaults[a]||u.Defaults[a]||[]};n||(n=[]);for(var l=0,k=o.length;k>l;l++){n.unshift.apply(n,m(o[l]))}return n},y=window.OverlayCapableJsPlumbUIComponent=function(h){E.apply(this,arguments),this._jsPlumb.overlays=[];var g=z(this,h);if(g){for(var m=0,l=g.length;l>m;m++){A(this,g[m])}}if(h.label){var k=h.labelLocation||this.defaultLabelLocation||0.5,i=h.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle;this._jsPlumb.overlays.push(B(this,{label:h.label,location:k,labelStyle:i}))}};jsPlumbUtil.extend(y,E,{applyType:function(f,e){if(this.removeAllOverlays(e),f.overlays){for(var h=0,g=f.overlays.length;g>h;h++){this.addOverlay(f.overlays[h],!0)}}},setHover:function(e){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){for(var d=0,f=this._jsPlumb.overlays.length;f>d;d++){this._jsPlumb.overlays[d][e?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)}}},addOverlay:function(d,c){A(this,d),c||this.repaint()},getOverlay:function(d){var c=C(this,d);return c>=0?this._jsPlumb.overlays[c]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(d){var c=this.getOverlay(d);c&&c.hide()},hideOverlays:function(){for(var d=0,c=this._jsPlumb.overlays.length;c>d;d++){this._jsPlumb.overlays[d].hide()}},showOverlay:function(d){var c=this.getOverlay(d);c&&c.show()},showOverlays:function(){for(var d=0,c=this._jsPlumb.overlays.length;c>d;d++){this._jsPlumb.overlays[d].show()}},removeAllOverlays:function(e){for(var d=0,f=this._jsPlumb.overlays.length;f>d;d++){this._jsPlumb.overlays[d].cleanup&&this._jsPlumb.overlays[d].cleanup()}this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length),this._jsPlumb.overlayPositions=null,e||this.repaint()},removeOverlay:function(e){var d=C(this,e);if(-1!=d){var f=this._jsPlumb.overlays[d];f.cleanup&&f.cleanup(),this._jsPlumb.overlays.splice(d,1),this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[e]}},removeOverlays:function(){for(var d=0,c=arguments.length;c>d;d++){this.removeOverlay(arguments[d])}},moveParent:function(d){this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),d.appendChild(this.bgCanvas)),this.canvas.parentNode.removeChild(this.canvas),d.appendChild(this.canvas);for(var c=0;c<this._jsPlumb.overlays.length;c++){this._jsPlumb.overlays[c].isAppendedAtTopLevel&&(this._jsPlumb.overlays[c].canvas.parentNode.removeChild(this._jsPlumb.overlays[c].canvas),d.appendChild(this._jsPlumb.overlays[c].canvas))}},getLabel:function(){var b=this.getOverlay(D);return null!=b?b.getLabel():null},getLabelOverlay:function(){return this.getOverlay(D)},setLabel:function(e){var d=this.getOverlay(D);if(d){e.constructor==String||e.constructor==Function?d.setLabel(e):(e.label&&d.setLabel(e.label),e.location&&d.setLocation(e.location))}else{var f=e.constructor==String||e.constructor==Function?{label:e}:e;d=B(this,f),this._jsPlumb.overlays.push(d)}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(){for(var b=0;b<this._jsPlumb.overlays.length;b++){this._jsPlumb.overlays[b].cleanup(),this._jsPlumb.overlays[b].destroy()}this._jsPlumb.overlays.splice(0),this._jsPlumb.overlayPositions=null},setVisible:function(b){this[b?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(d,c){this._jsPlumb.overlayPositions=this._jsPlumb.overlayPositions||{},this._jsPlumb.overlayPositions[d.id]=c},getAbsoluteOverlayPosition:function(b){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[b.id]:null}});var x=0,w=function(){var b=x+1;return x++,b},v=window.jsPlumbInstance=function(aC){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},aC&&u.extend(this.Defaults,aC),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},jsPlumbUtil.EventGenerator.apply(this);var aA=this,az=w(),ay=aA.bind,ax={},aw=1,au=function(e){var d=aA.getDOMElement(e);return{el:d,id:jsPlumbUtil.isString(e)&&null==d?e:aG(d)}};this.getInstanceIndex=function(){return az},this.setZoom=function(e,d){return jsPlumbUtil.oldIE||(aw=e,aA.fire("zoom",aw),d&&aA.repaintEverything()),!jsPlumbUtil.oldIE},this.getZoom=function(){return aw};for(var at in this.Defaults){ax[at]=this.Defaults[at]}var ar;this.setContainer=function(d){d=this.getDOMElement(d),this.select().each(function(e){e.moveParent(d)}),this.selectEndpoints().each(function(e){e.moveParent(d)}),ar=d},this.getContainer=function(){return ar},this.bind=function(e,d){"ready"===e&&ao?d():ay.apply(aA,[e,d])},aA.importDefaults=function(e){for(var d in e){aA.Defaults[d]=e[d]}return e.Container&&this.setContainer(e.Container),aA},aA.restoreDefaults=function(){return aA.Defaults=u.extend({},ax),aA};var aq=null,ao=!1,an=[],am={},al={},ak={},aj={},ai={},ah={},ag=!1,af=[],a7=!1,a6=null,a5=this.Defaults.Scope,a4=null,a3=1,a1=function(){return""+a3++},a0=function(e,d){ar?ar.appendChild(e):d?u.getDOMElement(d).appendChild(e):aA.appendToRoot(e)},aZ=function(d){return d._nodes?d._nodes:d},aY=function(O,s,q,p){if(!jsPlumbAdapter.headless&&!a7){var o=aG(O),n=aA.dragManager.getElementsForDraggable(o);null==q&&(q=L());var m=aI({elId:o,offset:s,recalc:!1,timestamp:q});if(n){for(var l in n){aI({elId:n[l].id,offset:{left:m.o.left+n[l].offset.left,top:m.o.top+n[l].offset.top},recalc:!1,timestamp:q})}}if(aA.anchorManager.redraw(o,s,q,null,p),n){for(var e in n){aA.anchorManager.redraw(n[e].id,s,q,n[e].offset,p,!0)}}}},aX=function(e,q){var p,o,n,m=null;if(N.isArray(e)){m=[];for(var l=0,k=e.length;k>l;l++){p=aA.getElementObject(e[l]),n=aA.getDOMElement(p),o=aA.getAttribute(n,"id"),m.push(q.apply(aA,[n,o]))}}else{p=aA.getDOMElement(e),o=aA.getId(p),m=q.apply(aA,[p,o])}return m},aV=function(d){return al[d]},aU=function(Q,P,O){if(!jsPlumbAdapter.headless){var s=null==P?!1:P;if(s&&u.isDragSupported(Q,aA)&&!u.isAlreadyDraggable(Q,aA)){var q=O||aA.Defaults.DragOptions;q=u.extend({},q);var p=u.dragEvents.drag,o=u.dragEvents.stop,n=u.dragEvents.start;q[n]=N.wrap(q[n],function(){return aA.setHoverSuspended(!0),aA.select({source:Q}).addClass(aA.elementDraggingClass+" "+aA.sourceElementDraggingClass,!0),aA.select({target:Q}).addClass(aA.elementDraggingClass+" "+aA.targetElementDraggingClass,!0),aA.setConnectionBeingDragged(!0),q.canDrag?O.canDrag():void 0},!1),q[p]=N.wrap(q[p],function(){var d=aA.getUIPosition(arguments,aA.getZoom());aY(Q,d,null,!0),aA.addClass(Q,"jsPlumb_dragged")}),q[o]=N.wrap(q[o],function(){var d=aA.getUIPosition(arguments,aA.getZoom(),!0);aY(Q,d),aA.removeClass(Q,"jsPlumb_dragged"),aA.setHoverSuspended(!1),aA.select({source:Q}).removeClass(aA.elementDraggingClass+" "+aA.sourceElementDraggingClass,!0),aA.select({target:Q}).removeClass(aA.elementDraggingClass+" "+aA.targetElementDraggingClass,!0),aA.setConnectionBeingDragged(!1),aA.dragManager.dragEnded(Q)});var m=aG(Q);ah[m]=!0;var e=ah[m];q.disabled=null==e?!1:!e,aA.initDraggable(Q,q,!1),aA.dragManager.register(Q)}}},aT=function(e,q){var p=u.extend({},e);if(q&&u.extend(p,q),p.source&&(p.source.endpoint?p.sourceEndpoint=p.source:p.source=aA.getDOMElement(p.source)),p.target&&(p.target.endpoint?p.targetEndpoint=p.target:p.target=aA.getDOMElement(p.target)),e.uuids&&(p.sourceEndpoint=aV(e.uuids[0]),p.targetEndpoint=aV(e.uuids[1])),p.sourceEndpoint&&p.sourceEndpoint.isFull()){return N.log(aA,"could not add connection; source endpoint is full"),void 0}if(p.targetEndpoint&&p.targetEndpoint.isFull()){return N.log(aA,"could not add connection; target endpoint is full"),void 0}if(!p.type&&p.sourceEndpoint&&(p.type=p.sourceEndpoint.connectionType),p.sourceEndpoint&&p.sourceEndpoint.connectorOverlays){p.overlays=p.overlays||[];for(var o=0,n=p.sourceEndpoint.connectorOverlays.length;n>o;o++){p.overlays.push(p.sourceEndpoint.connectorOverlays[o])}}!p["pointer-events"]&&p.sourceEndpoint&&p.sourceEndpoint.connectorPointerEvents&&(p["pointer-events"]=p.sourceEndpoint.connectorPointerEvents);var m,l,k;if(p.target&&!p.target.endpoint&&!p.targetEndpoint&&!p.newConnection&&(m=aG(p.target),l=this.targetEndpointDefinitions[m])){if(!l.enabled){return}l.isTarget=!0,k=null!=l.endpoint&&l.endpoint._jsPlumb?l.endpoint:aA.addEndpoint(p.target,l.def),l.uniqueEndpoint&&(l.endpoint=k),p.targetEndpoint=k,k._doNotDeleteOnDetach=!1,k._deleteOnDetach=!0}if(p.source&&!p.source.endpoint&&!p.sourceEndpoint&&!p.newConnection&&(m=aG(p.source),l=this.sourceEndpointDefinitions[m])){if(!l.enabled){return}k=null!=l.endpoint&&l.endpoint._jsPlumb?l.endpoint:aA.addEndpoint(p.source,l.def),l.uniqueEndpoint&&(l.endpoint=k),p.sourceEndpoint=k,k._doNotDeleteOnDetach=!1,k._deleteOnDetach=!0}return p}.bind(aA),aS=function(e){var d=aA.Defaults.ConnectionType||aA.getDefaultConnectionType();aA.Defaults.EndpointType||u.Endpoint,e._jsPlumb=aA,e.newConnection=aS,e.newEndpoint=aO,e.endpointsByUUID=al,e.endpointsByElement=am,e.finaliseConnection=aR;var f=new d(e);return f.id="con_"+a1(),aQ("click","click",f),aQ("dblclick","dblclick",f),aQ("contextmenu","contextmenu",f),f.isDetachable()&&(f.endpoints[0].initDraggable(),f.endpoints[1].initDraggable()),f},aR=function(g,e,k,i){if(e=e||{},g.suspendedEndpoint||an.push(g),(null==g.suspendedEndpoint||i)&&aA.anchorManager.newConnection(g),aY(g.source),!e.doNotFireConnectionEvent&&e.fireEvent!==!1){var h={connection:g,source:g.source,target:g.target,sourceId:g.sourceId,targetId:g.targetId,sourceEndpoint:g.endpoints[0],targetEndpoint:g.endpoints[1]};aA.fire("connection",h,k)}},aQ=function(e,d,f){f.bind(e,function(g,h){aA.fire(d,f,h)})},aO=function(f){var e=aA.Defaults.EndpointType||u.Endpoint,h=u.extend({},f);h._jsPlumb=aA,h.newConnection=aS,h.newEndpoint=aO,h.endpointsByUUID=al,h.endpointsByElement=am,h.finaliseConnection=aR,h.fireDetachEvent=aE,h.fireMoveEvent=a9,h.floatingConnections=ai,h.elementId=aG(h.source);var g=new e(h);return g.id="ep_"+a1(),aQ("click","endpointClick",g),aQ("dblclick","endpointDblClick",g),aQ("contextmenu","contextmenu",g),jsPlumbAdapter.headless||aA.dragManager.endpointAdded(h.source),g},aN=function(O,s,q){var p=am[O];if(p&&p.length){for(var o=0,n=p.length;n>o;o++){for(var m=0,l=p[o].connections.length;l>m;m++){var k=s(p[o].connections[m]);if(k){return}}q&&q(p[o])}}},aM=function(e,d){return aX(e,function(f,g){ah[g]=d,this.isDragSupported(f)&&this.setElementDraggable(f,d)})},aL=function(g,f,k){f="block"===f;var i=null;k&&(i=f?function(d){d.setVisible(!0,!0,!0)}:function(d){d.setVisible(!1,!0,!0)});var h=au(g);aN(h.id,function(e){if(f&&k){var l=e.sourceId===h.id?1:0;e.endpoints[l].isVisible()&&e.setVisible(!0)}else{e.setVisible(f)}},i)},aK=function(d){return aX(d,function(f,e){var g=null==ah[e]?!1:ah[e];return g=!g,ah[e]=g,this.setDraggable(f,g),g})},aJ=function(e,d){var f=null;d&&(f=function(h){var g=h.isVisible();h.setVisible(!g)}),aN(e,function(h){var g=h.isVisible();h.setVisible(!g)},f)},aI=this.updateOffset=function(e){var n,m=e.timestamp,l=e.recalc,k=e.offset,i=e.elId;return a7&&!m&&(m=a6),!l&&m&&m===aj[i]?{o:e.offset||ak[i],s:af[i]}:(l||!k?(n=document.getElementById(i),null!=n&&(af[i]=aA.getSize(n),ak[i]=M(n,aA),aj[i]=m)):(ak[i]=k,null==af[i]&&(n=document.getElementById(i),null!=n&&(af[i]=aA.getSize(n))),aj[i]=m),ak[i]&&!ak[i].right&&(ak[i].right=ak[i].left+af[i][0],ak[i].bottom=ak[i].top+af[i][1],ak[i].width=af[i][0],ak[i].height=af[i][1],ak[i].centerx=ak[i].left+ak[i].width/2,ak[i].centery=ak[i].top+ak[i].height/2),{o:ak[i],s:af[i]})},aH=function(e){var d=ak[e];return d?{o:d,s:af[e]}:aI({elId:e})},aG=function(f,e,h){if(jsPlumbUtil.isString(f)){return f}if(null==f){return null}var g=aA.getAttribute(f,"id");return g&&"undefined"!==g||(2==arguments.length&&void 0!==arguments[1]?g=e:(1==arguments.length||3==arguments.length&&!arguments[2])&&(g="jsPlumb_"+az+"_"+a1()),h||aA.setAttribute(f,"id",g)),g};this.setConnectionBeingDragged=function(d){ag=d},this.isConnectionBeingDragged=function(){return ag},this.connectorClass="_jsPlumb_connector",this.hoverClass="_jsPlumb_hover",this.endpointClass="_jsPlumb_endpoint",this.endpointConnectedClass="_jsPlumb_endpoint_connected",this.endpointFullClass="_jsPlumb_endpoint_full",this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed",this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden",this.overlayClass="_jsPlumb_overlay",this.draggingClass="_jsPlumb_dragging",this.elementDraggingClass="_jsPlumb_element_dragging",this.sourceElementDraggingClass="_jsPlumb_source_element_dragging",this.targetElementDraggingClass="_jsPlumb_target_element_dragging",this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor",this.hoverSourceClass="_jsPlumb_source_hover",this.hoverTargetClass="_jsPlumb_target_hover",this.dragSelectClass="_jsPlumb_drag_select",this.Anchors={},this.Connectors={svg:{},vml:{}},this.Endpoints={svg:{},vml:{}},this.Overlays={svg:{},vml:{}},this.ConnectorRenderers={},this.SVG="svg",this.VML="vml",this.addEndpoint=function(Z,Y,X){X=X||{};var W=u.extend({},X);u.extend(W,Y),W.endpoint=W.endpoint||aA.Defaults.Endpoint,W.paintStyle=W.paintStyle||aA.Defaults.EndpointStyle,Z=aZ(Z);for(var V=[],U=N.isArray(Z)||null!=Z.length&&!N.isString(Z)?Z:[Z],T=0,S=U.length;S>T;T++){var R=aA.getDOMElement(U[T]),Q=aG(R);W.source=R,r(W.source),aI({elId:Q,timestamp:a6});var P=aO(W);W.parentAnchor&&(P.parentAnchor=W.parentAnchor),N.addToList(am,Q,P);var O=ak[Q],s=af[Q],q=P.anchor.compute({xy:[O.left,O.top],wh:s,element:P,timestamp:a6}),e={anchorLoc:q,timestamp:a6};a7&&(e.recalc=!1),a7||P.paint(e),V.push(P),P._doNotDeleteOnDetach=!0}return 1==V.length?V[0]:V},this.addEndpoints=function(e,p,o){for(var n=[],m=0,l=p.length;l>m;m++){var k=aA.addEndpoint(e,p[m],o);N.isArray(k)?Array.prototype.push.apply(n,k):n.push(k)}return n},this.animate=function(e,q,p){p=p||{};var o=this.getElementObject(e),n=this.getDOMElement(e),m=aG(n),l=u.animEvents.step,k=u.animEvents.complete;p[l]=N.wrap(p[l],function(){aA.repaint(m)}),p[k]=N.wrap(p[k],function(){aA.repaint(m)}),aA.doAnimate(o,q,p)},this.checkCondition=function(e,p){var o=aA.getListener(e),n=!0;if(o&&o.length>0){try{for(var m=0,l=o.length;l>m;m++){n=n&&o[m](p)}}catch(k){N.log(aA,"cannot check condition ["+e+"]"+k)}}return n},this.checkASyncCondition=function(e,n,m,l){var k=aA.getListener(e);if(k&&k.length>0){try{k[0](n,m,l)}catch(i){N.log(aA,"cannot asynchronously check condition ["+e+"]"+i)}}},this.connect=function(f,e){var h,g=aT(f,e);return g&&(r(g.source),h=aS(g),aR(h,g)),h};var aF=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],bd=function(R,Q,P,O){var s,q,p,o=aF[P],n=R[o.elId],m=(R[o.el],R.endpoints[P]),l={index:P,originalSourceId:0===P?n:R.sourceId,newSourceId:R.sourceId,originalTargetId:1==P?n:R.targetId,newTargetId:R.targetId,connection:R};if(Q.constructor==u.Endpoint){s=Q,s.addConnection(R)}else{if(q=aG(Q),p=this[o.epDefs][q],q===R[o.elId]){s=null}else{if(p){if(!p.enabled){return}s=null!=p.endpoint&&p.endpoint._jsPlumb?p.endpoint:this.addEndpoint(Q,p.def),p.uniqueEndpoint&&(p.endpoint=s),s._doNotDeleteOnDetach=!1,s._deleteOnDetach=!0,s.addConnection(R)}else{s=R.makeEndpoint(0===P,Q,q),s._doNotDeleteOnDetach=!1,s._deleteOnDetach=!0}}}return null!=s&&(m.detachFromConnection(R),R.endpoints[P]=s,R[o.el]=s.element,R[o.elId]=s.elementId,l[0===P?"newSourceId":"newTargetId"]=s.elementId,a9(l),O||R.repaint()),l}.bind(this);this.setSource=function(f,e,h){var g=bd(f,e,0,h);this.anchorManager.sourceChanged(g.originalSourceId,g.newSourceId,f)},this.setTarget=function(f,e,h){var g=bd(f,e,1,h);this.anchorManager.updateOtherEndpoint(g.originalSourceId,g.originalTargetId,g.newTargetId,f)},this.deleteEndpoint=function(f,e){var h=aA.setSuspendDrawing(!0),g="string"==typeof f?al[f]:f;return g&&aA.deleteObject({endpoint:g}),h||aA.setSuspendDrawing(!1,e),aA},this.deleteEveryEndpoint=function(){var g=aA.setSuspendDrawing(!0);for(var e in am){var k=am[e];if(k&&k.length){for(var i=0,h=k.length;h>i;i++){aA.deleteEndpoint(k[i],!0)}}}return am={},al={},aA.anchorManager.reset(),aA.dragManager.reset(),g||aA.setSuspendDrawing(!1),aA};var aE=function(h,e,m){var l=aA.Defaults.ConnectionType||aA.getDefaultConnectionType(),k=h.constructor==l,i=k?{connection:h,source:h.source,target:h.target,sourceId:h.sourceId,targetId:h.targetId,sourceEndpoint:h.endpoints[0],targetEndpoint:h.endpoints[1]}:h;e&&aA.fire("connectionDetached",i,m),aA.anchorManager.connectionDetached(i)},a9=function(e,d){aA.fire("connectionMoved",e,d)};this.unregisterEndpoint=function(h){h._jsPlumb.uuid&&(al[h._jsPlumb.uuid]=null),aA.anchorManager.deleteEndpoint(h);for(var e in am){var m=am[e];if(m){for(var l=[],k=0,i=m.length;i>k;k++){m[k]!=h&&l.push(m[k])}am[e]=l}am[e].length<1&&delete am[e]}},this.detach=function(){if(0!==arguments.length){var s=aA.Defaults.ConnectionType||aA.getDefaultConnectionType(),q=arguments[0].constructor==s,p=2==arguments.length?q?arguments[1]||{}:arguments[0]:arguments[0],o=p.fireEvent!==!1,n=p.forceDetach,m=q?arguments[0]:p.connection;if(m){(n||jsPlumbUtil.functionChain(!0,!1,[[m.endpoints[0],"isDetachAllowed",[m]],[m.endpoints[1],"isDetachAllowed",[m]],[m,"isDetachAllowed",[m]],[aA,"checkCondition",["beforeDetach",m]]]))&&m.endpoints[0].detach(m,!1,!0,o)}else{var l=u.extend({},p);if(l.uuids){aV(l.uuids[0]).detachFrom(aV(l.uuids[1]),o)}else{if(l.sourceEndpoint&&l.targetEndpoint){l.sourceEndpoint.detachFrom(l.targetEndpoint)}else{var k=aG(aA.getDOMElement(l.source)),e=aG(aA.getDOMElement(l.target));aN(k,function(d){(d.sourceId==k&&d.targetId==e||d.targetId==k&&d.sourceId==e)&&aA.checkCondition("beforeDetach",d)&&d.endpoints[0].detach(d,!1,!0,o)})}}}}},this.detachAllConnections=function(h,e){e=e||{},h=aA.getDOMElement(h);var m=aG(h),l=am[m];if(l&&l.length){for(var k=0,i=l.length;i>k;k++){l[k].detachAll(e.fireEvent!==!1)}}return aA},this.detachEveryConnection=function(d){return d=d||{},aA.doWhileSuspended(function(){for(var f in am){var i=am[f];if(i&&i.length){for(var h=0,g=i.length;g>h;h++){i[h].detachAll(d.fireEvent!==!1)}}}an.splice(0)}),aA},this.deleteObject=function(P){var O={endpoints:{},connections:{},endpointCount:0,connectionCount:0},s=P.fireEvent!==!1,q=P.deleteAttachedObjects!==!1,p=function(d){if(null!=d&&null==O.connections[d.id]&&(null!=d._jsPlumb&&d.setHover(!1),O.connections[d.id]=d,O.connectionCount++,q)){for(var f=0;f<d.endpoints.length;f++){d.endpoints[f]._deleteOnDetach&&o(d.endpoints[f])}}},o=function(d){if(null!=d&&null==O.endpoints[d.id]&&(null!=d._jsPlumb&&d.setHover(!1),O.endpoints[d.id]=d,O.endpointCount++,q)){for(var g=0;g<d.connections.length;g++){var f=d.connections[g];p(f)}}};P.connection?p(P.connection):o(P.endpoint);for(var n in O.connections){var m=O.connections[n];m._jsPlumb&&(jsPlumbUtil.removeWithFunction(an,function(d){return m.id==d.id}),aE(m,s,P.originalEvent),m.endpoints[0].detachFromConnection(m),m.endpoints[1].detachFromConnection(m),m.cleanup(),m.destroy())}for(var l in O.endpoints){var e=O.endpoints[l];e._jsPlumb&&(aA.unregisterEndpoint(e),e.cleanup(),e.destroy())}return O},this.draggable=function(g,e){var k,i,h;if("object"==typeof g&&g.length){for(k=0,i=g.length;i>k;k++){h=aA.getDOMElement(g[k]),h&&aU(h,!0,e)}}else{if(g._nodes){for(k=0,i=g._nodes.length;i>k;k++){h=aA.getDOMElement(g._nodes[k]),h&&aU(h,!0,e)}}else{h=aA.getDOMElement(g),h&&aU(h,!0,e)}}return aA};var aP=function(h,g,m,l){for(var k=0,i=h.length;i>k;k++){h[k][g].apply(h[k],m)}return l(h)},ap=function(h,g,m){for(var l=[],k=0,i=h.length;i>k;k++){l.push([h[k][g].apply(h[k],m),h[k]])}return l},aa=function(e,d,f){return function(){return aP(e,d,arguments,f)}},b=function(e,d){return function(){return ap(e,d,arguments)}},bf=function(g,f){var k=[];if(g){if("string"==typeof g){if("*"===g){return g}k.push(g)}else{if(f){k=g}else{if(g.length){for(var i=0,h=g.length;h>i;i++){k.push(au(g[i]).id)}}else{k.push(au(g).id)}}}}return k},ba=function(e,d,f){return"*"===e?!0:e.length>0?-1!=jsPlumbUtil.indexOf(e,d):!f};this.getConnections=function(R,Q){R?R.constructor==String&&(R={scope:R}):R={};for(var P=R.scope||aA.getDefaultScope(),O=bf(P,!0),s=bf(R.source),q=bf(R.target),p=!Q&&O.length>1?{}:[],o=function(d,g){if(!Q&&O.length>1){var f=p[d];null==f&&(f=p[d]=[]),f.push(g)}else{p.push(g)}},n=0,m=an.length;m>n;n++){var e=an[n];ba(O,e.scope)&&ba(s,e.sourceId)&&ba(q,e.targetId)&&o(e.scope,e)}return p};var aW=function(e,d){return function(h){for(var g=0,f=e.length;f>g;g++){h(e[g])}return d(e)}},av=function(d){return function(e){return d[e]}},ac=function(i,h){var o,n,m={length:i.length,each:aW(i,h),get:av(i)},l=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],k=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(o=0,n=l.length;n>o;o++){m[l[o]]=aa(i,l[o],h)}for(o=0,n=k.length;n>o;o++){m[k[o]]=b(i,k[o])}return m},c=function(e){var d=ac(e,c);return u.extend(d,{setDetachable:aa(e,"setDetachable",c),setReattach:aa(e,"setReattach",c),setConnector:aa(e,"setConnector",c),detach:function(){for(var f=0,g=e.length;g>f;f++){aA.detach(e[f])}},isDetachable:b(e,"isDetachable"),isReattach:b(e,"isReattach")})},bg=function(e){var d=ac(e,bg);return u.extend(d,{setEnabled:aa(e,"setEnabled",bg),setAnchor:aa(e,"setAnchor",bg),isEnabled:b(e,"isEnabled"),detachAll:function(){for(var f=0,g=e.length;g>f;f++){e[f].detachAll()}},remove:function(){for(var f=0,g=e.length;g>f;f++){aA.deleteObject({endpoint:e[f]})}}})};this.select=function(d){return d=d||{},d.scope=d.scope||"*",c(d.connections||aA.getConnections(d,!0))},this.selectEndpoints=function(bk){bk=bk||{},bk.scope=bk.scope||"*";var bj=!bk.element&&!bk.source&&!bk.target,bi=bj?"*":bf(bk.element),bb=bj?"*":bf(bk.source),ab=bj?"*":bf(bk.target),Z=bf(bk.scope,!0),Y=[];for(var X in am){var W=ba(bi,X,!0),V=ba(bb,X,!0),U="*"!=bb,T=ba(ab,X,!0),S="*"!=ab;if(W||V||T){bk:for(var R=0,Q=am[X].length;Q>R;R++){var P=am[X][R];if(ba(Z,P.scope,!0)){var O=U&&bb.length>0&&!P.isSource,q=S&&ab.length>0&&!P.isTarget;if(O||q){continue bk}Y.push(P)}}}}return bg(Y)},this.getAllConnections=function(){return an},this.getDefaultScope=function(){return a5},this.getEndpoint=aV,this.getEndpoints=function(d){return am[au(d).id]},this.getDefaultEndpointType=function(){return u.Endpoint},this.getDefaultConnectionType=function(){return u.Connection},this.getId=aG,this.getOffset=function(d){return ak[d],aI({elId:d})},this.appendElement=a0;var bc=!1;this.isHoverSuspended=function(){return bc},this.setHoverSuspended=function(d){bc=d};var a2=function(d){return function(){return jsPlumbAdapter.isRenderModeAvailable(d)}};this.isSVGAvailable=a2("svg"),this.isVMLAvailable=a2("vml"),this.hide=function(e,d){return aL(e,"none",d),aA},this.idstamp=a1,this.connectorsInitialized=!1;var aB=[],ad=["svg","vml"];this.registerConnectorType=function(e,d){aB.push([e,d])};var r=function(e){if(!ar&&e){var d=aA.getDOMElement(e);d.offsetParent&&(ar=d.offsetParent)}},bh=function(){aA.Defaults.Container&&(ar=aA.getDOMElement(aA.Defaults.Container))};this.init=function(){var e=function(h,g,i){u.Connectors[h][g]=function(){i.apply(this,arguments),u.ConnectorRenderers[h].apply(this,arguments)},jsPlumbUtil.extend(u.Connectors[h][g],[i,u.ConnectorRenderers[h]])};if(!u.connectorsInitialized){for(var d=0;d<aB.length;d++){for(var f=0;f<ad.length;f++){e(ad[f],aB[d][1],aB[d][0])}}u.connectorsInitialized=!0}ao||(bh(),aA.anchorManager=new u.AnchorManager({jsPlumbInstance:aA}),aA.setRenderMode(aA.Defaults.RenderMode),ao=!0,aA.fire("ready",aA))}.bind(this),this.log=aq,this.jsPlumbUIComponent=E,this.makeAnchor=function(){var e,p=function(f,d){if(u.Anchors[f]){return new u.Anchors[f](d)}if(!aA.Defaults.DoNotThrowErrors){throw {msg:"jsPlumb: unknown anchor type '"+f+"'"}}};if(0===arguments.length){return null}var o=arguments[0],n=arguments[1],m=arguments[2],l=null;if(o.compute&&o.getOrientation){return o}if("string"==typeof o){l=p(arguments[0],{elementId:n,jsPlumbInstance:aA})}else{if(N.isArray(o)){if(N.isArray(o[0])||N.isString(o[0])){2==o.length&&N.isObject(o[1])?N.isString(o[0])?(e=u.extend({elementId:n,jsPlumbInstance:aA},o[1]),l=p(o[0],e)):(e=u.extend({elementId:n,jsPlumbInstance:aA,anchors:o[0]},o[1]),l=new u.DynamicAnchor(e)):l=new u.DynamicAnchor({anchors:o,selector:null,elementId:n,jsPlumbInstance:m})}else{var k={x:o[0],y:o[1],orientation:o.length>=4?[o[2],o[3]]:[0,0],offsets:o.length>=6?[o[4],o[5]]:[0,0],elementId:n,jsPlumbInstance:m,cssClass:7==o.length?o[6]:null};l=new u.Anchor(k),l.clone=function(){return new u.Anchor(k)}}}}return l.id||(l.id="anchor_"+a1()),l},this.makeAnchors=function(e,n,m){for(var l=[],k=0,i=e.length;i>k;k++){"string"==typeof e[k]?l.push(u.Anchors[e[k]]({elementId:n,jsPlumbInstance:m})):N.isArray(e[k])&&l.push(aA.makeAnchor(e[k],n,m))}return l},this.makeDynamicAnchor=function(e,d){return new u.DynamicAnchor({anchors:e,selector:d,elementId:null,jsPlumbInstance:aA})},this.targetEndpointDefinitions={};var be=function(e,d,f){e.paintStyle=e.paintStyle||f.Defaults.EndpointStyles[d]||f.Defaults.EndpointStyle,e.hoverPaintStyle=e.hoverPaintStyle||f.Defaults.EndpointHoverStyles[d]||f.Defaults.EndpointHoverStyle,e.anchor=e.anchor||f.Defaults.Anchors[d]||f.Defaults.Anchor,e.endpoint=e.endpoint||f.Defaults.Endpoints[d]||f.Defaults.Endpoint};this.sourceEndpointDefinitions={};var a8=function(O,s,q,p,o){for(var n=O.target||O.srcElement,m=!1,l=p.getSelector(s,q),k=0;k<l.length;k++){if(l[k]==n){m=!0;break}}return o?!m:m};this.makeTarget=function(W,V,U){var T=u.extend({_jsPlumb:this},U);u.extend(T,V),be(T,1,this);var S=T.scope||aA.Defaults.Scope,R=!(T.deleteEndpointsOnDetach===!1),Q=T.maxConnections||-1,P=T.onMaxConnections,O=function(X){var m=au(X),i=m.id,g=new E(T),q=u.extend({},T.dropOptions||{});r(i),this.targetEndpointDefinitions[i]={def:T,uniqueEndpoint:T.uniqueEndpoint,maxConnections:Q,enabled:!0};var l=function(){this.currentlyDragging=!1;var bp=this.getDropEvent(arguments),bm=this.select({target:i}).length,bk=this.getDOMElement(this.getDragObject(arguments)),bj=this.getAttribute(bk,"dragId"),bi=this.getAttribute(bk,"originalScope"),bb=ai[bj],ab=bb.endpoints[0].isFloating()?0:1,Z=bb.endpoints[0],Y=(T.endpoint?u.extend({},T.endpoint):{},this.targetEndpointDefinitions[i]);if(!Y.enabled||Y.maxConnections>0&&bm>=Y.maxConnections){return P&&P({element:m.el,connection:bb},bp),!1}if(Z.anchor.locked=!1,bi&&this.setDragScope(bk,bi),null==bb.suspendedEndpoint&&!bb.pending){return !1}var f=g.isDropAllowed(0===ab?i:bb.sourceId,0===ab?bb.targetId:i,bb.scope,bb,null,0===ab?m.el:bb.source,0===ab?bb.target:m.el);if(bb.suspendedEndpoint){bb[ab?"targetId":"sourceId"]=bb.suspendedEndpoint.elementId,bb[ab?"target":"source"]=bb.suspendedEndpoint.element,bb.endpoints[ab]=bb.suspendedEndpoint;var d=(bb.suspendedEndpoint.getElement(),bb.suspendedEndpoint.elementId);a9({index:ab,originalSourceId:0===ab?d:bb.sourceId,newSourceId:0===ab?i:bb.sourceId,originalTargetId:1==ab?d:bb.targetId,newTargetId:1==ab?i:bb.targetId,connection:bb},bp)}if(f){var bs=this.getElementObject(m.el),br=Y.endpoint;if((null==br||null==br._jsPlumb)&&(br=this.addEndpoint(bs,T)),T.uniqueEndpoint&&(Y.endpoint=br),br._doNotDeleteOnDetach=!1,br._deleteOnDetach=!0,null!=br.anchor.positionFinder){var bq=this.getUIPosition(arguments,this.getZoom()),bo=M(bs,this),bn=this.getSize(bs),bl=br.anchor.positionFinder(bq,bo,bn,br.anchor.constructorParams);br.anchor.x=bl[0],br.anchor.y=bl[1]}bb[ab?"target":"source"]=br.element,bb[ab?"targetId":"sourceId"]=br.elementId,bb.endpoints[ab].detachFromConnection(bb),bb.endpoints[ab]._deleteOnDetach&&(bb.endpoints[ab].deleteAfterDragStop=!0),br.addConnection(bb),bb.endpoints[ab]=br,bb.deleteEndpointsOnDetach=R,1==ab?this.anchorManager.updateOtherEndpoint(bb.sourceId,bb.suspendedElementId,bb.targetId,bb):this.anchorManager.sourceChanged(bb.suspendedEndpoint.elementId,bb.sourceId,bb),aR(bb,null,bp),bb.pending=!1}else{bb.suspendedEndpoint&&(bb.isReattach()?(bb.setHover(!1),bb.floatingAnchorIndex=null,bb.suspendedEndpoint.addConnection(bb),this.repaint(Z.elementId)):Z.detach(bb,!1,!0,!0,bp))}}.bind(this),h=u.dragEvents.drop;q.scope=q.scope||S,q[h]=N.wrap(q[h],l),this.initDroppable(this.getElementObject(m.el),q,!0)}.bind(this);W=aZ(W);for(var s=W.length&&W.constructor!=String?W:[W],k=0,e=s.length;e>k;k++){O(s[k])}return this},this.unmakeTarget=function(e,d){var f=au(e);return u.destroyDroppable(f.el),d||delete this.targetEndpointDefinitions[f.id],this},this.makeSource=function(R,Q,P){var O=u.extend({},P);u.extend(O,Q),be(O,0,this);var s=O.maxConnections||-1,q=O.onMaxConnections,m=function(Z){var Y=Z.id,X=this.getElementObject(Z.el),W=this.getDOMElement(X),V=function(){return null==O.parent?null:"parent"===O.parent?Z.el.parentNode:aA.getDOMElement(O.parent)},U=null!=O.parent?this.getId(V()):Y;r(U),this.sourceEndpointDefinitions[U]={def:O,uniqueEndpoint:O.uniqueEndpoint,maxConnections:s,enabled:!0};var T=u.dragEvents.stop,S=u.dragEvents.drag,h=u.extend({},O.dragOptions||{}),g=h.drag,bj=h.stop,bi=null,bb=!1;h.scope=h.scope||O.scope,h[S]=N.wrap(h[S],function(){g&&g.apply(this,arguments),bb=!1}),h[T]=N.wrap(h[T],function(){if(bj&&bj.apply(this,arguments),this.currentlyDragging=!1,null!=bi._jsPlumb){var bs=O.anchor||this.Defaults.Anchor,br=bi.anchor,bq=bi.connections[0],bp=this.makeAnchor(bs,Y,this),bo=bi.element;if(null!=bp.positionFinder){var bn=M(bo,this),bm=this.getSize(bo),bl={left:bn.left+br.x*bm[0],top:bn.top+br.y*bm[1]},bk=bp.positionFinder(bl,bn,bm,bp.constructorParams);bp.x=bk[0],bp.y=bk[1]}if(bi.setAnchor(bp,!0),O.parent){var l=V();if(l){var d=O.container||ar;bi.setElement(l,d)}}bi.repaint(),this.repaint(bi.elementId),this.repaint(bq.targetId)}}.bind(this));var ab=function(bm){var bl=this.getOriginalEvent(bm),bk=this.sourceEndpointDefinitions[U];if(Y=this.getId(this.getDOMElement(X)),bk.enabled){if(O.filter){var n=jsPlumbUtil.isString(O.filter)?a8(bl,X,O.filter,this,O.filterExclude):O.filter(bl,X);if(n===!1){return}}var l=this.select({source:U}).length;if(bk.maxConnections>=0&&l>=bk.maxConnections){return q&&q({element:X,maxConnections:s},bm),!1}var f=jsPlumbAdapter.getPositionOnElement(bl,W,aw),d=f;O.parent&&(d=jsPlumbAdapter.getPositionOnElement(bl,V(),aw));var bo={};u.extend(bo,O),bo.isSource=!0,bo.anchor=[f[0],f[1],0,0],bo.parentAnchor=[d[0],d[1],0,0],bo.dragOptions=h,bi=this.addEndpoint(Y,bo),bb=!0,bi.endpointWillMoveTo=O.parent?V():null,bi._doNotDeleteOnDetach=!1,bi._deleteOnDetach=!0;var bn=function(){bb&&(bb=!1,aA.deleteEndpoint(bi))};aA.registerListener(bi.canvas,"mouseup",bn),aA.registerListener(X,"mouseup",bn),aA.trigger(bi.canvas,"mousedown",bm),jsPlumbUtil.consume(bm)}}.bind(this);this.registerListener(X,"mousedown",ab),this.sourceEndpointDefinitions[U].trigger=ab,O.filter&&jsPlumbUtil.isString(O.filter)&&aA.setDragFilter(X,O.filter)}.bind(this);R=aZ(R);for(var k=R.length&&R.constructor!=String?R:[R],i=0,e=k.length;e>i;i++){m(au(k[i]))}return this},this.unmakeSource=function(f,e){var h=au(f),g=this.sourceEndpointDefinitions[h.id].trigger;return g&&aA.unregisterListener(h.el,"mousedown",g),e||delete this.sourceEndpointDefinitions[h.id],this},this.unmakeEverySource=function(){for(var d in this.sourceEndpointDefinitions){aA.unmakeSource(d,!0)}return this.sourceEndpointDefinitions={},this},this.unmakeEveryTarget=function(){for(var d in this.targetEndpointDefinitions){aA.unmakeTarget(d,!0)}return this.targetEndpointDefinitions={},this};var aD=function(O,s,q,p){var o="source"==O?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;if(s=aZ(s),N.isString(s)){o[s].enabled=p?!o[s].enabled:q}else{if(s.length){for(var n=0,m=s.length;m>n;n++){var l=au(s[n]);o[l.id]&&(o[l.id].enabled=p?!o[l.id].enabled:q)}}else{var k=au(s).id;o[k].enabled=p?!o[k].enabled:q}}return this}.bind(this),ae=function(d,e){return d=aZ(d),N.isString(d)||!d.length?e.apply(this,[d]):d.length?e.apply(this,[d[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(d){return aD("source",d,null,!0),this.isSourceEnabled(d)},this.setSourceEnabled=function(e,d){return aD("source",e,d)},this.isSource=function(d){return ae(d,function(e){return null!=this.sourceEndpointDefinitions[au(e).id]})},this.isSourceEnabled=function(d){return ae(d,function(f){var e=this.sourceEndpointDefinitions[au(f).id];return e&&e.enabled===!0})},this.toggleTargetEnabled=function(d){return aD("target",d,null,!0),this.isTargetEnabled(d)},this.isTarget=function(d){return ae(d,function(e){return null!=this.targetEndpointDefinitions[au(e).id]})},this.isTargetEnabled=function(d){return ae(d,function(f){var e=this.targetEndpointDefinitions[au(f).id];return e&&e.enabled===!0})},this.setTargetEnabled=function(e,d){return aD("target",e,d)},this.ready=function(d){aA.bind("ready",d)},this.repaint=function(g,e,k){if("object"==typeof g&&g.length){for(var i=0,h=g.length;h>i;i++){aY(g[i],e,k)}}else{aY(g,e,k)}return aA},this.repaintEverything=function(f){var e=L();for(var g in am){aY(g,null,e,f)}return this},this.removeAllEndpoints=function(e,d){var f=function(i){var n,m,l=au(i),k=am[l.id];if(k){for(n=0,m=k.length;m>n;n++){aA.deleteEndpoint(k[n])}}if(delete am[l.id],d&&l.el&&3!=l.el.nodeType&&8!=l.el.nodeType){for(n=0,m=l.el.childNodes.length;m>n;n++){f(l.el.childNodes[n])}}};return f(e),this},this.remove=function(e,d){var f=au(e);return aA.doWhileSuspended(function(){aA.removeAllEndpoints(f.id,!0),aA.dragManager.elementRemoved(f.id),delete ai[f.id],aA.anchorManager.clearFor(f.id),aA.anchorManager.removeFloatingConnection(f.id)},d===!1),f.el&&aA.removeElement(f.el),aA};var t={},a=function(){for(var f in t){for(var e=0,h=t[f].length;h>e;e++){var g=t[f][e];aA.off(g.el,g.event,g.listener)}}t={}};this.registerListener=function(e,d,f){aA.on(e,d,f),jsPlumbUtil.addToList(t,d,{el:e,event:d,listener:f})},this.unregisterListener=function(e,d,f){aA.off(e,d,f),jsPlumbUtil.removeWithFunction(t,function(g){return g.type==d&&g.listener==f})},this.reset=function(){aA.deleteEveryEndpoint(),aA.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},an.splice(0),a(),aA.anchorManager.reset(),jsPlumbAdapter.headless||aA.dragManager.reset()},this.setDefaultScope=function(d){return a5=d,aA},this.setDraggable=aM,this.setId=function(O,s,q){var p;jsPlumbUtil.isString(O)?p=O:(O=this.getDOMElement(O),p=this.getId(O));var o=this.getConnections({source:p,scope:"*"},!0),n=this.getConnections({target:p,scope:"*"},!0);s=""+s,q?O=this.getDOMElement(s):(O=this.getDOMElement(p),this.setAttribute(O,"id",s)),am[s]=am[p]||[];for(var m=0,l=am[s].length;l>m;m++){am[s][m].setElementId(s),am[s][m].setReferenceElement(O)}delete am[p],this.anchorManager.changeId(p,s),this.dragManager&&this.dragManager.changeId(p,s);var k=function(R,Q,P){for(var i=0,h=R.length;h>i;i++){R[i].endpoints[Q].setElementId(s),R[i].endpoints[Q].setReferenceElement(O),R[i][P+"Id"]=s,R[i][P]=O}};k(o,0,"source"),k(n,1,"target"),this.repaint(s)},this.setDebugLog=function(d){aq=d},this.setSuspendDrawing=function(e,d){var f=a7;return a7=e,a6=e?(new Date).getTime():null,d&&this.repaintEverything(),f},this.isSuspendDrawing=function(){return a7},this.getSuspendedAt=function(){return a6},this.doWhileSuspended=function(f,i){var h=this.isSuspendDrawing();h||this.setSuspendDrawing(!0);try{f()}catch(g){N.log("Function run while suspended failed",g)}h||this.setSuspendDrawing(!1,!i)},this.getOffset=function(d){return ak[d]},this.getCachedData=aH,this.timestamp=L,this.setRenderMode=function(d){if(d!==u.SVG&&d!==u.VML){throw new TypeError("Render mode ["+d+"] not supported")}return a4=jsPlumbAdapter.setRenderMode(d)},this.getRenderMode=function(){return a4},this.show=function(e,d){return aL(e,"block",d),aA},this.toggleVisible=aJ,this.toggleDraggable=aK,this.addListener=this.bind,jsPlumbAdapter.headless||(aA.dragManager=jsPlumbAdapter.getDragManager(aA),aA.recalculateOffsets=aA.dragManager.updateOffsets)};jsPlumbUtil.extend(v,jsPlumbUtil.EventGenerator,{setAttribute:function(e,d,f){this.setAttribute(e,d,f)},getAttribute:function(d,c){return this.getAttribute(u.getDOMElement(d),c)},registerConnectionType:function(d,c){this._connectionTypes[d]=u.extend({},c)},registerConnectionTypes:function(d){for(var c in d){this._connectionTypes[c]=u.extend({},d[c])}},registerEndpointType:function(d,c){this._endpointTypes[d]=u.extend({},c)},registerEndpointTypes:function(d){for(var c in d){this._endpointTypes[c]=u.extend({},d[c])}},getType:function(d,c){return"connection"===c?this._connectionTypes[d]:this._endpointTypes[d]},setIdChanged:function(d,c){this.setId(d,c,!0)},setParent:function(k,i){var q=this.getElementObject(k),p=this.getDOMElement(q),o=this.getId(p),n=this.getElementObject(i),m=this.getDOMElement(n),l=this.getId(m);p.parentNode.removeChild(p),m.appendChild(p),this.dragManager.setParent(q,o,n,l)},getSize:function(b){return[b.offsetWidth,b.offsetHeight]},getWidth:function(b){return b.offsetWidth},getHeight:function(b){return b.offsetHeight},extend:function(f,e,h){var g;if(h){for(g=0;g<h.length;g++){f[h[g]]=e[h[g]]}}else{for(g in e){f[g]=e[g]}}return f}},jsPlumbAdapter);var u=new v;"undefined"!=typeof window&&(window.jsPlumb=u),u.getInstance=function(d){var c=new v(d);return c.init(),c},"function"==typeof define&&(define("jsplumb",[],function(){return u}),define("jsplumbinstance",[],function(){return u.getInstance()})),"undefined"!=typeof exports&&(exports.jsPlumb=u)}(),function(){var h=function(e,d){var f=!1;return{drag:function(){if(f){return f=!1,!0}var a=jsPlumb.getUIPosition(arguments,d.getZoom());e.element&&(jsPlumbAdapter.setPosition(e.element,a),d.repaint(e.element,a))},stopDrag:function(){f=!0}}},g=function(n,f){var q=document.createElement("div");q.style.position="absolute";var p=f.getContainer()||document.body;p.appendChild(q);var o=f.getId(q);f.updateOffset({elId:o}),n.id=o,n.element=q},m=function(o,n,u,t,s,r,q){var p=new jsPlumb.FloatingAnchor({reference:n,referenceCanvas:t,jsPlumbInstance:r});return q({paintStyle:o,endpoint:u,anchor:p,source:s,scope:"__floating"})},l=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],k=function(f,e){var o=0;if(null!=e){for(var n=0;n<f.connections.length;n++){if(f.connections[n].sourceId==e||f.connections[n].targetId==e){o=n;break}}}return f.connections[o]},i=function(d,c){return jsPlumbUtil.findWithFunction(c.connections,function(a){return a.id==d.id})};jsPlumb.Endpoint=function(A){var z=A._jsPlumb,y=(jsPlumbAdapter.getAttribute,jsPlumb.getElementObject),x=jsPlumbUtil,w=A.newConnection,v=A.newEndpoint,f=A.finaliseConnection,e=(A.fireDetachEvent,A.fireMoveEvent),d=A.floatingConnections;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[0.5,0.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:this._jsPlumb.instance.Defaults.MaxConnections,paintStyle:this._jsPlumb.instance.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:this._jsPlumb.instance.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:this._jsPlumb.instance.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:this._jsPlumb.instance.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:A.connectorStyle,connectorHoverStyle:A.connectorHoverStyle,connectorClass:A.connectorClass,connectorHoverClass:A.connectorHoverClass,connectorOverlays:A.connectorOverlays,connector:A.connector,connectorTooltip:A.connectorTooltip}},this._jsPlumb.enabled=!(A.enabled===!1),this._jsPlumb.visible=!0,this.element=jsPlumb.getDOMElement(A.source),this._jsPlumb.uuid=A.uuid,this._jsPlumb.floatingEndpoint=null;var c=null;this._jsPlumb.uuid&&(A.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=A.elementId,this._jsPlumb.connectionCost=A.connectionCost,this._jsPlumb.connectionsDirected=A.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var b=function(){jsPlumbAdapter.removeClass(this.element,z.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.removeClass(z.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this._jsPlumb.currentAnchorClass=this.anchor.getCssClass(),this.addClass(z.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),jsPlumbAdapter.addClass(this.element,z.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass)}.bind(this);this.setAnchor=function(o,n){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=this._jsPlumb.instance.makeAnchor(o,this.elementId,z),b(),this.anchor.bind("anchorChanged",function(p){this.fire("anchorChanged",{endpoint:this,anchor:p}),b()}.bind(this)),n||this._jsPlumb.instance.repaint(this.elementId),this};var a=A.anchor?A.anchor:A.anchors?A.anchors:z.Defaults.Anchor||"Top";this.setAnchor(a,!0);var D=function(n){this.connections.length>0?this.connections[0].setHover(n,!1):this.setHover(n)}.bind(this);A._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.setEndpoint=function(o){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy());var n=function(r,q){var s=z.getRenderMode();if(jsPlumb.Endpoints[s][r]){return new jsPlumb.Endpoints[s][r](q)}if(!z.Defaults.DoNotThrowErrors){throw {msg:"jsPlumb: unknown endpoint type '"+r+"'"}}},p={_jsPlumb:this._jsPlumb.instance,cssClass:A.cssClass,container:A.container,tooltip:A.tooltip,connectorTooltip:A.connectorTooltip,endpoint:this};x.isString(o)?this.endpoint=n(o,p):x.isArray(o)?(p=x.merge(o[1],p),this.endpoint=n(o[0],p)):this.endpoint=o.clone(),jsPlumb.extend({},p),this.endpoint.clone=function(){return x.isString(o)?n(o,p):x.isArray(o)?(p=x.merge(o[1],p),n(o[0],p)):void 0}.bind(this),this.type=this.endpoint.type,this.bindListeners(this.endpoint,this,D)},this.setEndpoint(A.endpoint||z.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot"),this.setPaintStyle(A.paintStyle||A.style||z.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(A.hoverPaintStyle||z.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),jsPlumb.extend(this,A,l),this.isSource=A.isSource||!1,this.isTarget=A.isTarget||!1,this._jsPlumb.maxConnections=A.maxConnections||z.Defaults.MaxConnections,this.canvas=this.endpoint.canvas,this.addClass(z.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),jsPlumbAdapter.addClass(this.element,z.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.connections=A.connections||[],this.connectorPointerEvents=A["connector-pointer-events"],this.scope=A.scope||z.getDefaultScope(),this.timestamp=null,this.reattachConnections=A.reattach||z.Defaults.ReattachConnections,this.connectionsDetachable=z.Defaults.ConnectionsDetachable,(A.connectionsDetachable===!1||A.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=A.dragAllowedWhenFull||!0,A.onMaxConnections&&this.bind("maxConnections",A.onMaxConnections),this.addConnection=function(n){this.connections.push(n),this[(this.connections.length>0?"add":"remove")+"Class"](z.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](z.endpointFullClass)},this.detachFromConnection=function(o,n,p){n=null==n?i(o,this):n,n>=0&&(this.connections.splice(n,1),this[(this.connections.length>0?"add":"remove")+"Class"](z.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](z.endpointFullClass)),!p&&this._deleteOnDetach&&0===this.connections.length&&z.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!1})},this.detach=function(E,u,t,s,r,q,p){var o=null==p?i(E,this):p,n=!1;return s=s!==!1,o>=0&&(t||E._forceDetach||E.isDetachable()&&E.isDetachAllowed(E)&&this.isDetachAllowed(E))&&(z.deleteObject({connection:E,fireEvent:!u&&s,originalEvent:r,deleteAttachedObjects:!1}),n=!0),n},this.detachAll=function(o,n){for(;this.connections.length>0;){this.detach(this.connections[0],!1,!0,o!==!1,n,this,0)}return this},this.detachFrom=function(o,n,s){for(var r=[],q=0;q<this.connections.length;q++){(this.connections[q].endpoints[1]==o||this.connections[q].endpoints[0]==o)&&r.push(this.connections[q])}for(var p=0;p<r.length;p++){this.detach(r[p],!1,!0,n,s)}return this},this.getElement=function(){return this.element},this.setElement=function(o){var n=this._jsPlumb.instance.getId(o),p=this.elementId;return x.removeWithFunction(A.endpointsByElement[this.elementId],function(q){return q.id==this.id}.bind(this)),this.element=jsPlumb.getDOMElement(o),this.elementId=z.getId(this.element),z.anchorManager.rehomeEndpoint(this,p,this.element),z.dragManager.endpointAdded(this.element),x.addToList(A.endpointsByElement,n,this),this},this.makeInPlaceCopy=function(){var o=this.anchor.getCurrentLocation({element:this}),n=this.anchor.getOrientation(this),q=this.anchor.getCssClass(),p={bind:function(){},compute:function(){return[o[0],o[1]]},getCurrentLocation:function(){return[o[0],o[1]]},getOrientation:function(){return n},getCssClass:function(){return q}};return v({dropOptions:A.dropOptions,anchor:p,source:this.element,paintStyle:this.getPaintStyle(),endpoint:A.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope})},this.connectorSelector=function(){var n=this.connections[0];return this.isTarget&&n?n:this.connections.length<this._jsPlumb.maxConnections||-1==this._jsPlumb.maxConnections?null:n},this.setStyle=this.setPaintStyle,this.paint=function(R){R=R||{};var Q=R.timestamp,P=!(R.recalc===!1);if(!Q||this.timestamp!==Q){var O=z.updateOffset({elId:this.elementId,timestamp:Q}),N=R.offset?R.offset.o:O.o;if(null!=N){var M=R.anchorPoint,L=R.connectorPaintStyle;if(null==M){var K=R.dimensions||O.s,J={xy:[N.left,N.top],wh:K,element:this,timestamp:Q};if(P&&this.anchor.isDynamic&&this.connections.length>0){var I=k(this,R.elementWithPrecedence),H=I.endpoints[0]==this?1:0,G=0===H?I.sourceId:I.targetId,F=z.getCachedData(G),E=F.o,u=F.s;J.txy=[E.left,E.top],J.twh=u,J.tElement=I.endpoints[H]}M=this.anchor.compute(J)}this.endpoint.compute(M,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,L||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=Q;for(var t=0;t<this._jsPlumb.overlays.length;t++){var S=this._jsPlumb.overlays[t];S.isVisible()&&(this._jsPlumb.overlayPlacements[t]=S.draw(this.endpoint,this._jsPlumb.paintStyleInUse),S.paint(this._jsPlumb.overlayPlacements[t]))}}}},this.repaint=this.paint;var C=!1;this.initDraggable=function(){if(!C&&jsPlumb.isDragSupported(this.element)){var H={id:null,element:null},G=null,F=!1,E=null,t=h(H,z),p=function(){G=this.connectorSelector();var N=!0;if(this.isEnabled()||(N=!1),null!=G||this.isSource||(N=!1),this.isSource&&this.isFull()&&!this.dragAllowedWhenFull&&(N=!1),null==G||G.isDetachable()||(N=!1),N===!1){return z.stopDrag&&z.stopDrag(this.canvas),t.stopDrag(),!1}for(var T=0;T<this.connections.length;T++){this.connections[T].setHover(!1)}this.addClass("endpointDrag"),z.setConnectionBeingDragged(!0),G&&!this.isFull()&&this.isSource&&(G=null),z.updateOffset({elId:this.elementId}),c=this.makeInPlaceCopy(),c.referenceEndpoint=this,c.paint(),g(H,z);var S=y(c.canvas),R=jsPlumbAdapter.getOffset(S,this._jsPlumb.instance),Q=y(this.canvas);if(jsPlumbAdapter.setPosition(H.element,R),this.parentAnchor&&(this.anchor=z.makeAnchor(this.parentAnchor,this.elementId,z)),z.setAttribute(this.canvas,"dragId",H.id),z.setAttribute(this.canvas,"elId",this.elementId),this._jsPlumb.floatingEndpoint=m(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,H.element,z,v),this.canvas.style.visibility="hidden",null==G){this.anchor.locked=!0,this.setHover(!1,!1),G=w({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:H.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:A.connectorStyle,hoverPaintStyle:A.connectorHoverStyle,connector:A.connector,overlays:A.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass}),G.pending=!0,G.addClass(z.draggingClass),this._jsPlumb.floatingEndpoint.addClass(z.draggingClass),z.fire("connectionDrag",G)}else{F=!0,G.setHover(!1);var P=G.endpoints[0].id==this.id?0:1;G.floatingAnchorIndex=P,this.detachFromConnection(G,null,!0);var O=z.getDragScope(Q);z.setAttribute(this.canvas,"originalScope",O);var n=z.getDropScope(Q);z.setDragScope(Q,n),z.fire("connectionDrag",G),0===P?(E=[G.source,G.sourceId,Q,O],G.source=H.element,G.sourceId=H.id):(E=[G.target,G.targetId,Q,O],G.target=H.element,G.targetId=H.id),G.endpoints[0===P?1:0].anchor.locked=!0,G.suspendedEndpoint=G.endpoints[P],G.suspendedElement=G.endpoints[P].getElement(),G.suspendedElementId=G.endpoints[P].elementId,G.suspendedElementType=0===P?"source":"target",G.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=G.suspendedEndpoint,G.endpoints[P]=this._jsPlumb.floatingEndpoint,G.addClass(z.draggingClass),this._jsPlumb.floatingEndpoint.addClass(z.draggingClass)}d[H.id]=G,z.anchorManager.addFloatingConnection(H.id,G),x.addToList(A.endpointsByElement,H.id,this._jsPlumb.floatingEndpoint),z.currentlyDragging=!0}.bind(this),o=A.dragOptions||{},M={},L=jsPlumb.dragEvents.start,K=jsPlumb.dragEvents.stop,J=jsPlumb.dragEvents.drag;o=jsPlumb.extend(M,o),o.scope=o.scope||this.scope,o[L]=x.wrap(o[L],p,!1),o[J]=x.wrap(o[J],t.drag),o[K]=x.wrap(o[K],function(){if(z.setConnectionBeingDragged(!1),G&&null!=G.endpoints){var q=z.getDropEvent(arguments),n=null==G.floatingAnchorIndex?1:G.floatingAnchorIndex;G.endpoints[0===n?1:0].anchor.locked=!1,G.removeClass(z.draggingClass),G.endpoints[n]==this._jsPlumb.floatingEndpoint&&F&&G.suspendedEndpoint&&(0===n?(G.source=E[0],G.sourceId=E[1]):(G.target=E[0],G.targetId=E[1]),z.setDragScope(E[2],E[3]),G.endpoints[n]=G.suspendedEndpoint,G.isReattach()||G._forceReattach||G._forceDetach||!G.endpoints[0===n?1:0].detach(G,!1,!1,!0,q)?(G.setHover(!1),G.floatingAnchorIndex=null,G._forceDetach=null,G._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(G),G.suspendedEndpoint.addConnection(G),z.repaint(E[1])):G.suspendedEndpoint.detachFromConnection(G)),z.remove(H.element,!1),z.deleteObject({endpoint:c}),this.deleteAfterDragStop?z.deleteObject({endpoint:this}):this._jsPlumb&&(this._jsPlumb.floatingEndpoint=null,this.canvas.style.visibility="visible",this.anchor.locked=!1,this.paint({recalc:!1})),z.fire("connectionDragStop",G,q),z.currentlyDragging=!1,G=null}}.bind(this));var I=y(this.canvas);z.initDraggable(I,o,!0),C=!0}},(this.isSource||this.isTarget)&&this.initDraggable();var B=function(E,u,t,s){if((this.isTarget||u)&&jsPlumb.isDropSupported(this.element)){var r=A.dropOptions||z.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;r=jsPlumb.extend({},r),r.scope=r.scope||this.scope;var q=jsPlumb.dragEvents.drop,p=jsPlumb.dragEvents.over,o=jsPlumb.dragEvents.out,n=function(){this.removeClass(z.endpointDropAllowedClass),this.removeClass(z.endpointDropForbiddenClass);var Q=z.getDropEvent(arguments),P=z.getDOMElement(z.getDragObject(arguments)),O=z.getAttribute(P,"dragId"),N=(z.getAttribute(P,"elId"),z.getAttribute(P,"originalScope")),M=d[O];if(null!=M){var L=M.suspendedEndpoint&&(M.suspendedEndpoint.id==this.id||this.referenceEndpoint&&M.suspendedEndpoint.id==this.referenceEndpoint.id);if(L){return M._forceReattach=!0,void 0}var K=null==M.floatingAnchorIndex?1:M.floatingAnchorIndex;N&&z.setDragScope(P,N);var J=null!=s?s.isEnabled():!0;if(this.isFull()&&this.fire("maxConnections",{endpoint:this,connection:M,maxConnections:this._jsPlumb.maxConnections},Q),!this.isFull()&&(0!==K||this.isSource)&&(1!=K||this.isTarget)&&J){var I=!0;M.suspendedEndpoint&&M.suspendedEndpoint.id!=this.id&&(0===K?(M.source=M.suspendedEndpoint.element,M.sourceId=M.suspendedEndpoint.elementId):(M.target=M.suspendedEndpoint.element,M.targetId=M.suspendedEndpoint.elementId),M.isDetachAllowed(M)&&M.endpoints[K].isDetachAllowed(M)&&M.suspendedEndpoint.isDetachAllowed(M)&&z.checkCondition("beforeDetach",M)||(I=!1)),0===K?(M.source=this.element,M.sourceId=this.elementId):(M.target=this.element,M.targetId=this.elementId);var H=function(){M.floatingAnchorIndex=null},G=function(){M.pending=!1,M.endpoints[K].detachFromConnection(M),M.suspendedEndpoint&&M.suspendedEndpoint.detachFromConnection(M),M.endpoints[K]=this,this.addConnection(M);var R=this.getParameters();for(var T in R){M.setParameter(T,R[T])}if(M.suspendedEndpoint){var S=(M.suspendedEndpoint.getElement(),M.suspendedEndpoint.elementId);e({index:K,originalSourceId:0===K?S:M.sourceId,newSourceId:0===K?this.elementId:M.sourceId,originalTargetId:1==K?S:M.targetId,newTargetId:1==K?this.elementId:M.targetId,originalSourceEndpoint:0===K?M.suspendedEndpoint:M.endpoints[0],newSourceEndpoint:0===K?this:M.endpoints[0],originalTargetEndpoint:1==K?M.suspendedEndpoint:M.endpoints[1],newTargetEndpoint:1==K?this:M.endpoints[1],connection:M},Q)}else{R.draggable&&jsPlumb.initDraggable(this.element,dragOptions,!0,z)}1==K?z.anchorManager.updateOtherEndpoint(M.sourceId,M.suspendedElementId,M.targetId,M):z.anchorManager.sourceChanged(M.suspendedEndpoint.elementId,M.sourceId,M),f(M,null,Q),H()}.bind(this),F=function(){M.suspendedEndpoint&&(M.endpoints[K]=M.suspendedEndpoint,M.setHover(!1),M._forceDetach=!0,0===K?(M.source=M.suspendedEndpoint.element,M.sourceId=M.suspendedEndpoint.elementId):(M.target=M.suspendedEndpoint.element,M.targetId=M.suspendedEndpoint.elementId),M.suspendedEndpoint.addConnection(M),M.endpoints[0].repaint(),M.repaint(),z.repaint(M.sourceId),M._forceDetach=!1),H()};I=I&&this.isDropAllowed(M.sourceId,M.targetId,M.scope,M,this),I?G():F()}z.currentlyDragging=!1}}.bind(this);r[q]=x.wrap(r[q],n),r[p]=x.wrap(r[p],function(){var G=jsPlumb.getDragObject(arguments),F=z.getAttribute(jsPlumb.getDOMElement(G),"dragId"),K=d[F];if(null!=K){var J=null==K.floatingAnchorIndex?1:K.floatingAnchorIndex,I=this.isTarget&&0!==K.floatingAnchorIndex||K.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==K.suspendedEndpoint.id;if(I){var H=z.checkCondition("checkDropAllowed",{sourceEndpoint:K.endpoints[J],targetEndpoint:this,connection:K});this[(H?"add":"remove")+"Class"](z.endpointDropAllowedClass),this[(H?"remove":"add")+"Class"](z.endpointDropForbiddenClass),K.endpoints[J].anchor.over(this.anchor,this)}}}.bind(this)),r[o]=x.wrap(r[o],function(){var G=jsPlumb.getDragObject(arguments),F=null==G?null:z.getAttribute(jsPlumb.getDOMElement(G),"dragId"),J=F?d[F]:null;if(null!=J){var I=null==J.floatingAnchorIndex?1:J.floatingAnchorIndex,H=this.isTarget&&0!==J.floatingAnchorIndex||J.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==J.suspendedEndpoint.id;H&&(this.removeClass(z.endpointDropAllowedClass),this.removeClass(z.endpointDropForbiddenClass),J.endpoints[I].anchor.out())}}.bind(this)),z.initDroppable(E,r,!0,t)}}.bind(this);return this.anchor.isFloating||B(y(this.canvas),!0,!(A._transient||this.anchor.isFloating),this),A.type&&this.addType(A.type,A.data,z.isSuspendDrawing()),this},jsPlumbUtil.extend(jsPlumb.Endpoint,OverlayCapableJsPlumbUIComponent,{getTypeDescriptor:function(){return"endpoint"},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n,f,q){if(this._jsPlumb.visible=n,this.canvas&&(this.canvas.style.display=n?"block":"none"),this[n?"showOverlays":"hideOverlays"](),!f){for(var p=0;p<this.connections.length;p++){if(this.connections[p].setVisible(n),!q){var o=this===this.connections[p].endpoints[0]?1:0;1==this.connections[p].endpoints[o].connections.length&&this.connections[p].endpoints[o].setVisible(n,!0,!0)}}}},getAttachedElements:function(){return this.connections},applyType:function(b){null!=b.maxConnections&&(this._jsPlumb.maxConnections=b.maxConnections),b.scope&&(this.scope=b.scope),jsPlumb.extend(this,b,l),b.anchor&&(this.anchor=this._jsPlumb.instance.makeAnchor(b.anchor))},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(b){this._jsPlumb.enabled=b},cleanup:function(){jsPlumbAdapter.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.anchor=null,this.endpoint.cleanup(),this.endpoint.destroy(),this.endpoint=null;var b=jsPlumb.getElementObject(this.canvas);this._jsPlumb.instance.destroyDraggable(b),this._jsPlumb.instance.destroyDroppable(b)},setHover:function(b){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(b)},isFull:function(){return !(this.isFloating()||this._jsPlumb.maxConnections<1||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(b){this._jsPlumb.connectionCost=b},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(b){this._jsPlumb.connectionsDirected=b},setElementId:function(b){this.elementId=b,this.anchor.elementId=b},setReferenceElement:function(b){this.element=jsPlumb.getDOMElement(b)},setDragAllowedWhenFull:function(b){this.dragAllowedWhenFull=b},equals:function(b){return this.anchor.equals(b.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(b){return this.anchor.compute(b)}})}(),function(){var d=function(f,e,h,g){if(!f.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[e][h]){throw {msg:"jsPlumb: unknown connector type '"+h+"'"}}return new jsPlumb.Connectors[e][h](g)},c=function(f,e,g){return f?g.makeAnchor(f,e,g):null};jsPlumb.Connection=function(H){var G=(H.newConnection,H.newEndpoint),F=(jsPlumb.getElementObject,jsPlumbUtil);this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=0.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=H.previousConnection,this.source=jsPlumb.getDOMElement(H.source),this.target=jsPlumb.getDOMElement(H.target),H.sourceEndpoint&&(this.source=H.sourceEndpoint.endpointWillMoveTo||H.sourceEndpoint.getElement()),H.targetEndpoint&&(this.target=H.targetEndpoint.getElement()),OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=H.scope,this.endpoints=[],this.endpointStyles=[];var E=this._jsPlumb.instance;this._jsPlumb.visible=!0,this._jsPlumb.editable=H.editable===!0,this._jsPlumb.params={cssClass:H.cssClass,container:H.container,"pointer-events":H["pointer-events"],editorParams:H.editorParams},this._jsPlumb.lastPaintedAt=null,this.getDefaultType=function(){return{parameters:{},scope:null,detachable:this._jsPlumb.instance.Defaults.ConnectionsDetachable,rettach:this._jsPlumb.instance.Defaults.ReattachConnections,paintStyle:this._jsPlumb.instance.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:this._jsPlumb.instance.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:this._jsPlumb.instance.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:this._jsPlumb.instance.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}},this.makeEndpoint=function(i,h,b,a){return b=b||this._jsPlumb.instance.getId(h),this.prepareEndpoint(E,G,this,a,i?0:1,H,h,b)};var D=this.makeEndpoint(!0,this.source,this.sourceId,H.sourceEndpoint),C=this.makeEndpoint(!1,this.target,this.targetId,H.targetEndpoint);D&&F.addToList(H.endpointsByElement,this.sourceId,D),C&&F.addToList(H.endpointsByElement,this.targetId,C),this.scope||(this.scope=this.endpoints[0].scope),null!=H.deleteEndpointsOnDetach?(this.endpoints[0]._deleteOnDetach=H.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=H.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0)),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||H.connector||E.Defaults.Connector||jsPlumb.Defaults.Connector,!0),H.path&&this.connector.setPath(H.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||H.paintStyle||E.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||H.hoverPaintStyle||E.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle();var B=E.getSuspendedAt();if(E.updateOffset({elId:this.sourceId,timestamp:B}),E.updateOffset({elId:this.targetId,timestamp:B}),!E.isSuspendDrawing()){var A=E.getCachedData(this.sourceId),z=A.o,y=A.s,x=E.getCachedData(this.targetId),w=x.o,v=x.s,u=B||E.timestamp(),t=this.endpoints[0].anchor.compute({xy:[z.left,z.top],wh:y,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[w.left,w.top],twh:v,tElement:this.endpoints[1],timestamp:u});this.endpoints[0].paint({anchorLoc:t,timestamp:u}),t=this.endpoints[1].anchor.compute({xy:[w.left,w.top],wh:v,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[z.left,z.top],twh:y,tElement:this.endpoints[0],timestamp:u}),this.endpoints[1].paint({anchorLoc:t,timestamp:u})}this._jsPlumb.detachable=E.Defaults.ConnectionsDetachable,H.detachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[0].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[1].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this._jsPlumb.reattach=H.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||E.Defaults.ReattachConnections,this._jsPlumb.cost=H.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=H.directed,null==H.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var s=jsPlumb.extend({},this.endpoints[1].getParameters());jsPlumb.extend(s,this.endpoints[0].getParameters()),jsPlumb.extend(s,this.getParameters()),this.setParameters(s);var r=[H.type,this.endpoints[0].connectionType,this.endpoints[1].connectionType].join(" ");/[^\s]/.test(r)&&this.addType(r,H.data,!0)},jsPlumbUtil.extend(jsPlumb.Connection,OverlayCapableJsPlumbUIComponent,{applyType:function(f,e){null!=f.detachable&&this.setDetachable(f.detachable),null!=f.reattach&&this.setReattach(f.reattach),f.scope&&(this.scope=f.scope),this.setConnector(f.connector,e)},getTypeDescriptor:function(){return"connection"},getAttachedElements:function(){return this.endpoints},addClass:function(f,e){e&&(this.endpoints[0].addClass(f),this.endpoints[1].addClass(f),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(f)),this.connector&&this.connector.addClass(f)},removeClass:function(f,e){e&&(this.endpoints[0].removeClass(f),this.endpoints[1].removeClass(f),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(f)),this.connector&&this.connector.removeClass(f)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(b){this._jsPlumb.visible=b,this.connector&&this.connector.setVisible(b),this.repaint()},cleanup:function(){this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(),this.connector.destroy()),this.connector=null},isDetachable:function(){return this._jsPlumb.detachable===!0},setDetachable:function(b){this._jsPlumb.detachable=b===!0},isReattach:function(){return this._jsPlumb.reattach===!0},setReattach:function(b){this._jsPlumb.reattach=b===!0},setHover:function(b){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(b),jsPlumbAdapter[b?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),jsPlumbAdapter[b?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getCost:function(){return this._jsPlumb.cost},setCost:function(b){this._jsPlumb.cost=b},isDirected:function(){return this._jsPlumb.directed===!0},getConnector:function(){return this.connector},setConnector:function(a,k){var i=jsPlumbUtil;null!=this.connector&&(this.connector.cleanup(),this.connector.destroy());var h={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},g=this._jsPlumb.instance.getRenderMode();i.isString(a)?this.connector=d(this._jsPlumb.instance,g,a,h):i.isArray(a)&&(this.connector=1==a.length?d(this._jsPlumb.instance,g,a[0],h):d(this._jsPlumb.instance,g,a[0],i.merge(a[1],h))),this.bindListeners(this.connector,this,function(b){this.setHover(b,!1)}.bind(this)),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this._jsPlumb.editable&&null!=jsPlumb.ConnectorEditors&&jsPlumb.ConnectorEditors[this.connector.type]&&this.connector.isEditable()?new jsPlumb.ConnectorEditors[this.connector.type]({connector:this.connector,connection:this,params:this._jsPlumb.params.editorParams||{}}):this._jsPlumb.editable=!1,k||this.repaint()},paint:function(T){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){T=T||{};var S=(T.elId,T.ui),R=T.recalc,Q=T.timestamp,P=!1,O=P?this.sourceId:this.targetId,N=P?this.targetId:this.sourceId,M=P?0:1,L=P?1:0;if(null==Q||Q!=this._jsPlumb.lastPaintedAt){var K=this._jsPlumb.instance.updateOffset({elId:N,offset:S,recalc:R,timestamp:Q}).o,J=this._jsPlumb.instance.updateOffset({elId:O,timestamp:Q}).o,I=this.endpoints[L],H=this.endpoints[M];T.clearEdits&&(this._jsPlumb.overlayPositions=null,I.anchor.clearUserDefinedLocation(),H.anchor.clearUserDefinedLocation(),this.connector.setEdited(!1));var G=I.anchor.getCurrentLocation({xy:[K.left,K.top],wh:[K.width,K.height],element:I,timestamp:Q}),F=H.anchor.getCurrentLocation({xy:[J.left,J.top],wh:[J.width,J.height],element:H,timestamp:Q});this.connector.resetBounds(),this.connector.compute({sourcePos:G,targetPos:F,sourceEndpoint:this.endpoints[L],targetEndpoint:this.endpoints[M],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:K,targetInfo:J,clearEdits:T.clearEdits===!0});for(var E={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},D=0;D<this._jsPlumb.overlays.length;D++){var C=this._jsPlumb.overlays[D];C.isVisible()&&(this._jsPlumb.overlayPlacements[D]=C.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(C)),E.minX=Math.min(E.minX,this._jsPlumb.overlayPlacements[D].minX),E.maxX=Math.max(E.maxX,this._jsPlumb.overlayPlacements[D].maxX),E.minY=Math.min(E.minY,this._jsPlumb.overlayPlacements[D].minY),E.maxY=Math.max(E.maxY,this._jsPlumb.overlayPlacements[D].maxY))}var B=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,A=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),z={xmin:Math.min(this.connector.bounds.minX-(B+A),E.minX),ymin:Math.min(this.connector.bounds.minY-(B+A),E.minY),xmax:Math.max(this.connector.bounds.maxX+(B+A),E.maxX),ymax:Math.max(this.connector.bounds.maxY+(B+A),E.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,z);for(var y=0;y<this._jsPlumb.overlays.length;y++){var x=this._jsPlumb.overlays[y];x.isVisible()&&x.paint(this._jsPlumb.overlayPlacements[y],z)}}this._jsPlumb.lastPaintedAt=Q}},repaint:function(b){b=b||{},this.paint({elId:this.sourceId,recalc:!(b.recalc===!1),timestamp:b.timestamp,clearEdits:b.clearEdits})},prepareEndpoint:function(B,A,z,y,x,w,v,u){var t;if(y){z.endpoints[x]=y,y.addConnection(z)}else{w.endpoints||(w.endpoints=[null,null]);var s=w.endpoints[x]||w.endpoint||B.Defaults.Endpoints[x]||jsPlumb.Defaults.Endpoints[x]||B.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;w.endpointStyles||(w.endpointStyles=[null,null]),w.endpointHoverStyles||(w.endpointHoverStyles=[null,null]);var r=w.endpointStyles[x]||w.endpointStyle||B.Defaults.EndpointStyles[x]||jsPlumb.Defaults.EndpointStyles[x]||B.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;null==r.fillStyle&&null!=w.paintStyle&&(r.fillStyle=w.paintStyle.strokeStyle),null==r.outlineColor&&null!=w.paintStyle&&(r.outlineColor=w.paintStyle.outlineColor),null==r.outlineWidth&&null!=w.paintStyle&&(r.outlineWidth=w.paintStyle.outlineWidth);var q=w.endpointHoverStyles[x]||w.endpointHoverStyle||B.Defaults.EndpointHoverStyles[x]||jsPlumb.Defaults.EndpointHoverStyles[x]||B.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;null!=w.hoverPaintStyle&&(null==q&&(q={}),null==q.fillStyle&&(q.fillStyle=w.hoverPaintStyle.strokeStyle));var p=w.anchors?w.anchors[x]:w.anchor?w.anchor:c(B.Defaults.Anchors[x],u,B)||c(jsPlumb.Defaults.Anchors[x],u,B)||c(B.Defaults.Anchor,u,B)||c(jsPlumb.Defaults.Anchor,u,B),b=w.uuids?w.uuids[x]:null;t=A({paintStyle:r,hoverPaintStyle:q,endpoint:s,connections:[z],uuid:b,anchor:p,source:v,scope:w.scope,reattach:w.reattach||B.Defaults.ReattachConnections,detachable:w.detachable||B.Defaults.ConnectionsDetachable}),z.endpoints[x]=t,w.drawEndpoints===!1&&t.setVisible(!1,!0,!0)}return t}})}(),function(){jsPlumb.AnchorManager=function(R){var Q={},P={},O={},N={},M={},L={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},K={},J=this,I={},H=R.jsPlumbInstance,G={},F=function(T,S,v,u,t,s){if(T===S){return{orientation:L.IDENTITY,a:["top","top"]}}var r=Math.atan2(u.centery-v.centery,u.centerx-v.centerx),q=Math.atan2(v.centery-u.centery,v.centerx-u.centerx),p=v.left<=u.left&&v.right>=u.left||v.left<=u.right&&v.right>=u.right||v.left<=u.left&&v.right>=u.right||u.left<=v.left&&u.right>=v.right,o=v.top<=u.top&&v.bottom>=u.top||v.top<=u.bottom&&v.bottom>=u.bottom||v.top<=u.top&&v.bottom>=u.bottom||u.top<=v.top&&u.bottom>=v.bottom,n=function(b){return[t.isContinuous?t.verifyEdge(b[0]):b[0],s.isContinuous?s.verifyEdge(b[1]):b[1]]},g={orientation:L.DIAGONAL,theta:r,theta2:q};return p||o?p?(g.orientation=L.HORIZONTAL,g.a=v.top<u.top?["bottom","top"]:["top","bottom"]):(g.orientation=L.VERTICAL,g.a=v.left<u.left?["right","left"]:["left","right"]):u.left>v.left&&u.top>v.top?g.a=["right","top"]:u.left>v.left&&v.top>u.top?g.a=["top","left"]:u.left<v.left&&u.top<v.top?g.a=["top","right"]:u.left<v.left&&u.top>v.top&&(g.a=["left","top"]),g.a=n(g.a),g},E=function(af,ae,ad,ac,ab,aa,Z){for(var Y=[],X=ae[ab?0:1]/(ac.length+1),W=0;W<ac.length;W++){var V=(W+1)*X,U=aa*ae[ab?1:0];Z&&(V=ae[ab?0:1]-V);var T=ab?V:U,S=ad[0]+T,v=T/ae[0],u=ab?U:V,t=ad[1]+u,s=u/ae[1];Y.push([S,t,v,s,ac[W][1],ac[W][2]])}return Y},D=function(b){return function(a,h){var g=!0;return g=b?a[0][0]<h[0][0]:a[0][0]>h[0][0],g===!1?-1:1}},C=function(h,g){var k=h[0][0]<0?-Math.PI-h[0][0]:Math.PI-h[0][0],i=g[0][0]<0?-Math.PI-g[0][0]:Math.PI-g[0][0];return k>i?1:h[0][1]>g[0][1]?1:-1},B={top:function(g,c){return g[0]>c[0]?1:-1},right:D(!0),bottom:D(!0),left:C},A=function(g,c){return g.sort(c)},z=function(k,i){var o=H.getCachedData(k),n=o.s,m=o.o,l=function(Z,Y,X,W,V,U,T){if(W.length>0){for(var S=A(W,B[Z]),v="right"===Z||"top"===Z,r=E(Z,Y,X,S,V,U,v),q=function(g,c){O[g.id]=[c[0],c[1],c[2],c[3]],M[g.id]=T},a=0;a<r.length;a++){var ac=r[a][4],ab=ac.endpoints[0].elementId===k,aa=ac.endpoints[1].elementId===k;ab?q(ac.endpoints[0],r[a]):aa&&q(ac.endpoints[1],r[a])}}};l("bottom",n,[m.left,m.top],i.bottom,!0,1,[0,1]),l("top",n,[m.left,m.top],i.top,!0,0,[0,-1]),l("left",n,[m.left,m.top],i.left,!1,0,[-1,0]),l("right",n,[m.left,m.top],i.right,!1,1,[1,0])};this.reset=function(){Q={},K={},I={}},this.addFloatingConnection=function(g,c){G[g]=c},this.removeFloatingConnection=function(b){delete G[b]},this.newConnection=function(h){var g=h.sourceId,m=h.targetId,l=h.endpoints,k=!0,i=function(o,n,c,b,a){g==m&&c.isContinuous&&(h._jsPlumb.instance.removeElement(l[1].canvas),k=!1),jsPlumbUtil.addToList(K,b,[a,n,c.constructor==jsPlumb.DynamicAnchor])};i(0,l[0],l[0].anchor,m,h),k&&i(1,l[1],l[1].anchor,g,h)};var y=function(b){!function(h,g){if(h){var i=function(c){return c[4]==g};jsPlumbUtil.removeWithFunction(h.top,i),jsPlumbUtil.removeWithFunction(h.left,i),jsPlumbUtil.removeWithFunction(h.bottom,i),jsPlumbUtil.removeWithFunction(h.right,i)}}(I[b.elementId],b.id)};this.connectionDetached=function(h){var g=h.connection||h,m=h.sourceId,l=h.targetId,k=g.endpoints,i=function(o,n,r,q,p){null!=r&&r.constructor==jsPlumb.FloatingAnchor||jsPlumbUtil.removeWithFunction(K[q],function(b){return b[0].id==p.id})};i(1,k[1],k[1].anchor,m,g),i(0,k[0],k[0].anchor,l,g),y(g.endpoints[0]),y(g.endpoints[1]),J.redraw(g.sourceId),J.redraw(g.targetId)},this.add=function(b,g){jsPlumbUtil.addToList(Q,g,b)},this.changeId=function(b,g){K[g]=K[b],Q[g]=Q[b],delete K[b],delete Q[b]},this.getConnectionsFor=function(b){return K[b]||[]},this.getEndpointsFor=function(b){return Q[b]||[]},this.deleteEndpoint=function(b){jsPlumbUtil.removeWithFunction(Q[b.elementId],function(a){return a.id==b.id}),y(b)},this.clearFor=function(b){delete Q[b],Q[b]=[]};var x=function(an,am,al,ak,aj,ai,ah,ag,af,ae,ad,ac){var ab=-1,aa=-1,Z=ak.endpoints[ah],Y=Z.id,X=[1,0][ah],W=[[am,al],ak,aj,ai,Y],V=an[af],U=Z._continuousAnchorEdge?an[Z._continuousAnchorEdge]:null;if(U){var T=jsPlumbUtil.findWithFunction(U,function(b){return b[4]==Y});if(-1!=T){U.splice(T,1);for(var S=0;S<U.length;S++){jsPlumbUtil.addWithFunction(ad,U[S][1],function(b){return b.id==U[S][1].id}),jsPlumbUtil.addWithFunction(ac,U[S][1].endpoints[ah],function(b){return b.id==U[S][1].endpoints[ah].id}),jsPlumbUtil.addWithFunction(ac,U[S][1].endpoints[X],function(b){return b.id==U[S][1].endpoints[X].id})}}}for(S=0;S<V.length;S++){1==R.idx&&V[S][3]===ai&&-1==aa&&(aa=S),jsPlumbUtil.addWithFunction(ad,V[S][1],function(b){return b.id==V[S][1].id}),jsPlumbUtil.addWithFunction(ac,V[S][1].endpoints[ah],function(b){return b.id==V[S][1].endpoints[ah].id}),jsPlumbUtil.addWithFunction(ac,V[S][1].endpoints[X],function(b){return b.id==V[S][1].endpoints[X].id})}if(-1!=ab){V[ab]=W}else{var a=ag?-1!=aa?aa:0:V.length;V.splice(a,0,W)}Z._continuousAnchorEdge=af};this.updateOtherEndpoint=function(h,g,m,l){var k=jsPlumbUtil.findWithFunction(K[h],function(b){return b[0].id===l.id}),i=jsPlumbUtil.findWithFunction(K[g],function(b){return b[0].id===l.id});-1!=k&&(K[h][k][0]=l,K[h][k][1]=l.endpoints[1],K[h][k][2]=l.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor),i>-1&&(K[g].splice(i,1),jsPlumbUtil.addToList(K,m,[l,l.endpoints[0],l.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor]))},this.sourceChanged=function(h,g,k){if(h!==g){jsPlumbUtil.removeWithFunction(K[h],function(b){return b[0].id===k.id});var i=jsPlumbUtil.findWithFunction(K[k.targetId],function(b){return b[0].id===k.id});i>-1&&(K[k.targetId][i][0]=k,K[k.targetId][i][1]=k.endpoints[0],K[k.targetId][i][2]=k.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor),jsPlumbUtil.addToList(K,g,[k,k.endpoints[1],k.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor])}},this.rehomeEndpoint=function(b,p,o){var n=Q[p]||[],m=H.getId(o);if(m!==p){var l=jsPlumbUtil.indexOf(n,b);if(l>-1){var k=n.splice(l,1)[0];J.add(k,m)}}for(var i=0;i<b.connections.length;i++){b.connections[i].sourceId==p?(b.connections[i].sourceId=b.elementId,b.connections[i].source=b.element,J.sourceChanged(p,b.elementId,b.connections[i])):b.connections[i].targetId==p&&(b.connections[i].targetId=b.elementId,b.connections[i].target=b.element,J.updateOtherEndpoint(b.connections[i].sourceId,p,b.elementId,b.connections[i]))}},this.redraw=function(an,am,al,ak,aj,ai){if(!H.isSuspendDrawing()){var ah=Q[an]||[],ag=K[an]||[],af=[],ae=[],ac=[];al=al||H.timestamp(),ak=ak||{left:0,top:0},am&&(am={left:am.left+ak.left,top:am.top+ak.top});for(var aa=H.updateOffset({elId:an,offset:am,recalc:!1,timestamp:al}),X={},U=0;U<ag.length;U++){var S=ag[U][0],s=S.sourceId,l=S.targetId,h=S.endpoints[0].anchor.isContinuous,ad=S.endpoints[1].anchor.isContinuous;if(h||ad){var ab=s+"_"+l,Z=X[ab],Y=S.sourceId==an?1:0;h&&!I[s]&&(I[s]={top:[],right:[],bottom:[],left:[]}),ad&&!I[l]&&(I[l]={top:[],right:[],bottom:[],left:[]}),an!=l&&H.updateOffset({elId:l,timestamp:al}),an!=s&&H.updateOffset({elId:s,timestamp:al});var W=H.getCachedData(l),V=H.getCachedData(s);l==s&&(h||ad)?x(I[s],-Math.PI/2,0,S,!1,l,0,!1,"top",s,af,ae):(Z||(Z=F(s,l,V.o,W.o,S.endpoints[0].anchor,S.endpoints[1].anchor),X[ab]=Z),h&&x(I[s],Z.theta,0,S,!1,l,0,!1,Z.a[0],s,af,ae),ad&&x(I[l],Z.theta2,-1,S,!0,s,1,!0,Z.a[1],l,af,ae)),h&&jsPlumbUtil.addWithFunction(ac,s,function(c){return c===s}),ad&&jsPlumbUtil.addWithFunction(ac,l,function(c){return c===l}),jsPlumbUtil.addWithFunction(af,S,function(c){return c.id==S.id}),(h&&0===Y||ad&&1===Y)&&jsPlumbUtil.addWithFunction(ae,S.endpoints[Y],function(c){return c.id==S.endpoints[Y].id})}}for(U=0;U<ah.length;U++){0===ah[U].connections.length&&ah[U].anchor.isContinuous&&(I[an]||(I[an]={top:[],right:[],bottom:[],left:[]}),x(I[an],-Math.PI/2,0,{endpoints:[ah[U],ah[U]],paint:function(){}},!1,an,0,!1,"top",an,af,ae),jsPlumbUtil.addWithFunction(ac,an,function(a){return a===an}))}for(U=0;U<ac.length;U++){z(ac[U],I[ac[U]])}for(U=0;U<ah.length;U++){ah[U].paint({timestamp:al,offset:aa,dimensions:aa.s,recalc:ai!==!0})}for(U=0;U<ae.length;U++){var T=H.getCachedData(ae[U].elementId);ae[U].paint({timestamp:al,offset:T,dimensions:T.s})}for(U=0;U<ag.length;U++){var u=ag[U][1];if(u.anchor.constructor==jsPlumb.DynamicAnchor){u.paint({elementWithPrecedence:an,timestamp:al}),jsPlumbUtil.addWithFunction(af,ag[U][0],function(c){return c.id==ag[U][0].id});for(var m=0;m<u.connections.length;m++){u.connections[m]!==ag[U][0]&&jsPlumbUtil.addWithFunction(af,u.connections[m],function(c){return c.id==u.connections[m].id})}}else{u.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(af,ag[U][0],function(c){return c.id==ag[U][0].id})}}var k=G[an];for(k&&k.paint({timestamp:al,recalc:!1,elId:an}),U=0;U<af.length;U++){var b=al;af[U].paint({elId:an,timestamp:b,recalc:!1,clearEdits:aj})}}};var w=function(U){jsPlumbUtil.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var T=U.faces||["top","right","bottom","left"],S=!(U.clockwise===!1),v={},u={top:"bottom",right:"left",left:"right",bottom:"top"},t={top:"right",right:"bottom",left:"top",bottom:"left"},s={top:"left",right:"top",left:"bottom",bottom:"right"},r=S?t:s,q=S?s:t,p=U.cssClass||"",o=0;o<T.length;o++){v[T[o]]=!0}this.verifyEdge=function(b){return v[b]?b:v[u[b]]?u[b]:v[r[b]]?r[b]:v[q[b]]?q[b]:b},this.compute=function(b){return N[b.element.id]||O[b.element.id]||[0,0]},this.getCurrentLocation=function(b){return N[b.element.id]||O[b.element.id]||[0,0]},this.getOrientation=function(b){return M[b.id]||[0,0]},this.clearUserDefinedLocation=function(){delete N[U.elementId]},this.setUserDefinedLocation=function(a){N[U.elementId]=a},this.getCssClass=function(){return p},this.setCssClass=function(b){p=b}};H.continuousAnchorFactory={get:function(g){var c=P[g.elementId];return c||(c=new w(g),P[g.elementId]=c),c},clear:function(b){delete P[b]}}},jsPlumb.Anchor=function(b){this.x=b.x||0,this.y=b.y||0,this.elementId=b.elementId,this.cssClass=b.cssClass||"",this.userDefinedLocation=null,this.orientation=b.orientation||[0,0],jsPlumbUtil.EventGenerator.apply(this),b.jsPlumbInstance,this.lastReturnValue=null,this.offsets=b.offsets||[0,0],this.timestamp=null,this.compute=function(h){var g=h.xy,k=h.wh,i=(h.element,h.timestamp);return h.clearUserDefinedLocation&&(this.userDefinedLocation=null),i&&i===self.timestamp?this.lastReturnValue:(this.lastReturnValue=null!=this.userDefinedLocation?this.userDefinedLocation:[g[0]+this.x*k[0]+this.offsets[0],g[1]+this.y*k[1]+this.offsets[1]],this.timestamp=i,this.lastReturnValue)},this.getCurrentLocation=function(c){return null==this.lastReturnValue||null!=c.timestamp&&this.timestamp!=c.timestamp?this.compute(c):this.lastReturnValue}},jsPlumbUtil.extend(jsPlumb.Anchor,jsPlumbUtil.EventGenerator,{equals:function(h){if(!h){return !1}var g=h.getOrientation(),i=this.getOrientation();return this.x==h.x&&this.y==h.y&&this.offsets[0]==h.offsets[0]&&this.offsets[1]==h.offsets[1]&&i[0]==g[0]&&i[1]==g[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(b){this.userDefinedLocation=b},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),jsPlumb.FloatingAnchor=function(k){jsPlumb.Anchor.apply(this,arguments);var i=k.reference,q=(k.jsPlumbInstance,k.referenceCanvas),p=jsPlumb.getSize(q),o=0,n=0,m=null,l=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(h){var g=h.xy,r=(h.element,[g[0]+p[0]/2,g[1]+p[1]/2]);return l=r,r},this.getOrientation=function(b){if(m){return m}var g=i.getOrientation(b);return[-1*Math.abs(g[0])*o,-1*Math.abs(g[1])*n]},this.over=function(g,c){m=g.getOrientation(c)},this.out=function(){m=null},this.getCurrentLocation=function(b){return null==l?this.compute(b):l}},jsPlumbUtil.extend(jsPlumb.FloatingAnchor,jsPlumb.Anchor);var e=function(h,g,i){return h.constructor==jsPlumb.Anchor?h:g.makeAnchor(h,i,g)};jsPlumb.DynamicAnchor=function(a){jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0,this.anchors=[],this.elementId=a.elementId,this.jsPlumbInstance=a.jsPlumbInstance;for(var o=0;o<a.anchors.length;o++){this.anchors[o]=e(a.anchors[o],this.jsPlumbInstance,this.elementId)}this.addAnchor=function(c){this.anchors.push(e(c,this.jsPlumbInstance,this.elementId))},this.getAnchors=function(){return this.anchors},this.locked=!1;var n=this.anchors.length>0?this.anchors[0]:null,m=(this.anchors.length>0?0:-1,n),l=this,k=function(x,w,v,u,t){var s=u[0]+x.x*t[0],r=u[1]+x.y*t[1],q=u[0]+t[0]/2,p=u[1]+t[1]/2;return Math.sqrt(Math.pow(w-s,2)+Math.pow(v-r,2))+Math.sqrt(Math.pow(q-s,2)+Math.pow(p-r,2))},i=a.selector||function(y,x,w,v,u){for(var t=w[0]+v[0]/2,s=w[1]+v[1]/2,r=-1,q=1/0,p=0;p<u.length;p++){var g=k(u[p],t,s,y,x);q>g&&(r=p+0,q=g)}return u[r]};this.compute=function(p){var h=p.xy,u=p.wh,t=p.timestamp,s=p.txy,r=p.twh;p.clearUserDefinedLocation&&(userDefinedLocation=null),this.timestamp=t;var q=l.getUserDefinedLocation();return null!=q?q:this.locked||null==s||null==r?n.compute(p):(p.timestamp=null,n=i(h,u,s,r,this.anchors),this.x=n.x,this.y=n.y,n!=m&&this.fire("anchorChanged",n),m=n,n.compute(p))},this.getCurrentLocation=function(b){return this.getUserDefinedLocation()||(null!=n?n.getCurrentLocation(b):null)},this.getOrientation=function(b){return null!=n?n.getOrientation(b):[0,0]},this.over=function(g,c){null!=n&&n.over(g,c)},this.out=function(){null!=n&&n.out()},this.getCssClass=function(){return n&&n.getCssClass()||""}},jsPlumbUtil.extend(jsPlumb.DynamicAnchor,jsPlumb.Anchor);var d=function(h,g,m,l,k,i){jsPlumb.Anchors[k]=function(b){var a=b.jsPlumbInstance.makeAnchor([h,g,m,l,0,0],b.elementId,b.jsPlumbInstance);return a.type=k,i&&i(a,b),a}};d(0.5,0,0,-1,"TopCenter"),d(0.5,1,0,1,"BottomCenter"),d(0,0.5,-1,0,"LeftMiddle"),d(1,0.5,1,0,"RightMiddle"),d(0.5,0,0,-1,"Top"),d(0.5,1,0,1,"Bottom"),d(0,0.5,-1,0,"Left"),d(1,0.5,1,0,"Right"),d(0.5,0.5,0,0,"Center"),d(1,0,0,-1,"TopRight"),d(1,1,0,1,"BottomRight"),d(0,0,0,-1,"TopLeft"),d(0,1,0,1,"BottomLeft"),jsPlumb.Defaults.DynamicAnchors=function(b){return b.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],b.elementId,b.jsPlumbInstance)},jsPlumb.Anchors.AutoDefault=function(g){var c=g.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(g));return c.type="AutoDefault",c};var f=function(g,c){jsPlumb.Anchors[g]=function(b){var a=b.jsPlumbInstance.makeAnchor(["Continuous",{faces:c}],b.elementId,b.jsPlumbInstance);return a.type=g,a}};jsPlumb.Anchors.Continuous=function(b){return b.jsPlumbInstance.continuousAnchorFactory.get(b)},f("ContinuousLeft",["left"]),f("ContinuousTop",["top"]),f("ContinuousBottom",["bottom"]),f("ContinuousRight",["right"]),d(0,0,0,0,"Assign",function(h,g){var i=g.position||"Fixed";h.positionFinder=i.constructor==String?g.jsPlumbInstance.AnchorPositionFinders[i]:i,h.constructorParams=g}),jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(h,g,i){return[(h.left-g.left)/i[0],(h.top-g.top)/i[1]]},Grid:function(t,s,r,q){var p=t.left-s.left,o=t.top-s.top,n=r[0]/q.grid[0],m=r[1]/q.grid[1],l=Math.floor(p/n),k=Math.floor(o/m);return[(l*n+n/2)/r[0],(k*m+m/2)/r[1]]}},jsPlumb.Anchors.Perimeter=function(v){v=v||{};var u=v.anchorCount||60,t=v.shape;if(!t){throw new Error("no shape supplied to Perimeter Anchor type")}var s=function(){for(var b=0.5,z=2*Math.PI/u,y=0,x=[],w=0;u>w;w++){var k=b+b*Math.sin(y),i=b+b*Math.cos(y);x.push([k,i,0,0]),y+=z}return x},r=function(b){for(var k=u/b.length,i=[],h=function(c,C,B,A,z){k=u*z;for(var y=(B-c)/k,x=(A-C)/k,w=0;k>w;w++){i.push([c+y*w,C+x*w,0,0])}},g=0;g<b.length;g++){h.apply(null,b[g])}return i},q=function(h){for(var g=[],i=0;i<h.length;i++){g.push([h[i][0],h[i][1],h[i][2],h[i][3],1/h.length])}return r(g)},p=function(){return q([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},o={Circle:s,Ellipse:s,Diamond:function(){return q([[0.5,0,1,0.5],[1,0.5,0.5,1],[0.5,1,0,0.5],[0,0.5,0.5,0]])},Rectangle:p,Square:p,Triangle:function(){return q([[0.5,0,1,1],[1,1,0,1],[0,1,0.5,0]])},Path:function(k){for(var i=k.points,A=[],z=0,y=0;y<i.length-1;y++){var x=Math.sqrt(Math.pow(i[y][2]-i[y][0])+Math.pow(i[y][3]-i[y][1]));z+=x,A.push([i[y][0],i[y][1],i[y+1][0],i[y+1][1],x])}for(var w=0;w<A.length;w++){A[w][4]=A[w][4]/z}return r(A)}},n=function(i,h){for(var z=[],y=h/180*Math.PI,x=0;x<i.length;x++){var w=i[x][0]-0.5,k=i[x][1]-0.5;z.push([0.5+(w*Math.cos(y)-k*Math.sin(y)),0.5+(w*Math.sin(y)+k*Math.cos(y)),i[x][2],i[x][3]])}return z};if(!o[t]){throw new Error("Shape ["+t+"] is unknown by Perimeter Anchor type")}var m=o[t](v);v.rotation&&(m=n(m,v.rotation));var l=v.jsPlumbInstance.makeDynamicAnchor(m);return l.type="Perimeter",l}}(),function(){jsPlumb.DOMElementComponent=jsPlumbUtil.extend(jsPlumb.jsPlumbUIComponent,function(){this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(){}}),jsPlumb.Segments={AbstractSegment:function(b){this.params=b,this.findClosestPointOnPath=function(){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(b.x1,b.x2),minY:Math.min(b.y1,b.y2),maxX:Math.max(b.x1,b.x2),maxY:Math.max(b.y1,b.y2)}}},Straight:function(x){var w,v,u,t,s,r,q,p=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(){w=Math.sqrt(Math.pow(s-t,2)+Math.pow(q-r,2)),v=Biltong.gradient({x:t,y:r},{x:s,y:q}),u=-1/v});this.type="Straight",this.getLength=function(){return w},this.getGradient=function(){return v},this.getCoordinates=function(){return{x1:t,y1:r,x2:s,y2:q}},this.setCoordinates=function(b){t=b.x1,r=b.y1,s=b.x2,q=b.y2,p()},this.setCoordinates({x1:x.x1,y1:x.y1,x2:x.x2,y2:x.y2}),this.getBounds=function(){return{minX:Math.min(t,s),minY:Math.min(r,q),maxX:Math.max(t,s),maxY:Math.max(r,q)}},this.pointOnPath=function(b,f){if(0!==b||f){if(1!=b||f){var e=f?b>0?b:w+b:b*w;return Biltong.pointOnLine({x:t,y:r},{x:s,y:q},e)}return{x:s,y:q}}return{x:t,y:r}},this.gradientAtPoint=function(){return v},this.pointAlongPathFrom=function(f,e,A){var z=this.pointOnPath(f,A),y=0>=e?{x:t,y:r}:{x:s,y:q};return 0>=e&&Math.abs(e)>1&&(e*=-1),Biltong.pointOnLine(z,y,e)};var o=function(e,d,f){return f>=Math.min(e,d)&&f<=Math.max(e,d)},n=function(e,d,f){return Math.abs(f-e)<Math.abs(f-d)?e:d};this.findClosestPointOnPath=function(d,e){var c={d:1/0,x:null,y:null,l:null,x1:t,x2:s,y1:r,y2:q};if(0===v){c.y=r,c.x=o(t,s,d)?d:n(t,s,d)}else{if(1/0==v||v==-1/0){c.x=t,c.y=o(r,q,e)?e:n(r,q,e)}else{var b=r-v*t,A=e-u*d,z=(A-b)/(v-u),y=v*z+b;c.x=o(t,s,z)?z:n(t,s,z),c.y=o(r,q,y)?y:n(r,q,y)}}var f=Biltong.lineLength([c.x,c.y],[t,r]);return c.d=Biltong.lineLength([d,e],[c.x,c.y]),c.l=f/w,c}},Arc:function(w){var v=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(a,d){return Biltong.theta([w.cx,w.cy],[a,d])}),u=function(x,d){if(x.anticlockwise){var B=x.startAngle<x.endAngle?x.startAngle+t:x.startAngle,A=Math.abs(B-x.endAngle);return B-A*d}var z=x.endAngle<x.startAngle?x.endAngle+t:x.endAngle,y=Math.abs(z-x.startAngle);return x.startAngle+y*d},t=2*Math.PI;this.radius=w.r,this.anticlockwise=w.ac,this.type="Arc",w.startAngle&&w.endAngle?(this.startAngle=w.startAngle,this.endAngle=w.endAngle,this.x1=w.cx+this.radius*Math.cos(w.startAngle),this.y1=w.cy+this.radius*Math.sin(w.startAngle),this.x2=w.cx+this.radius*Math.cos(w.endAngle),this.y2=w.cy+this.radius*Math.sin(w.endAngle)):(this.startAngle=v(w.x1,w.y1),this.endAngle=v(w.x2,w.y2),this.x1=w.x1,this.y1=w.y1,this.x2=w.x2,this.y2=w.y2),this.endAngle<0&&(this.endAngle+=t),this.startAngle<0&&(this.startAngle+=t),this.segment=Biltong.quadrant([this.x1,this.y1],[this.x2,this.y2]);var s=this.endAngle<this.startAngle?this.endAngle+t:this.endAngle;this.sweep=Math.abs(s-this.startAngle),this.anticlockwise&&(this.sweep=t-this.sweep);var r=2*Math.PI*this.radius,q=this.sweep/t,p=r*q;this.getLength=function(){return p},this.getBounds=function(){return{minX:w.cx-w.r,maxX:w.cx+w.r,minY:w.cy-w.r,maxY:w.cy+w.r}};var o=1e-10,n=function(e){var d=Math.floor(e),f=Math.ceil(e);return o>e-d?d:o>f-e?f:e};this.pointOnPath=function(a,z){if(0===a){return{x:this.x1,y:this.y1,theta:this.startAngle}}if(1==a){return{x:this.x2,y:this.y2,theta:this.endAngle}}z&&(a/=p);var y=u(this,a),x=w.cx+w.r*Math.cos(y),c=w.cy+w.r*Math.sin(y);return{x:n(x),y:n(c),theta:y}},this.gradientAtPoint=function(a,y){var x=this.pointOnPath(a,y),f=Biltong.normal([w.cx,w.cy],[x.x,x.y]);return this.anticlockwise||1/0!=f&&f!=-1/0||(f*=-1),f},this.pointAlongPathFrom=function(D,C,B){var A=this.pointOnPath(D,B),z=2*(C/r)*Math.PI,y=this.anticlockwise?-1:1,x=A.theta+y*z,f=w.cx+this.radius*Math.cos(x),a=w.cy+this.radius*Math.sin(x);return{x:f,y:a}}},Bezier:function(f){var e=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),[{x:f.x1,y:f.y1},{x:f.cp1x,y:f.cp1y},{x:f.cp2x,y:f.cp2y},{x:f.x2,y:f.y2}]),o={minX:Math.min(f.x1,f.x2,f.cp1x,f.cp2x),minY:Math.min(f.y1,f.y2,f.cp1y,f.cp2y),maxX:Math.max(f.x1,f.x2,f.cp1x,f.cp2x),maxY:Math.max(f.y1,f.y2,f.cp1y,f.cp2y)};this.type="Bezier";var n=function(p,d,q){return q&&(d=jsBezier.locationAlongCurveFrom(p,d>0?0:1,d)),d};this.pointOnPath=function(b,d){return b=n(e,b,d),jsBezier.pointOnCurve(e,b)},this.gradientAtPoint=function(b,d){return b=n(e,b,d),jsBezier.gradientAtPoint(e,b)},this.pointAlongPathFrom=function(b,p,d){return b=n(e,b,d),jsBezier.pointAlongCurveFrom(e,b,p)},this.getLength=function(){return jsBezier.getLength(e)},this.getBounds=function(){return o}}};var h=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(L){h.apply(this,arguments);var K=[],J=0,I=[],H=[],G=L.stub||0,F=jsPlumbUtil.isArray(G)?G[0]:G,E=jsPlumbUtil.isArray(G)?G[1]:G,D=L.gap||0,C=jsPlumbUtil.isArray(D)?D[0]:D,B=jsPlumbUtil.isArray(D)?D[1]:D,A=null,z=!1,y=null;this.isEditable=function(){return !1},this.setEdited=function(b){z=b},this.getPath=function(){},this.setPath=function(){},this.findSegmentForPoint=function(n,c){for(var q={d:1/0,s:null,x:null,y:null,l:null},p=0;p<K.length;p++){var o=K[p].findClosestPointOnPath(n,c);o.d<q.d&&(q.d=o.d,q.l=o.l,q.x=o.x,q.y=o.y,q.s=K[p],q.x1=o.x1,q.x2=o.x2,q.y1=o.y1,q.y2=o.y2,q.index=p)}return q};var x=function(){for(var d=0,c=0;c<K.length;c++){var e=K[c].getLength();H[c]=e/J,I[c]=[d,d+=e/J]}},w=function(d,c){c&&(d=d>0?d/J:(J+d)/J);for(var n=I.length-1,f=1,e=0;e<I.length;e++){if(I[e][1]>=d){n=e,f=1==d?1:0===d?0:(d-I[e][0])/H[e];break}}return{segment:K[n],proportion:f,index:n}},v=function(d,c,o){if(o.x1!=o.x2||o.y1!=o.y2){var n=new jsPlumb.Segments[c](o);K.push(n),J+=n.getLength(),d.updateBounds(n)}},u=function(){J=K.length=I.length=H.length=0};this.setSegments=function(d){A=[],J=0;for(var c=0;c<d.length;c++){A.push(d[c]),J+=d[c].getLength()}};var a=function(ae){this.lineWidth=ae.lineWidth;var ad=Biltong.quadrant(ae.sourcePos,ae.targetPos),ac=ae.targetPos[0]<ae.sourcePos[0],ab=ae.targetPos[1]<ae.sourcePos[1],aa=ae.lineWidth||1,Z=ae.sourceEndpoint.anchor.getOrientation(ae.sourceEndpoint),Y=ae.targetEndpoint.anchor.getOrientation(ae.targetEndpoint),X=ac?ae.targetPos[0]:ae.sourcePos[0],W=ab?ae.targetPos[1]:ae.sourcePos[1],V=Math.abs(ae.targetPos[0]-ae.sourcePos[0]),U=Math.abs(ae.targetPos[1]-ae.sourcePos[1]);if(0===Z[0]&&0===Z[1]||0===Y[0]&&0===Y[1]){var T=V>U?0:1,S=[1,0][T];Z=[],Y=[],Z[T]=ae.sourcePos[T]>ae.targetPos[T]?-1:1,Y[T]=ae.sourcePos[T]>ae.targetPos[T]?1:-1,Z[S]=0,Y[S]=0}var R=ac?V+C*Z[0]:C*Z[0],Q=ab?U+C*Z[1]:C*Z[1],P=ac?B*Y[0]:V+B*Y[0],O=ab?B*Y[1]:U+B*Y[1],N=Z[0]*Y[0]+Z[1]*Y[1],M={sx:R,sy:Q,tx:P,ty:O,lw:aa,xSpan:Math.abs(P-R),ySpan:Math.abs(O-Q),mx:(R+P)/2,my:(Q+O)/2,so:Z,to:Y,x:X,y:W,w:V,h:U,segment:ad,startStubX:R+Z[0]*F,startStubY:Q+Z[1]*F,endStubX:P+Y[0]*E,endStubY:O+Y[1]*E,isXGreaterThanStubTimes2:Math.abs(R-P)>F+E,isYGreaterThanStubTimes2:Math.abs(Q-O)>F+E,opposite:-1==N,perpendicular:0===N,orthogonal:1==N,sourceAxis:0===Z[0]?"y":"x",points:[X,W,V,U,R,Q,P,O]};return M.anchorOrientation=M.opposite?"opposite":M.orthogonal?"orthogonal":"perpendicular",M};return this.getSegments=function(){return K},this.updateBounds=function(d){var c=d.getBounds();this.bounds.minX=Math.min(this.bounds.minX,c.minX),this.bounds.maxX=Math.max(this.bounds.maxX,c.maxX),this.bounds.minY=Math.min(this.bounds.minY,c.minY),this.bounds.maxY=Math.max(this.bounds.maxY,c.maxY)},this.pointOnPath=function(e,d){var f=w(e,d);return f.segment&&f.segment.pointOnPath(f.proportion,!1)||[0,0]},this.gradientAtPoint=function(e,d){var f=w(e,d);return f.segment&&f.segment.gradientAtPoint(f.proportion,!1)||0},this.pointAlongPathFrom=function(f,e,o){var n=w(f,o);return n.segment&&n.segment.pointAlongPathFrom(n.proportion,e,!1)||[0,0]},this.compute=function(b){z||(y=a.call(this,b)),u(),this._compute(y,b),this.x=y.points[0],this.y=y.points[1],this.w=y.points[2],this.h=y.points[3],this.segment=y.segment,x()},{addSegment:v,prepareCompute:a,sourceStub:F,targetStub:E,maxStub:Math.max(F,E),sourceGap:C,targetGap:B,maxGap:Math.max(C,B)}},jsPlumbUtil.extend(jsPlumb.Connectors.AbstractConnector,h);var g=jsPlumb.Connectors.Straight=function(){this.type="Straight";var b=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(a){b.addSegment(this,"Straight",{x1:a.sx,y1:a.sy,x2:a.startStubX,y2:a.startStubY}),b.addSegment(this,"Straight",{x1:a.startStubX,y1:a.startStubY,x2:a.endStubX,y2:a.endStubY}),b.addSegment(this,"Straight",{x1:a.endStubX,y1:a.endStubY,x2:a.tx,y2:a.ty})}};jsPlumbUtil.extend(jsPlumb.Connectors.Straight,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(g,"Straight"),jsPlumb.Endpoints.AbstractEndpoint=function(a){h.apply(this,arguments);var d=this.compute=function(){var b=this._compute.apply(this,arguments);return this.x=b[0],this.y=b[1],this.w=b[2],this.h=b[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,b};return{compute:d,cssClass:a.cssClass}},jsPlumbUtil.extend(jsPlumb.Endpoints.AbstractEndpoint,h),jsPlumb.Endpoints.Dot=function(b){this.type="Dot",jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),b=b||{},this.radius=b.radius||10,this.defaultOffset=0.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(o,n,u){this.radius=u.radius||this.radius;var t=o[0]-this.radius,s=o[1]-this.radius,r=2*this.radius,q=2*this.radius;if(u.strokeStyle){var p=u.lineWidth||1;t-=p,s-=p,r+=2*p,q+=2*p}return[t,s,r,q,this.radius]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Dot,jsPlumb.Endpoints.AbstractEndpoint),jsPlumb.Endpoints.Rectangle=function(b){this.type="Rectangle",jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),b=b||{},this.width=b.width||20,this.height=b.height||20,this._compute=function(o,n,t){var s=t.width||this.width,r=t.height||this.height,q=o[0]-s/2,p=o[1]-r/2;return[q,p,s,r]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Rectangle,jsPlumb.Endpoints.AbstractEndpoint);var m=function(){jsPlumb.DOMElementComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};jsPlumbUtil.extend(m,jsPlumb.DOMElementComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(b){this._jsPlumb.displayElements.push(b)}}),jsPlumb.Endpoints.Image=function(f){this.type="Image",m.apply(this,arguments),jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);var c=f.onload,o=f.src||f.url,n=f.cssClass?" "+f.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=f.width,this._jsPlumb.heightToUse=f.height,this._jsPlumb.endpoint=f.endpoint,this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,c&&c(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(b,p){var e=b.constructor==String?b:b.src;c=p,this._jsPlumb.img.src=e,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(o,c),this._compute=function(b){return this.anchorPoint=b,this._jsPlumb.ready?[b[0]-this._jsPlumb.widthToUse/2,b[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=document.createElement("img"),this.canvas.style.margin=0,this.canvas.style.padding=0,this.canvas.style.outline=0,this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.instance.endpointClass+n,this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.attachListeners(this.canvas,this),this.actuallyPaint=function(){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var e=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,d=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;jsPlumbUtil.sizeElement(this.canvas,e,d,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(e,d){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(e,d):window.setTimeout(function(){this.paint(e,d)}.bind(this),200))}},jsPlumbUtil.extend(jsPlumb.Endpoints.Image,[m,jsPlumb.Endpoints.AbstractEndpoint],{cleanup:function(){this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null}}),jsPlumb.Endpoints.Blank=function(){jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",m.apply(this,arguments),this._compute=function(b){return[b[0],b[1],10,0]},this.canvas=document.createElement("div"),this.canvas.style.display="block",this.canvas.style.width="1px",this.canvas.style.height="1px",this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.endpointClass,jsPlumb.appendElement(this.canvas),this.paint=function(){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.Blank,[jsPlumb.Endpoints.AbstractEndpoint,m],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),jsPlumb.Endpoints.Triangle=function(b){this.type="Triangle",jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),b=b||{},b.width=b.width||55,b.height=b.height||55,this.width=b.width,this.height=b.height,this._compute=function(o,n,t){var s=t.width||self.width,r=t.height||self.height,q=o[0]-s/2,p=o[1]-r/2;return[q,p,s,r]}};var l=jsPlumb.Overlays.AbstractOverlay=function(b){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=b.component,this.loc=null==b.location?0.5:b.location,this.endpointLoc=null==b.endpointLocation?[0.5,0.5]:b.endpointLocation};l.prototype={cleanup:function(){this.component=null,this.canvas=null,this.endpointLoc=null},setVisible:function(b){this.visible=b,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(b){this.loc+=b,this.component.repaint()},setLocation:function(b){this.loc=b,this.component.repaint()},getLocation:function(){return this.loc}},jsPlumb.Overlays.Arrow=function(n){this.type="Arrow",l.apply(this,arguments),this.isAppendedAtTopLevel=!1,n=n||{};var d=jsPlumbUtil,r=Biltong;this.length=n.length||20,this.width=n.width||20,this.id=n.id;var q=(n.direction||1)<0?-1:1,p=n.paintStyle||{lineWidth:1},o=n.foldback||0.623;this.computeMaxSize=function(){return 1.5*self.width},this.draw=function(D,C){var B,A,z,y,x;if(D.pointAlongPathFrom){if(d.isString(this.loc)||this.loc>1||this.loc<0){var w=parseInt(this.loc,10),v=this.loc<0?1:0;B=D.pointAlongPathFrom(v,w,!1),A=D.pointAlongPathFrom(v,w-q*this.length/2,!1),z=r.pointOnLine(B,A,this.length)}else{if(1==this.loc){if(B=D.pointOnPath(this.loc),A=D.pointAlongPathFrom(this.loc,-this.length),z=r.pointOnLine(B,A,this.length),-1==q){var f=z;z=B,B=f}}else{if(0===this.loc){if(z=D.pointOnPath(this.loc),A=D.pointAlongPathFrom(this.loc,this.length),B=r.pointOnLine(z,A,this.length),-1==q){var e=z;z=B,B=e}}else{B=D.pointAlongPathFrom(this.loc,q*this.length/2),A=D.pointOnPath(this.loc),z=r.pointOnLine(B,A,this.length)}}}y=r.perpendicularLineTo(B,z,this.width),x=r.pointOnLine(B,z,o*this.length);var c={hxy:B,tail:y,cxy:x},b=p.strokeStyle||C.strokeStyle,G=p.fillStyle||C.strokeStyle,F=p.lineWidth||C.lineWidth,E={component:D,d:c,lineWidth:F,strokeStyle:b,fillStyle:G,minX:Math.min(B.x,y[0].x,y[1].x),maxX:Math.max(B.x,y[0].x,y[1].x),minY:Math.min(B.y,y[0].y,y[1].y),maxY:Math.max(B.y,y[0].y,y[1].y)};return E}return{component:D,minX:0,maxX:0,minY:0,maxY:0}}},jsPlumbUtil.extend(jsPlumb.Overlays.Arrow,l),jsPlumb.Overlays.PlainArrow=function(d){d=d||{};var c=jsPlumb.extend(d,{foldback:1});jsPlumb.Overlays.Arrow.call(this,c),this.type="PlainArrow"},jsPlumbUtil.extend(jsPlumb.Overlays.PlainArrow,jsPlumb.Overlays.Arrow),jsPlumb.Overlays.Diamond=function(e){e=e||{};var d=e.length||40,f=jsPlumb.extend(e,{length:d/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,f),this.type="Diamond"},jsPlumbUtil.extend(jsPlumb.Overlays.Diamond,jsPlumb.Overlays.Arrow);var k=function(b){return null==b._jsPlumb.cachedDimensions&&(b._jsPlumb.cachedDimensions=b.getDimensions()),b._jsPlumb.cachedDimensions},i=function(b){jsPlumb.DOMElementComponent.apply(this,arguments),l.apply(this,arguments),this.id=b.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=b.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=b.create,this.getElement=function(){if(null==this._jsPlumb.div){var a=this._jsPlumb.div=jsPlumb.getDOMElement(this._jsPlumb.create(this._jsPlumb.component));a.style.position="absolute";var d=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:b.cssClass?b.cssClass:"");a.className=d,this._jsPlumb.instance.appendElement(a),this._jsPlumb.instance.getId(a),this.attachListeners(a,this),this.canvas=a}return this._jsPlumb.div},this.draw=function(v,u,t){var s=k(this);if(null!=s&&2==s.length){var r={x:0,y:0};if(t){r={x:t[0],y:t[1]}}else{if(v.pointOnPath){var q=this.loc,p=!1;(jsPlumbUtil.isString(this.loc)||this.loc<0||this.loc>1)&&(q=parseInt(this.loc,10),p=!0),r=v.pointOnPath(q,p)}else{var o=this.loc.constructor==Array?this.loc:this.endpointLoc;r={x:o[0]*v.w,y:o[1]*v.h}}}var n=r.x-s[0]/2,e=r.y-s[1]/2;return{component:v,d:{minx:n,miny:e,td:s,cxy:r},minX:n,maxX:n+s[0],minY:e,maxY:e+s[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(i,[jsPlumb.DOMElementComponent,l],{getDimensions:function(){return jsPlumb.getSize(this.getElement())},setVisible:function(b){this._jsPlumb.div.style.display=b?"block":"none"},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(){null!=this._jsPlumb.div&&this._jsPlumb.instance.removeElement(this._jsPlumb.div)},computeMaxSize:function(){var b=k(this);return Math.max(b[0],b[1])},reattachListeners:function(b){this._jsPlumb.div&&this.reattachListenersForElement(this._jsPlumb.div,this,b)},paint:function(b){this._jsPlumb.initialised||(this.getElement(),b.component.appendDisplayElement(this._jsPlumb.div),this.attachListeners(this._jsPlumb.div,b.component),this._jsPlumb.initialised=!0),this._jsPlumb.div.style.left=b.component.x+b.d.minx+"px",this._jsPlumb.div.style.top=b.component.y+b.d.miny+"px"}}),jsPlumb.Overlays.Custom=function(){this.type="Custom",i.apply(this,arguments)},jsPlumbUtil.extend(jsPlumb.Overlays.Custom,i),jsPlumb.Overlays.GuideLines=function(){var b=this;b.length=50,b.lineWidth=5,this.type="GuideLines",l.apply(this,arguments),jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.draw=function(a){var r=a.pointAlongPathFrom(b.loc,b.length/2),q=a.pointOnPath(b.loc),p=Biltong.pointOnLine(r,q,b.length),o=Biltong.perpendicularLineTo(r,p,40),n=Biltong.perpendicularLineTo(p,r,20);return{connector:a,head:r,tail:p,headLine:n,tailLine:o,minX:Math.min(r.x,p.x,n[0].x,n[1].x),minY:Math.min(r.y,p.y,n[0].y,n[1].y),maxX:Math.max(r.x,p.x,n[0].x,n[1].x),maxY:Math.max(r.y,p.y,n[0].y,n[1].y)}}},jsPlumb.Overlays.Label=function(f){this.labelStyle=f.labelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var e=jsPlumb.extend({create:function(){return document.createElement("div")}},f);if(jsPlumb.Overlays.Custom.call(this,e),this.type="Label",this.label=f.label||"",this.labelText=null,this.labelStyle){var o=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",o.style.font=this.labelStyle.font,o.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(o.style.background=this.labelStyle.fillStyle),this.labelStyle.borderWidth>0){var n=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";o.style.border=this.labelStyle.borderWidth+"px solid "+n}this.labelStyle.padding&&(o.style.padding=this.labelStyle.padding)}},jsPlumbUtil.extend(jsPlumb.Overlays.Label,jsPlumb.Overlays.Custom,{cleanup:function(){this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null},getLabel:function(){return this.label},setLabel:function(b){this.label=b,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),i.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var b=this.label(this);this.getElement().innerHTML=b.replace(/\r\n/g,"<br/>")}else{null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))}}})}(),function(){var b=function(D){this.type="Flowchart",D=D||{},D.stub=null==D.stub?30:D.stub;var C,B=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),A=null==D.midpoint?0.5:D.midpoint,z=[],y=(D.grid,D.alwaysRespectStubs),x=null,w=null,v=null,u=null!=D.cornerRadius?D.cornerRadius:0,t=function(c){return 0>c?-1:0===c?0:1},s=function(G,F,E,o){if(w!=F||v!=E){var n=null==w?o.sx:w,m=null==v?o.sy:v,k=n==F?"v":"h",i=t(F-n),h=t(E-m);w=F,v=E,G.push([n,m,F,E,k,i,h])}},r=function(c){return Math.sqrt(Math.pow(c[0]-c[2],2)+Math.pow(c[1]-c[3],2))},q=function(d){var c=[];return c.push.apply(c,d),c},p=function(O,N,M){for(var L,K,J=0;J<N.length-1;J++){if(L=L||q(N[J]),K=q(N[J+1]),u>0&&L[4]!=K[4]){var I=Math.min(u,r(L),r(K));L[2]-=L[5]*I,L[3]-=L[6]*I,K[0]+=K[5]*I,K[1]+=K[6]*I;var H=L[6]==K[5]&&1==K[5]||L[6]==K[5]&&0===K[5]&&L[5]!=K[6]||L[6]==K[5]&&-1==K[5],G=K[1]>L[3]?1:-1,F=K[0]>L[2]?1:-1,E=G==F,n=E&&H||!E&&!H?K[0]:L[2],m=E&&H||!E&&!H?L[3]:K[1];B.addSegment(O,"Straight",{x1:L[0],y1:L[1],x2:L[2],y2:L[3]}),B.addSegment(O,"Arc",{r:I,x1:L[2],y1:L[3],x2:K[0],y2:K[1],cx:n,cy:m,ac:H})}else{var c=L[2]==L[0]?0:L[2]>L[0]?M.lw/2:-(M.lw/2),P=L[3]==L[1]?0:L[3]>L[1]?M.lw/2:-(M.lw/2);B.addSegment(O,"Straight",{x1:L[0]-c,y1:L[1]-P,x2:L[2]+c,y2:L[3]+P})}L=K}null!=K&&B.addSegment(O,"Straight",{x1:K[0],y1:K[1],x2:K[2],y2:K[3]})};this.setSegments=function(c){x=c},this.isEditable=function(){return !0},this.getOriginalSegments=function(){return x||z},this._compute=function(G,l){if(l.clearEdits&&(x=null),null!=x){return p(this,x,G),void 0}z=[],w=null,v=null,C=null;var i=G.startStubX+(G.endStubX-G.startStubX)*A,h=G.startStubY+(G.endStubY-G.startStubY)*A,g={x:[0,1],y:[1,0]},e=function(){return[G.startStubX,G.startStubY,G.endStubX,G.endStubY]},d={perpendicular:e,orthogonal:e,opposite:function(a){var n=G,m="x"==a?0:1,k={x:function(){return 1==n.so[m]&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||-1==n.so[m]&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return 1==n.so[m]&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||-1==n.so[m]&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}};return !y&&k[a]()?{x:[(G.sx+G.tx)/2,G.startStubY,(G.sx+G.tx)/2,G.endStubY],y:[G.startStubX,(G.sy+G.ty)/2,G.endStubX,(G.sy+G.ty)/2]}[a]:[G.startStubX,G.startStubY,G.endStubX,G.endStubY]}},c={perpendicular:function(V){var U=G,T={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},S={x:[[U.startStubX,U.endStubX],null,[U.endStubX,U.startStubX]],y:[[U.startStubY,U.endStubY],null,[U.endStubY,U.startStubY]]},R={x:[[i,U.startStubY],[i,U.endStubY]],y:[[U.startStubX,h],[U.endStubX,h]]},Q={x:[[U.endStubX,U.startStubY]],y:[[U.startStubX,U.endStubY]]},P={x:[[U.startStubX,U.endStubY],[U.endStubX,U.endStubY]],y:[[U.endStubX,U.startStubY],[U.endStubX,U.endStubY]]},O={x:[[U.startStubX,h],[U.endStubX,h],[U.endStubX,U.endStubY]],y:[[i,U.startStubY],[i,U.endStubY],[U.endStubX,U.endStubY]]},N={x:[U.startStubY,U.endStubY],y:[U.startStubX,U.endStubX]},M=g[V][0],n=g[V][1],m=U.so[M]+1,k=U.to[n]+1,a=-1==U.to[n]&&N[V][1]<N[V][0]||1==U.to[n]&&N[V][1]>N[V][0],Y=S[V][m][0],X=S[V][m][1],W=T[V][m][k];return U.segment==W[3]||U.segment==W[2]&&a?R[V]:U.segment==W[2]&&Y>X?Q[V]:U.segment==W[2]&&X>=Y||U.segment==W[1]&&!a?O[V]:U.segment==W[0]||U.segment==W[1]&&a?P[V]:void 0},orthogonal:function(a,O,N,M,n){var m=G,k={x:-1==m.so[0]?Math.min(O,M):Math.max(O,M),y:-1==m.so[1]?Math.min(O,M):Math.max(O,M)}[a];return{x:[[k,N],[k,n],[M,n]],y:[[N,k],[n,k],[n,M]]}[a]},opposite:function(R,Q,P,O){var N=G,M={x:"y",y:"x"}[R],m={x:"height",y:"width"}[R],k=N["is"+R.toUpperCase()+"GreaterThanStubTimes2"];if(l.sourceEndpoint.elementId==l.targetEndpoint.elementId){var a=P+(1-l.sourceEndpoint.anchor[M])*l.sourceInfo[m]+B.maxStub;return{x:[[Q,a],[O,a]],y:[[a,Q],[a,O]]}[R]}return !k||1==N.so[K]&&Q>O||-1==N.so[K]&&O>Q?{x:[[Q,h],[O,h]],y:[[i,Q],[i,O]]}[R]:1==N.so[K]&&O>Q||-1==N.so[K]&&Q>O?{x:[[i,N.sy],[i,N.ty]],y:[[N.sx,h],[N.tx,h]]}[R]:void 0}},L=d[G.anchorOrientation](G.sourceAxis),K="x"==G.sourceAxis?0:1,J="x"==G.sourceAxis?1:0,I=L[K],H=L[J],F=L[K+2],E=L[J+2];s(z,L[0],L[1],G);var o=c[G.anchorOrientation](G.sourceAxis,I,H,F,E);if(o){for(var f=0;f<o.length;f++){s(z,o[f][0],o[f][1],G)}}s(z,L[2],L[3],G),s(z,G.tx,G.ty,G),p(this,z,G)},this.getPath=function(){for(var g=null,e=null,E=[],o=x||z,n=0;n<o.length;n++){var m=o[n],l=m[4],k="v"==l?3:2;null!=g&&e===l?g[k]=m[k]:(m[0]!=m[2]||m[1]!=m[3])&&(E.push({start:[m[0],m[1]],end:[m[2],m[3]]}),g=m,e=m[4])}return E},this.setPath=function(G){x=[];for(var F=0;F<G.length;F++){var E=G[F].start[0],o=G[F].start[1],n=G[F].end[0],m=G[F].end[1],l=E==n?"v":"h",k=t(n-E),g=t(m-o);x.push([E,o,n,m,l,k,g])}}};jsPlumbUtil.extend(b,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(b,"Flowchart")}(),function(){var e=function(h,g,k,i){return k>=h&&g>=i?1:k>=h&&i>=g?2:h>=k&&i>=g?3:4},d=function(s,r,q,p,o,n,m,l,k){return k>=l?[s,r]:1===q?p[3]<=0&&o[3]>=1?[s+(p[2]<0.5?-1*n:n),r]:p[2]>=1&&o[2]<=0?[s,r+(p[3]<0.5?-1*m:m)]:[s+-1*n,r+-1*m]:2===q?p[3]>=1&&o[3]<=0?[s+(p[2]<0.5?-1*n:n),r]:p[2]>=1&&o[2]<=0?[s,r+(p[3]<0.5?-1*m:m)]:[s+1*n,r+-1*m]:3===q?p[3]>=1&&o[3]<=0?[s+(p[2]<0.5?-1*n:n),r]:p[2]<=0&&o[2]>=1?[s,r+(p[3]<0.5?-1*m:m)]:[s+-1*n,r+-1*m]:4===q?p[3]<=0&&o[3]>=1?[s+(p[2]<0.5?-1*n:n),r]:p[2]<=0&&o[2]>=1?[s,r+(p[3]<0.5?-1*m:m)]:[s+1*n,r+-1*m]:void 0},f=function(p){p=p||{},this.type="StateMachine";var o=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),n=p.curviness||10,m=p.margin||5,l=p.proximityLimit||80,k=p.orientation&&"clockwise"===p.orientation,b=p.loopbackRadius||25,a=p.showLoopback!==!1;this._compute=function(Z,Y){var X=Math.abs(Y.sourcePos[0]-Y.targetPos[0]),W=Math.abs(Y.sourcePos[1]-Y.targetPos[1]);if(Math.min(Y.sourcePos[0],Y.targetPos[0]),Math.min(Y.sourcePos[1],Y.targetPos[1]),a&&Y.sourceEndpoint.elementId===Y.targetEndpoint.elementId){var V=Y.sourcePos[0],U=(Y.sourcePos[0],Y.sourcePos[1]-m),T=(Y.sourcePos[1]-m,V),R=U-b,P=2*b,N=2*b,L=T-b,J=R-b;Z.points[0]=L,Z.points[1]=J,Z.points[2]=P,Z.points[3]=N,o.addSegment(this,"Arc",{loopback:!0,x1:V-L+4,y1:U-J,startAngle:0,endAngle:2*Math.PI,r:b,ac:!k,x2:V-L-4,y2:U-J,cx:T-L,cy:R-J})}else{var H=Y.sourcePos[0]<Y.targetPos[0]?0:X,G=Y.sourcePos[1]<Y.targetPos[1]?0:W,i=Y.sourcePos[0]<Y.targetPos[0]?X:0,h=Y.sourcePos[1]<Y.targetPos[1]?W:0;0===Y.sourcePos[2]&&(H-=m),1===Y.sourcePos[2]&&(H+=m),0===Y.sourcePos[3]&&(G-=m),1===Y.sourcePos[3]&&(G+=m),0===Y.targetPos[2]&&(i-=m),1===Y.targetPos[2]&&(i+=m),0===Y.targetPos[3]&&(h-=m),1===Y.targetPos[3]&&(h+=m);var g=(H+i)/2,S=(G+h)/2,Q=-1*g/S,O=Math.atan(Q),M=(1/0==Q||Q==-1/0?0:Math.abs(n/2*Math.sin(O)),1/0==Q||Q==-1/0?0:Math.abs(n/2*Math.cos(O)),e(H,G,i,h)),K=Math.sqrt(Math.pow(i-H,2)+Math.pow(h-G,2)),I=d(g,S,M,Y.sourcePos,Y.targetPos,n,n,K,l);o.addSegment(this,"Bezier",{x1:i,y1:h,x2:H,y2:G,cp1x:I[0],cp1y:I[1],cp2x:I[0],cp2y:I[1]})}}};jsPlumb.registerConnectorType(f,"StateMachine")}(),function(){var b=function(f){f=f||{};var e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),h=(f.stub||50,f.curviness||150),g=10;this.type="Bezier",this.getCurviness=function(){return h},this._findControlPoint=function(r,q,p,o,n){var m=o.anchor.getOrientation(o),l=n.anchor.getOrientation(n),d=m[0]!=l[0]||m[1]==l[1],c=[];return d?(0===l[0]?c.push(p[0]<q[0]?r[0]+g:r[0]-g):c.push(r[0]+h*l[0]),0===l[1]?c.push(p[1]<q[1]?r[1]+g:r[1]-g):c.push(r[1]+h*m[1])):(0===m[0]?c.push(q[0]<p[0]?r[0]+g:r[0]-g):c.push(r[0]-h*m[0]),0===m[1]?c.push(q[1]<p[1]?r[1]+g:r[1]-g):c.push(r[1]+h*l[1])),c},this._compute=function(y,x){var w=x.sourcePos,v=x.targetPos,u=Math.abs(w[0]-v[0]),t=Math.abs(w[1]-v[1]),s=w[0]<v[0]?u:0,r=w[1]<v[1]?t:0,q=w[0]<v[0]?0:u,p=w[1]<v[1]?0:t,o=this._findControlPoint([s,r],w,v,x.sourceEndpoint,x.targetEndpoint),n=this._findControlPoint([q,p],v,w,x.targetEndpoint,x.sourceEndpoint);e.addSegment(this,"Bezier",{x1:s,y1:r,x2:q,y2:p,cp1x:o[0],cp1y:o[1],cp2x:n[0],cp2y:n[1]})}};jsPlumbUtil.extend(b,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(b,"Bezier")}(),function(){var X={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},W="stroke-dasharray",V="dashstyle",U="linearGradient",T="radialGradient",S="defs",R="fill",Q="stop",P="stroke",O="stroke-width",N="style",M="none",L="jsplumb_gradient_",K="lineWidth",J={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},I=function(e,d){for(var f in d){e.setAttribute(f,""+d[f])}},H=function(e,d){var f=document.createElementNS(J.svg,e);return d=d||{},d.version="1.1",d.xmlns=J.xhtml,I(f,d),f},G=function(b){return"position:absolute;left:"+b[0]+"px;top:"+b[1]+"px"},F=function(d){for(var c=0;c<d.childNodes.length;c++){(d.childNodes[c].tagName==S||d.childNodes[c].tagName==U||d.childNodes[c].tagName==T)&&d.removeChild(d.childNodes[c])}},E=function(w,s,q,m,i){var h=L+i._jsPlumb.instance.idstamp();F(w);var g;g=q.gradient.offset?H(T,{id:h}):H(U,{id:h,gradientUnits:"userSpaceOnUse"});var f=H(S);w.appendChild(f),f.appendChild(g);for(var e=0;e<q.gradient.stops.length;e++){var d=1==i.segment||2==i.segment?e:q.gradient.stops.length-1-e,Y=jsPlumbUtil.convertStyle(q.gradient.stops[d][1],!0),y=H(Q,{offset:Math.floor(100*q.gradient.stops[e][0])+"%","stop-color":Y});g.appendChild(y)}var x=q.strokeStyle?P:R;s.setAttribute(x,"url(#"+h+")")},D=function(s,n,l,k,i){if(n.setAttribute(R,l.fillStyle?jsPlumbUtil.convertStyle(l.fillStyle,!0):M),n.setAttribute(P,l.strokeStyle?jsPlumbUtil.convertStyle(l.strokeStyle,!0):M),l.gradient?E(s,n,l,k,i):(F(s),n.setAttribute(N,"")),l.lineWidth&&n.setAttribute(O,l.lineWidth),l[V]&&l[K]&&!l[W]){var g=-1==l[V].indexOf(",")?" ":",",c=l[V].split(g),b="";c.forEach(function(d){b+=Math.floor(d*l.lineWidth)+g}),n.setAttribute(W,b)}else{l[W]&&n.setAttribute(W,l[W])}for(var a in X){l[a]&&n.setAttribute(X[a],l[a])}},C=function(e,d,f){e.childNodes.length>f?e.insertBefore(d,e.childNodes[f]):e.appendChild(d)};jsPlumbUtil.svg={node:H,attr:I,pos:G};var B=function(h){var g=h.pointerEventsSpec||"all",m={};jsPlumb.jsPlumbUIComponent.apply(this,h.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var l=h.cssClass+" "+(h.originalArgs[0].cssClass||""),k={style:"",width:0,height:0,"pointer-events":g,position:"absolute"};this.svg=H("svg",k),h.useDivWrapper?(this.canvas=document.createElement("div"),this.canvas.style.position="absolute",jsPlumbUtil.sizeElement(this.canvas,0,0,1,1),this.canvas.className=l):(I(this.svg,{"class":l}),this.canvas=this.svg),h._jsPlumb.appendElement(this.canvas,h.originalArgs[0].parent),h.useDivWrapper&&this.canvas.appendChild(this.svg);var i=[this.canvas];return this.getDisplayElements=function(){return i},this.appendDisplayElement=function(b){i.push(b)},this.paint=function(a,q,p){if(null!=a){var o,n=[this.x,this.y],c=[this.w,this.h];null!=p&&(p.xmin<0&&(n[0]+=p.xmin),p.ymin<0&&(n[1]+=p.ymin),c[0]=p.xmax+(p.xmin<0?-p.xmin:0),c[1]=p.ymax+(p.ymin<0?-p.ymin:0)),h.useDivWrapper?(jsPlumbUtil.sizeElement(this.canvas,n[0],n[1],c[0],c[1]),n[0]=0,n[1]=0,o=G([0,0])):o=G([n[0],n[1]]),m.paint.apply(this,arguments),I(this.svg,{style:o,width:c[0],height:c[1]})}},{renderer:m}};jsPlumbUtil.extend(B,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.bgCanvas=null,this.path=null,this.group=null},setVisible:function(b){this.canvas&&(this.canvas.style.display=b?"block":"none"),this.bgCanvas&&(this.bgCanvas.style.display=b?"block":"none")}}),jsPlumb.ConnectorRenderers.svg=function(e){var d=this,f=B.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:e._jsPlumb}]);f.renderer.paint=function(Y,y,x){var w=d.getSegments(),v="",u=[0,0];if(x.xmin<0&&(u[0]=-x.xmin),x.ymin<0&&(u[1]=-x.ymin),w.length>0){for(var t=0;t<w.length;t++){v+=jsPlumb.Segments.svg.SegmentRenderer.getPath(w[t]),v+=" "}var s={d:v,transform:"translate("+u[0]+","+u[1]+")","pointer-events":e["pointer-events"]||"visibleStroke"},r=null,q=[d.x,d.y,d.w,d.h],p={mouseenter:function(g){var h=g.relatedTarget;return null==h||h!=d.path&&h!=d.bgPath},mouseout:function(g){var h=g.relatedTarget;return null==h||h!=d.path&&h!=d.bgPath}};if(Y.outlineColor){var b=Y.outlineWidth||1,a=Y.lineWidth+2*b;r=jsPlumb.extend({},Y),r.strokeStyle=jsPlumbUtil.convertStyle(Y.outlineColor),r.lineWidth=a,null==d.bgPath?(d.bgPath=H("path",s),C(d.svg,d.bgPath,0),d.attachListeners(d.bgPath,d,p)):I(d.bgPath,s),D(d.svg,d.bgPath,r,q,d)}null==d.path?(d.path=H("path",s),C(d.svg,d.path,Y.outlineColor?1:0),d.attachListeners(d.path,d,p)):I(d.path,s),D(d.svg,d.path,Y,q,d)}},this.reattachListeners=function(){this.bgPath&&this.reattachListenersForElement(this.bgPath,this),this.path&&this.reattachListenersForElement(this.path,this)}},jsPlumbUtil.extend(jsPlumb.ConnectorRenderers.svg,B),jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(b){return{Straight:function(){var a=b.getCoordinates();return"M "+a.x1+" "+a.y1+" L "+a.x2+" "+a.y2},Bezier:function(){var a=b.params;return"M "+a.x1+" "+a.y1+" C "+a.cp1x+" "+a.cp1y+" "+a.cp2x+" "+a.cp2y+" "+a.x2+" "+a.y2},Arc:function(){var a=b.params,f=b.sweep>Math.PI?1:0,e=b.anticlockwise?0:1;return"M"+b.x1+" "+b.y1+" A "+b.radius+" "+a.r+" 0 "+f+","+e+" "+b.x2+" "+b.y2}}[b.type]()}}};var A=window.SvgEndpoint=function(d){var c=B.apply(this,[{cssClass:d._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:d._jsPlumb}]);c.renderer.paint=function(f){var e=jsPlumb.extend({},f);e.outlineColor&&(e.strokeWidth=e.outlineWidth,e.strokeStyle=jsPlumbUtil.convertStyle(e.outlineColor,!0)),null==this.node?(this.node=this.makeNode(e),this.svg.appendChild(this.node),this.attachListeners(this.node,this)):null!=this.updateNode&&this.updateNode(this.node),D(this.svg,this.node,e,[this.x,this.y,this.w,this.h],this),G(this.node,[this.x,this.y])}.bind(this)};jsPlumbUtil.extend(A,B,{reattachListeners:function(){this.node&&this.reattachListenersForElement(this.node,this)}}),jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),A.apply(this,arguments),this.makeNode=function(){return H("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(b){I(b,{cx:this.w/2,cy:this.h/2,r:this.radius})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Dot,[jsPlumb.Endpoints.Dot,A]),jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),A.apply(this,arguments),this.makeNode=function(){return H("rect",{width:this.w,height:this.h})},this.updateNode=function(b){I(b,{width:this.w,height:this.h})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Rectangle,[jsPlumb.Endpoints.Rectangle,A]),jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var z=function(e,d){e.apply(this,d),jsPlumb.jsPlumbUIComponent.apply(this,d),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(b,h){if(b.component.svg&&h){null==this.path&&(this.path=H("path",{"pointer-events":"all"}),b.component.svg.appendChild(this.path),this.canvas=b.component.svg,this.attachListeners(this.path,b.component),this.attachListeners(this.path,this));var g=d&&1==d.length?d[0].cssClass||"":"",c=[0,0];h.xmin<0&&(c[0]=-h.xmin),h.ymin<0&&(c[1]=-h.ymin),I(this.path,{d:f(b.d),"class":g,stroke:b.strokeStyle?b.strokeStyle:null,fill:b.fillStyle?b.fillStyle:null,transform:"translate("+c[0]+","+c[1]+")"})}};var f=function(b){return"M"+b.hxy.x+","+b.hxy.y+" L"+b.tail[0].x+","+b.tail[0].y+" L"+b.cxy.x+","+b.cxy.y+" L"+b.tail[1].x+","+b.tail[1].y+" L"+b.hxy.x+","+b.hxy.y};this.reattachListeners=function(){this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(z,[jsPlumb.jsPlumbUIComponent,jsPlumb.Overlays.AbstractOverlay],{cleanup:function(){null!=this.path&&this._jsPlumb.instance.removeElement(this.path)},setVisible:function(b){null!=this.path&&(this.path.style.display=b?"block":"none")}}),jsPlumb.Overlays.svg.Arrow=function(){z.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Arrow,[jsPlumb.Overlays.Arrow,z]),jsPlumb.Overlays.svg.PlainArrow=function(){z.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.PlainArrow,[jsPlumb.Overlays.PlainArrow,z]),jsPlumb.Overlays.svg.Diamond=function(){z.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Diamond,[jsPlumb.Overlays.Diamond,z]),jsPlumb.Overlays.svg.GuideLines=function(){var g,f,k=null,i=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(c,b){null==k&&(k=H("path"),c.connector.svg.appendChild(k),i.attachListeners(k,c.connector),i.attachListeners(k,i),g=H("path"),c.connector.svg.appendChild(g),i.attachListeners(g,c.connector),i.attachListeners(g,i),f=H("path"),c.connector.svg.appendChild(f),i.attachListeners(f,c.connector),i.attachListeners(f,i));var a=[0,0];b.xmin<0&&(a[0]=-b.xmin),b.ymin<0&&(a[1]=-b.ymin),I(k,{d:h(c.head,c.tail),stroke:"red",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),I(g,{d:h(c.tailLine[0],c.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),I(f,{d:h(c.headLine[0],c.headLine[1]),stroke:"green",fill:null,transform:"translate("+a[0]+","+a[1]+")"})};var h=function(d,c){return"M "+d.x+","+d.y+" L"+c.x+","+c.y}},jsPlumbUtil.extend(jsPlumb.Overlays.svg.GuideLines,jsPlumb.Overlays.GuideLines)}(),function(){var F={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},E=null;if(document.createStyleSheet&&document.namespaces){var D=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],C="behavior:url(#default#VML);position:absolute;";E=document.createStyleSheet();for(var B=0;B<D.length;B++){E.addRule(D[B],C)}document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var A=1000,z=function(e,d){for(var f in d){e[f]=d[f]}},y=function(i,g,o,n,m,l){o=o||{};var k=document.createElement("jsplumb:"+i);return l?m.appendElement(k,n):n.appendChild(k),k.className=(o["class"]?o["class"]+" ":"")+"jsplumb_vml",x(k,g),z(k,o),k},x=function(e,d,f){e.style.left=d[0]+"px",e.style.top=d[1]+"px",e.style.width=d[2]+"px",e.style.height=d[3]+"px",e.style.position="absolute",f&&(e.style.zIndex=f)},w=jsPlumb.vml.convertValue=function(b){return Math.floor(b*A)},v=function(f,e,h,g){"transparent"===e?g.setOpacity(h,"0.0"):g.setOpacity(h,"1.0")},u=function(L,K,J,I){var H={};if(K.strokeStyle){H.stroked="true";var G=jsPlumbUtil.convertStyle(K.strokeStyle,!0);H.strokecolor=G,v(H,G,"stroke",J),H.strokeweight=K.lineWidth+"px"}else{H.stroked="false"}if(K.fillStyle){H.filled="true";var p=jsPlumbUtil.convertStyle(K.fillStyle,!0);H.fillcolor=p,v(H,p,"fill",J)}else{H.filled="false"}if(K.dashstyle){null==J.strokeNode?J.strokeNode=y("stroke",[0,0,0,0],{dashstyle:K.dashstyle},L,I):J.strokeNode.dashstyle=K.dashstyle}else{if(K["stroke-dasharray"]&&K.lineWidth){for(var o=-1==K["stroke-dasharray"].indexOf(",")?" ":",",k=K["stroke-dasharray"].split(o),h="",g=0;g<k.length;g++){h+=Math.floor(k[g]/K.lineWidth)+o}null==J.strokeNode?J.strokeNode=y("stroke",[0,0,0,0],{dashstyle:h},L,I):J.strokeNode.dashstyle=h}}z(L,H)},t=function(){var d=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(a){d.opacityNodes.stroke=y("stroke",[0,0,1,1],{opacity:"0.0"},a,d._jsPlumb.instance),d.opacityNodes.fill=y("fill",[0,0,1,1],{opacity:"0.0"},a,d._jsPlumb.instance)},this.setOpacity=function(a,f){var e=d.opacityNodes[a];e&&(e.opacity=""+f)};var c=[];this.getDisplayElements=function(){return c},this.appendDisplayElement=function(b,a){a||d.canvas.parentNode.appendChild(b),c.push(b)}};jsPlumbUtil.extend(t,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&this.bgCanvas.parentNode.removeChild(this.bgCanvas),this.canvas&&this.canvas.parentNode.removeChild(this.canvas)}});var s=jsPlumb.ConnectorRenderers.vml=function(a){this.strokeNode=null,this.canvas=null,t.apply(this,arguments);var d=this._jsPlumb.instance.connectorClass+(a.cssClass?" "+a.cssClass:"");this.paint=function(H){if(null!==H){this.w=Math.max(this.w,1),this.h=Math.max(this.h,1);for(var G=this.getSegments(),l={path:""},i=[this.x,this.y,this.w,this.h],h=0;h<G.length;h++){l.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(G[h]),l.path+=" "}if(H.outlineColor){var g=H.outlineWidth||1,f=H.lineWidth+2*g,c={strokeStyle:jsPlumbUtil.convertStyle(H.outlineColor),lineWidth:f};for(var b in F){c[b]=H[b]}null==this.bgCanvas?(l["class"]=d,l.coordsize=i[2]*A+","+i[3]*A,this.bgCanvas=y("shape",i,l,a.parent,this._jsPlumb.instance,!0),x(this.bgCanvas,i),this.appendDisplayElement(this.bgCanvas,!0),this.attachListeners(this.bgCanvas,this),this.initOpacityNodes(this.bgCanvas,["stroke"])):(l.coordsize=i[2]*A+","+i[3]*A,x(this.bgCanvas,i),z(this.bgCanvas,l)),u(this.bgCanvas,c,this)}null==this.canvas?(l["class"]=d,l.coordsize=i[2]*A+","+i[3]*A,this.canvas=y("shape",i,l,a.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.attachListeners(this.canvas,this),this.initOpacityNodes(this.canvas,["stroke"])):(l.coordsize=i[2]*A+","+i[3]*A,x(this.canvas,i),z(this.canvas,l)),u(this.canvas,H,this,this._jsPlumb.instance)}}};jsPlumbUtil.extend(s,t,{reattachListeners:function(){this.canvas&&this.reattachListenersForElement(this.canvas,this)},setVisible:function(b){this.canvas&&(this.canvas.style.display=b?"block":"none"),this.bgCanvas&&(this.bgCanvas.style.display=b?"block":"none")}});var r=window.VmlEndpoint=function(b){t.apply(this,arguments),this._jsPlumb.vml=null,this.canvas=document.createElement("div"),this.canvas.style.position="absolute",this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(b.cssClass?" "+b.cssClass:""),b._jsPlumb.appendElement(this.canvas,b.parent),this.paint=function(f,e){var h={},g=this._jsPlumb.vml;jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h),null==this._jsPlumb.vml?(h["class"]=this._jsPlumb.clazz,g=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],h,e,this.canvas,this._jsPlumb.instance),this.attachListeners(g,this),this.appendDisplayElement(g,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(g,["fill"])):(x(g,[0,0,this.w,this.h]),z(g,h)),u(g,f,this)}};jsPlumbUtil.extend(r,t,{reattachListeners:function(){this._jsPlumb.vml&&this.reattachListenersForElement(this._jsPlumb.vml,this)}}),jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(b){return{Straight:function(d){var c=d.params;return"m"+w(c.x1)+","+w(c.y1)+" l"+w(c.x2)+","+w(c.y2)+" e"},Bezier:function(d){var c=d.params;return"m"+w(c.x1)+","+w(c.y1)+" c"+w(c.cp1x)+","+w(c.cp1y)+","+w(c.cp2x)+","+w(c.cp2y)+","+w(c.x2)+","+w(c.y2)+" e"},Arc:function(i){var h=i.params,o=Math.min(h.x1,h.x2),n=(Math.max(h.x1,h.x2),Math.min(h.y1,h.y2)),m=(Math.max(h.y1,h.y2),i.anticlockwise?1:0),l=i.anticlockwise?"at ":"wa ",k=function(){if(h.loopback){return"0,0,"+w(2*h.r)+","+w(2*h.r)}var a=[null,[function(){return[o,n]},function(){return[o-h.r,n-h.r]}],[function(){return[o-h.r,n]},function(){return[o,n-h.r]}],[function(){return[o-h.r,n-h.r]},function(){return[o,n]}],[function(){return[o,n-h.r]},function(){return[o-h.r,n]}]][i.segment][m]();return w(a[0])+","+w(a[1])+","+w(a[0]+2*h.r)+","+w(a[1]+2*h.r)};return l+" "+k()+","+w(h.x1)+","+w(h.y1)+","+w(h.x2)+","+w(h.y2)+" e"}}[b.type](b)}}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),r.apply(this,arguments),this.getVml=function(g,f,k,i,h){return y("oval",g,f,i,h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Dot,r),jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),r.apply(this,arguments),this.getVml=function(g,f,k,i,h){return y("rect",g,f,i,h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Rectangle,r),jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var q=function(f,e){f.apply(this,e),t.apply(this,e);var h=this;this.canvas=null,this.isAppendedAtTopLevel=!0;var g=function(b){return"m "+w(b.hxy.x)+","+w(b.hxy.y)+" l "+w(b.tail[0].x)+","+w(b.tail[0].y)+" "+w(b.cxy.x)+","+w(b.cxy.y)+" "+w(b.tail[1].x)+","+w(b.tail[1].y)+" x e"};this.paint=function(M,L){if(M.component.canvas&&L){var K={},J=M.d,I=M.component;M.strokeStyle&&(K.stroked="true",K.strokecolor=jsPlumbUtil.convertStyle(M.strokeStyle,!0)),M.lineWidth&&(K.strokeweight=M.lineWidth+"px"),M.fillStyle&&(K.filled="true",K.fillcolor=M.fillStyle);var H=Math.min(J.hxy.x,J.tail[0].x,J.tail[1].x,J.cxy.x),G=Math.min(J.hxy.y,J.tail[0].y,J.tail[1].y,J.cxy.y),i=Math.max(J.hxy.x,J.tail[0].x,J.tail[1].x,J.cxy.x),d=Math.max(J.hxy.y,J.tail[0].y,J.tail[1].y,J.cxy.y),c=Math.abs(i-H),b=Math.abs(d-G),P=[H,G,c,b];if(K.path=g(J),K.coordsize=I.w*A+","+I.h*A,P[0]=I.x,P[1]=I.y,P[2]=I.w,P[3]=I.h,null==h.canvas){var O=I._jsPlumb.overlayClass||"",N=e&&1==e.length?e[0].cssClass||"":"";K["class"]=N+" "+O,h.canvas=y("shape",P,K,I.canvas.parentNode,I._jsPlumb.instance,!0),I.appendDisplayElement(h.canvas,!0),h.attachListeners(h.canvas,I),h.attachListeners(h.canvas,h)}else{x(h.canvas,P),z(h.canvas,K)}}},this.reattachListeners=function(){this.canvas&&this.reattachListenersForElement(h.canvas,this)},this.cleanup=function(){null!=this.canvas&&this._jsPlumb.instance.removeElement(this.canvas)}};jsPlumbUtil.extend(q,[t,jsPlumb.Overlays.AbstractOverlay],{setVisible:function(b){this.canvas.style.display=b?"block":"none"}}),jsPlumb.Overlays.vml.Arrow=function(){q.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Arrow,[jsPlumb.Overlays.Arrow,q]),jsPlumb.Overlays.vml.PlainArrow=function(){q.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.PlainArrow,[jsPlumb.Overlays.PlainArrow,q]),jsPlumb.Overlays.vml.Diamond=function(){q.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Diamond,[jsPlumb.Overlays.Diamond,q])}(),function(d){var c=function(a){return"string"==typeof a?d("#"+a):d(a)};d.extend(jsPlumbInstance.prototype,{getDOMElement:function(b){return null==b?null:"string"==typeof b?document.getElementById(b):b.context||null!=b.length?b[0]:b},getElementObject:c,removeElement:function(b){c(b).remove()},doAnimate:function(f,e,g){f.animate(e,g)},getSelector:function(b,a){return 2==arguments.length?c(b).find(a):d(b)},destroyDraggable:function(a){d(a).data("draggable")&&d(a).draggable("destroy")},destroyDroppable:function(a){d(a).data("droppable")&&d(a).droppable("destroy")},initDraggable:function(a,f,e){f=f||{},a=d(a),f.start=jsPlumbUtil.wrap(f.start,function(){d("body").addClass(this.dragSelectClass)},!1),f.stop=jsPlumbUtil.wrap(f.stop,function(){d("body").removeClass(this.dragSelectClass)}),f.doNotRemoveHelper||(f.helper=null),e&&(f.scope=f.scope||jsPlumb.Defaults.Scope),a.draggable(f)},initDroppable:function(a,e){e.scope=e.scope||jsPlumb.Defaults.Scope,d(a).droppable(e)},isAlreadyDraggable:function(a){return d(a).hasClass("ui-draggable")},isDragSupported:function(a){return d(a).draggable},isDropSupported:function(a){return d(a).droppable},getDragObject:function(b){return b[1].helper||b[1].draggable},getDragScope:function(a){return d(a).draggable("option","scope")},getDropEvent:function(b){return b[0]},getDropScope:function(a){return d(a).droppable("option","scope")},getUIPosition:function(h,g,m){var l;if(g=g||1,1==h.length){l={left:h[0].pageX,top:h[0].pageY}}else{var k=h[1],i=k.position;l=i||k.absolutePosition,m||(k.position.left/=g,k.position.top/=g)}return{left:l.left,top:l.top}},isDragFilterSupported:function(){return !0},setDragFilter:function(a,e){jsPlumb.isAlreadyDraggable(a)&&d(a).draggable("option","cancel",e)},setElementDraggable:function(a,e){d(a).draggable("option","disabled",!e)},setDragScope:function(a,e){d(a).draggable("option","scope",e)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},animEvents:{step:"step",complete:"complete"},trigger:function(b,h,g){var f=jQuery._data(c(b)[0],"handle");f(g)},getOriginalEvent:function(b){return b.originalEvent},on:function(b){b=c(b);var e=[];e.push.apply(e,arguments),b.on.apply(b,e.slice(1))},off:function(b){b=c(b);var e=[];e.push.apply(e,arguments),b.off.apply(b,e.slice(1))}}),d(document).ready(jsPlumb.init)}(jQuery);